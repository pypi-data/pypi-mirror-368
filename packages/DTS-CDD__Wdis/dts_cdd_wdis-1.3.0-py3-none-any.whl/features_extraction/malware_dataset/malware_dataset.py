import os

import pandas as pd

from features_extraction.config.config import config
from features_extraction.utils import load_data


class MalwareDataset:
    def __init__(self):
        X_train = load_data(os.path.join(config.splitted_dataset_path, "X_train.pkl"))
        y_train = load_data(os.path.join(config.splitted_dataset_path, "y_train.pkl"))
        X_test = load_data(os.path.join(config.splitted_dataset_path, "X_test.pkl"))
        y_test = load_data(os.path.join(config.splitted_dataset_path, "y_test.pkl"))
        self.training_dataset = pd.merge(
            X_train, y_train, on="sha256", how="inner"
        ).reset_index()
        self.testing_dataset = pd.merge(
            X_test, y_test, on="sha256", how="inner"
        ).reset_index()
        self.df_malware_family_fsd = pd.merge(
            pd.concat([X_train, X_test]),
            pd.concat([y_train, y_test]),
            on="sha256",
            how="inner",
        ).reset_index()
