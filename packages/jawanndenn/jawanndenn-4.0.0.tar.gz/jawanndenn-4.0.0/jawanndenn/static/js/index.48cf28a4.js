(()=>{"use strict";var e={6870:function(e,t,n){var r=n(5893),s=n(7294),o=n(745);let i=()=>(0,r.jsx)("footer",{children:(0,r.jsxs)("p",{children:[(0,r.jsx)("span",{style:{fontSize:"150%",position:"relative",top:"3px"},children:"★"}),(0,r.jsx)("a",{href:"https://github.com/hartwork/jawanndenn/",children:"jawanndenn"})," is"," ",(0,r.jsx)("a",{href:"https://www.gnu.org/philosophy/free-sw.en.html",children:"software libre"})," ","developed by ",(0,r.jsx)("a",{href:"https://blog.hartwork.org/",children:"Sebastian Pipping"}),", licensed under the"," ",(0,r.jsx)("a",{href:"https://www.gnu.org/licenses/agpl.en.html",children:"GNU Affero GPL license"}),". Please"," ",(0,r.jsx)("a",{href:"https://github.com/hartwork/jawanndenn/issues",children:"report bugs"})," ","and let me know if you ",(0,r.jsx)("a",{href:"mailto:sebastian@pipping.org",children:"like"})," ","it.",(0,r.jsx)("iframe",{id:"github-star-button",src:"./static/3rdparty/github-buttons-4.0.1/docs/github-btn.html?user=hartwork&repo=jawanndenn&type=star&count=true",frameBorder:"0",scrolling:"0",width:"170px",height:"20px"})]})}),l=[["**","<strong>","</strong>"],["*","<em>","</em>"],["__","<strong>","</strong>"],["_","<em>","</em>"],["`","<tt>","</tt>"]],a={};l.forEach(e=>{let t=e[0],n=e[2];a[t]=n});var c=n(5237),d=n(3321);let h=(0,d.Z)((0,r.jsx)("path",{d:"M19 5v14H5V5h14m0-2H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2z"}),"CheckBoxOutlineBlank"),u=(0,d.Z)((0,r.jsx)("path",{d:"M19 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.11 0 2-.9 2-2V5c0-1.1-.89-2-2-2zm-9 14l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"}),"CheckBox"),p=(0,d.Z)((0,r.jsx)("path",{d:"m 5.0006855,3.0002915 c -1.1,0 -2.000394,0.899878 -2.000394,1.999878 V 18.999831 c 0,1.1 0.900394,2.000395 2.000394,2.000395 H 19.000348 c 1.1,0 1.999878,-0.900395 1.999878,-2.000395 V 5.0001695 c 0,-1.1 -0.899878,-1.999878 -1.999878,-1.999878 z m 7.0295445,3.420463 c 1.049909,0 1.86985,0.254855 2.459799,0.764811 0.589948,0.504956 0.885217,1.229626 0.885217,2.174544 0,0.6549425 -0.185037,1.2028315 -0.555005,1.6427935 -0.364968,0.434963 -0.792652,0.882077 -1.282609,1.342037 -0.279976,0.249978 -0.47,0.514808 -0.569991,0.794784 -0.09999,0.279975 -0.154849,0.610153 -0.164848,0.99012 h -1.919779 c 0.005,-0.674942 0.08755,-1.222313 0.24753,-1.642277 0.164986,-0.419963 0.462489,-0.822712 0.892452,-1.207678 0.344969,-0.304974 0.627512,-0.594739 0.847493,-0.869714 0.224981,-0.274977 0.337447,-0.5924275 0.337447,-0.9523965 0,-0.844926 -0.392773,-1.267623 -1.177706,-1.267623 -0.309973,0 -0.589763,0.100257 -0.839742,0.30024 -0.249978,0.199983 -0.380158,0.525173 -0.390157,0.975134 H 8.6257875 c 0.015,-1.039909 0.347412,-1.807744 0.997355,-2.302701 0.6549425,-0.494957 1.4571705,-0.742074 2.4070875,-0.742074 z m -0.149861,8.8640575 c 0.369968,0 0.665236,0.109715 0.885217,0.329696 0.219981,0.219981 0.329696,0.49255 0.329696,0.817521 0,0.324972 -0.109715,0.59754 -0.329696,0.817521 -0.219981,0.219981 -0.515249,0.330213 -0.885217,0.330213 -0.369968,0 -0.66472,-0.110232 -0.884701,-0.330213 -0.214981,-0.219981 -0.322461,-0.492549 -0.322461,-0.817521 0,-0.324971 0.10748,-0.59754 0.322461,-0.817521 0.219981,-0.219981 0.514733,-0.329696 0.884701,-0.329696 z"}),"IndeterminateCheckBox"),m=e=>{let{name:t,tribool:n,setTribool:s}=e,o=!0===n,i=null===n;return(0,r.jsxs)(r.Fragment,{children:[(0,r.jsx)("input",{name:t,type:"hidden",value:i?"indeterminate":o?"on":""}),(0,r.jsx)(c.Z,{color:i?"maybe":o?"primary":"error",checked:o,indeterminate:i,onChange:function(e){i?s(!1):o?s(null):s(!0)},icon:(0,r.jsx)(h,{}),checkedIcon:(0,r.jsx)(u,{}),indeterminateIcon:(0,r.jsx)(p,{})})]})};var f=n(807),x=n(2153),j=n(9717),g=n(1146),v=n(2184);let b=e=>{let{pollId:t,config:n,votes:o,titleIsHtml:i=!1,pretend:c=!1}=e,[d,h]=(0,s.useState)([]),[u,p]=(0,s.useState)(""),b=d;if(d.length>n.options.length)b=d.slice(0,n.options.length);else if(d.length<n.options.length){let e=n.options.slice(d.length).map(e=>!1);b=d.concat(e)}console.assert(b.length===n.options.length);let w=n.options.map((e,t)=>o.reduce((e,n)=>{let[r,s]=n;return e+ +!!s[t]},+!!b[t])),y=n.options.map((e,t)=>o.reduce((e,n)=>{let[r,s]=n;return e+ +(!1!==s[t])},+!![!0,null].includes(b[t]))),O=n.options.map((e,t)=>y[t]>w[t]?`${w[t]}\u{2013}${y[t]}`:w[t]);return(0,r.jsxs)(x.Z,{className:`poll ${c?"preview":""}`,children:[c&&(0,r.jsx)(g.Z,{title:"Preview"}),(0,r.jsxs)(j.Z,{children:[(0,r.jsx)("h2",{dangerouslySetInnerHTML:{__html:i?n.title:(e=>{e=e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;");let t=[],n=[];for(;e.length;){let r=!1;l.forEach(s=>{let o=s[0],i=s[1],l=s[2];if(e.startsWith(o))return n.length&&n[n.length-1]==o?(t.push(l),n.pop()):(t.push(i),n.push(o)),e=e.slice(o.length),r=!0,!1}),r||(t.push(e[0]),e=e.slice(1))}return n.reverse(),n.forEach(e=>{t.push(a[e])}),t.join("")})(n.title)},className:"question"}),(0,r.jsxs)("form",{method:"POST",action:`vote/${t}`,children:[(0,r.jsx)("input",{type:"hidden",name:"csrfmiddlewaretoken",value:window.DJANGO_CSRF_TOKEN}),(0,r.jsxs)("table",{children:[(0,r.jsx)("thead",{children:(0,r.jsxs)("tr",{children:[(0,r.jsx)("td",{}),n.options.map((e,t)=>(0,r.jsx)("td",{className:"vote",children:e},t)),(0,r.jsx)("td",{})]})}),(0,r.jsxs)("tbody",{children:[o.map((e,t)=>{let[n,s]=e;return(0,r.jsxs)("tr",{children:[(0,r.jsx)("td",{dangerouslySetInnerHTML:{__html:n},className:"person"}),s.map((e,t)=>(0,r.jsx)("td",{className:`vote ${e?"votedYes":null===e?"votedMaybe":"votedNo"}`,children:e?"✔":null===e?(0,r.jsx)("b",{children:"?"}):"✘"},t)),(0,r.jsx)("td",{})]},t)}),(0,r.jsxs)("tr",{className:"userVote",children:[(0,r.jsx)("td",{children:(0,r.jsx)(v.Z,{name:"voterName",placeholder:"Your name",variant:"standard",autoFocus:!c,value:u,onChange:e=>p(e.target.value),error:!c&&!u.trim(),className:"voterName"})}),b.map((e,t)=>(0,r.jsx)("td",{className:`vote ${e?"votedYes":null===e?"votedMaybe":"votedNo"}`,children:(0,r.jsx)(m,{name:`option${t}`,tribool:e,setTribool:e=>{let n=b.slice();n[t]=e,h(n)}})},t)),(0,r.jsxs)("td",{children:[" ",(0,r.jsx)(f.Z,{variant:"contained",disabled:c||!u.trim(),type:"submit",className:"submitVote",children:"SAVE"})]})]}),(0,r.jsxs)("tr",{children:[(0,r.jsx)("td",{}),O.map((e,t)=>(0,r.jsx)("td",{className:`vote ${e?"sumNonZero":""}`,children:e},t)),(0,r.jsx)("td",{})]})]})]})]})]})]})},w=["Dmitri","Jule","Vered","Matthieu"],y={},O=0,N=0,Z=e=>{let{config:t}=e,n=w.map((e,n)=>[e,t.options.map((e,t)=>((e,t)=>{let n=`${e}@${t}`,r=y[n];if(void 0===r){let e=4*w.length/2;if(O>e&&0==N)r=null;else{let e=Math.random();r=e>.95?null:e>.475}O+=1,null===r&&(N+=1),y[n]=r}return r})(n,t))]);return(0,r.jsx)(b,{config:t,votes:n,pretend:!0})},S=e=>e.substring(0,e.length-e.trimStart().length);var k=n(632),_=n(6370);let C=(e=>{let t=e.split("\n"),n=t.reduce((e,t)=>((e,t)=>{let n=Math.min(e.length,t.length),r=0;for(;r<n&&e[r]==t[r];r++);return e.substring(0,r)})(S(t)+e,e),S(t[0]));return t.map(e=>e.substring(n.length)).join("\n")})(`\
  title: Which fruit do _**you**_ like?

  options:
    - Apple
    - Banana
    - Orange
    - Papaya

  lifetime: month
`);class E extends Error{constructor(e){super(e),this.name="InvalidConfigError",Object.setPrototypeOf(this,E.prototype)}}let A=e=>{let t=(0,_.Qc)(e);if(!["month","week",void 0].includes(t.lifetime))throw new E("Attribute 'lifetime' is invalid, must be 'month' or 'week'.");if(void 0===t.options)throw new E("Attribute 'options' is missing.");if(!Array.isArray(t.options))throw new E("Attribute 'options' is not a list.");if(!t.options.every(e=>"string"==typeof e))throw new E("Attribute 'options' is not a list of strings.");if(void 0===t.title)throw new E("Attribute 'title' is missing.");if("string"!=typeof t.title)throw new E("Attribute 'title' is not a string.");return t},P=A(C),M=[C,!0,P],T=e=>{let{configState:t}=e,[[n,s,o],i]=t;return(0,r.jsx)("div",{className:"setup",children:(0,r.jsx)("form",{action:"create",method:"POST",children:(0,r.jsxs)(x.Z,{children:[(0,r.jsx)("input",{type:"hidden",name:"csrfmiddlewaretoken",value:window.DJANGO_CSRF_TOKEN}),(0,r.jsx)(j.Z,{children:(0,r.jsx)(v.Z,{name:"config",label:"Setup (YAML or JSON)",multiline:!0,value:n,variant:"standard",onChange:e=>{let t=e.target.value,n=!1,r=null;try{r=A(t),n=!0}catch(e){console.log("[DEBUG]","Config YAML/JSON failed to validate with error:",e.message),r=o}i([t,n,r])},className:`monospace-text ${s?"valid":"invalid"}`,autoFocus:!0,error:!s})}),(0,r.jsxs)(k.Z,{className:"setupButtons",sx:{justifyContent:"flex-end"},children:[(0,r.jsx)(f.Z,{variant:"text",onClick:e=>{i(M)},color:"inherit",children:"RESET"}),(0,r.jsx)(f.Z,{type:"submit",variant:"contained",disabled:!s,children:"CREATE"})]})]})})})};var $=n(8530),I=n(8888),z=n(7683),V=n(3797),B=n(3681);let H=e=>new Promise(t=>setTimeout(t,e)),R=async(e,t)=>{let n=`data/${e}`;try{let e=await fetch(n);if(!e.ok)throw Error(`HTTP request to '${n}' failed with status ${e.status}.`);let r=await e.json();t(r)}catch(e){console.error("ERROR:",e.message)}},F=async(e,t)=>{for(;;)document.hidden||await R(e,t),await H(1e3)},L=window.location.pathname.includes("/poll/")?/[0-9a-fA-F]{64}/.exec(window.location.pathname)[0]:null;L&&(document.title="jawanndenn: Vote!");let G=(0,$.Z)({palette:{primary:{main:z.Z["400"]}}}),J=(0,$.Z)(G,{palette:{maybe:G.palette.augmentColor({color:{main:V.Z["700"]},name:"maybe"})}}),Y=e=>{let{pollId:t}=e,[n,o]=(0,s.useState)(null);return n?(0,r.jsx)(B.Z,{container:!0,spacing:2,sx:{justifyContent:"safe center",alignItems:"flow-start"},children:(0,r.jsx)(B.Z,{size:{xs:12,sm:12,md:"auto",lg:"auto",xl:"auto"},children:(0,r.jsx)("div",{className:"live",children:(0,r.jsx)(b,{pollId:t,config:n.config,votes:n.votes,titleIsHtml:!0})})})}):(F(t,o),(0,r.jsx)(r.Fragment,{}))},D=()=>{let e=(0,s.useState)(M),t=e[0][2];return(0,r.jsxs)(B.Z,{container:!0,spacing:2,sx:{justifyContent:"safe center"},children:[(0,r.jsx)(B.Z,{size:{xs:12,sm:12,md:4,lg:3,xl:3},children:(0,r.jsx)(T,{configState:e})}),(0,r.jsx)(B.Z,{size:{xs:12,sm:12,md:"auto",lg:"auto",xl:"auto"},children:(0,r.jsx)(Z,{config:t})})]})},q=document.getElementById("root");q&&o.createRoot(q).render((0,r.jsx)(s.StrictMode,{children:(0,r.jsx)(()=>(0,r.jsxs)(I.Z,{theme:J,children:[(0,r.jsx)("div",{className:"stage",children:L?(0,r.jsx)(Y,{pollId:L}):(0,r.jsx)(D,{})}),(0,r.jsx)(i,{})]}),{})}))}},t={};function n(r){var s=t[r];if(void 0!==s)return s.exports;var o=t[r]={exports:{}};return e[r](o,o.exports,n),o.exports}n.m=e,n.n=e=>{var t=e&&e.__esModule?()=>e.default:()=>e;return n.d(t,{a:t}),t},(()=>{var e,t=Object.getPrototypeOf?e=>Object.getPrototypeOf(e):e=>e.__proto__;n.t=function(r,s){if(1&s&&(r=this(r)),8&s||"object"==typeof r&&r&&(4&s&&r.__esModule||16&s&&"function"==typeof r.then))return r;var o=Object.create(null);n.r(o);var i={};e=e||[null,t({}),t([]),t(t)];for(var l=2&s&&r;"object"==typeof l&&!~e.indexOf(l);l=t(l))Object.getOwnPropertyNames(l).forEach(e=>{i[e]=()=>r[e]});return i.default=()=>r,n.d(o,i),o}})(),n.d=(e,t)=>{for(var r in t)n.o(t,r)&&!n.o(e,r)&&Object.defineProperty(e,r,{enumerable:!0,get:t[r]})},n.o=(e,t)=>Object.prototype.hasOwnProperty.call(e,t),n.r=e=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},(()=>{var e=[];n.O=(t,r,s,o)=>{if(r){o=o||0;for(var i=e.length;i>0&&e[i-1][2]>o;i--)e[i]=e[i-1];e[i]=[r,s,o];return}for(var l=1/0,i=0;i<e.length;i++){for(var[r,s,o]=e[i],a=!0,c=0;c<r.length;c++)(!1&o||l>=o)&&Object.keys(n.O).every(e=>n.O[e](r[c]))?r.splice(c--,1):(a=!1,o<l&&(l=o));if(a){e.splice(i--,1);var d=s();void 0!==d&&(t=d)}}return t}})(),(()=>{var e={980:0};n.O.j=t=>0===e[t];var t=(t,r)=>{var s,o,[i,l,a]=r,c=0;if(i.some(t=>0!==e[t])){for(s in l)n.o(l,s)&&(n.m[s]=l[s]);if(a)var d=a(n)}for(t&&t(r);c<i.length;c++)o=i[c],n.o(e,o)&&e[o]&&e[o][0](),e[o]=0;return n.O(d)},r=self.webpackChunkfrontend=self.webpackChunkfrontend||[];r.forEach(t.bind(null,0)),r.push=t.bind(null,r.push.bind(r))})();var r=n.O(void 0,["361","702"],function(){return n(6870)});r=n.O(r)})();