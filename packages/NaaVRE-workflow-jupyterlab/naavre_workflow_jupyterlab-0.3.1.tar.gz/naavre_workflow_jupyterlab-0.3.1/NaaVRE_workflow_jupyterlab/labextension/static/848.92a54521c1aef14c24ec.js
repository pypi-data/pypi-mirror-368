"use strict";(self.webpackChunk_naavre_workflow_jupyterlab=self.webpackChunk_naavre_workflow_jupyterlab||[]).push([[848],{88:(e,t,n)=>{n.r(t),n.d(t,{IWorkflowTracker:()=>ut,default:()=>mt});var r=n(5607),a=n(9246),l=n(8213),i=n(7262),s=n(2912),o=n(9104),c=n(7931),d=n(8725),u=n(4602),p=n(1079),m=n.n(p),h=n(3345),g=n.n(h),f=n(2515),y=n(8856),w=n(1918),v=n(6907),k=n(748);async function x(e,t,n={},r={}){const a="naavre-communicator/external-service",l={method:"POST",body:JSON.stringify({query:{method:e,url:t,headers:n,data:r}})};console.debug("request",a,l);const i=await async function(e="",t={}){const n=k.ServerConnection.makeSettings(),r=v.URLExt.join(n.baseUrl,e);let a;try{a=await k.ServerConnection.makeRequest(r,t,n)}catch(e){throw new k.ServerConnection.NetworkError(e)}let l=await a.text();if(l.length>0)try{l=JSON.parse(l)}catch(e){console.log("Not a JSON response body.",a)}if(!a.ok)throw new k.ServerConnection.ResponseError(a,l.message||l);return l}(a,l);console.debug("resp",i);try{console.debug("resp.content",JSON.parse(i.content))}catch(e){}return i}var E=n(4943),b=n.n(E);const C={offset:{x:0,y:0},scale:1,nodes:{},links:{},selected:{},hovered:{}};function S(e){return(new(b())).hex(e)}const _=(0,n(710).A)({palette:{secondary:{main:"#ea5b2d",dark:"#b12800",light:"#ff8c5a"},primary:{main:"#0f4e8a",dark:"#00275c",light:"#4e79ba"}}});var A=n(2826),I=n.n(A),O=n(7763);const R=I().div`
  position: absolute;
  background: white;
  width: ${e=>e.width||"250px"};
  height: ${e=>e.height||"150px"};
  border-radius: 5px;
  border: 1px solid lightgray;
`;function T({title:e,backgroundColor:t}){return g().createElement(O.A,{title:e,placement:"bottom",arrow:!0},g().createElement("div",{style:{borderTopLeftRadius:"5px",borderTopRightRadius:"5px",padding:"5px",textAlign:"center",backgroundColor:t}},g().createElement("div",{style:{fontSize:"small",display:"inline-block",maxWidth:"200px",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis"}},e)))}const L=g().forwardRef((({node:e,children:t,...n},r)=>function({node:e,children:t,...n},r){const a="workflow-cell"!==e.type;let l="250px",i="150px";return"splitter"===e.type||"merger"===e.type?(l="200px",i="100px"):"visualizer"===e.type&&(l="200px",i="250px"),g().createElement(R,{width:l,height:i,ref:r,...n},g().createElement(T,{title:e.properties.cell.title,backgroundColor:a?"rgb(195, 235, 202)":"rgb(229,252,233)"}),t)}({node:e,children:t,...n},r)));var G=n(8593),U=n(2313),M=n(2828);function N({nodeType:e,sx:t}){switch(e){case"splitter":return h.createElement(U.A,{sx:{transform:"rotate(90deg)",...t}});case"merger":return h.createElement(G.A,{sx:{transform:"rotate(90deg)",...t}});case"visualizer":return h.createElement(M.A,{sx:t});default:return h.createElement(h.Fragment,null)}}function H({node:e}){return h.createElement("div",{style:{width:"190px",padding:"5px",display:"flex",justifyContent:"center"}},h.createElement(N,{nodeType:e.type,sx:{fontSize:"50px"}}))}function V({color:e}){return g().createElement("div",{style:{width:"20px",height:"20px",background:e,borderRadius:"50%",cursor:"pointer"}})}function D(){return g().createElement("div",{style:{marginTop:"20px",width:"20px",height:"20px",background:"#3c8f49",borderRadius:"5px",cursor:"pointer"}})}function F({children:e}){return g().createElement("div",{style:{display:"inline-block",maxWidth:"100px",whiteSpace:"nowrap",overflow:"hidden",textOverflow:"ellipsis",marginLeft:"5px",marginRight:"5px"}},e)}const $=e=>"splitter"===e.port.properties.parentNodeType||"merger"===e.port.properties.parentNodeType?g().createElement(D,null):g().createElement(O.A,{title:e.port.id,placement:"bottom",arrow:!0},g().createElement("div",{style:{display:"flex",justifyContent:"left"===e.port.type?"flex-start":"flex-end"}},"right"===e.port.type&&g().createElement(F,null,e.port.id),g().createElement(V,{color:e.port.properties.color}),"left"===e.port.type&&g().createElement(F,null,e.port.id)));var W=n(2369),P=n(951),z=n(9579),j=n(4939),B=n(6247),Z=n(3603),J=n(2823),q=n(4327),Y=n(4554),K=n(2819);function X({title:e,children:t}){return g().createElement(g().Fragment,null,e&&g().createElement(K.A,{component:"h4",sx:{marginTop:"16px",marginBottom:"16px"}},e),g().createElement(P.A,{elevation:1},g().createElement(q.A,null,g().createElement(B.A,null,g().createElement(Z.A,null,t)))))}function Q({cells:e}){return g().createElement(Y.A,null,e.map((e=>g().createElement(J.A,null,e))))}function ee({name:e}){return g().createElement("div",{style:{width:"20px",height:"20px",background:S(e),borderRadius:"50%"}})}function te({cell:e}){return g().createElement(z.A,{sx:{margin:"15px"}},g().createElement(X,null,e.container_image&&g().createElement(Q,{cells:["Image name",e.container_image]}),e.base_container_image&&g().createElement(g().Fragment,null,g().createElement(Q,{cells:["Base image (build)",e.base_container_image.build]}),g().createElement(Q,{cells:["Base image (runtime)",e.base_container_image.runtime]})),e.kernel&&g().createElement(Q,{cells:["Kernel",e.kernel]}),e.source_url&&g().createElement(Q,{cells:["Source",g().createElement(j.A,{href:e.source_url,target:"_blank",rel:"noreferrer"},e.source_url)]})),e.inputs.length>0&&g().createElement(g().Fragment,null,g().createElement(X,{title:"Inputs"},e.inputs.map((e=>g().createElement(Q,{cells:[g().createElement(ee,{name:e.name}),e.name,e.type]}))))),e.outputs.length>0&&g().createElement(g().Fragment,null,g().createElement(X,{title:"Outputs"},e.outputs.map((e=>g().createElement(Q,{cells:[g().createElement(ee,{name:e.name}),e.name,e.type]}))))),e.params.length>0&&g().createElement(g().Fragment,null,g().createElement(X,{title:"Parameters"},e.params.map((e=>g().createElement(Q,{cells:[e.name,e.type,e.default_value]}))))),e.secrets.length>0&&g().createElement(g().Fragment,null,g().createElement(X,{title:"Secrets"},e.secrets.map((e=>g().createElement(Q,{cells:[e.name]}))))))}var ne=n(2691),re=n(7809);function ae({children:e,onClose:t}){return h.createElement("div",{className:"naavre-workflow-section-header",style:{display:"flex",justifyContent:"space-between",alignItems:"center"}},h.createElement("p",{style:{margin:"0"}},e),h.createElement(ne.A,{"aria-label":"Close",style:{color:"white",borderRadius:"100%"},onClick:t},h.createElement(re.A,null)))}function le({link:e,onClose:t}){return h.createElement(ae,{onClose:t},"Link")}function ie({node:e,onClose:t}){let n="";switch(e.type){case"splitter":n="Splitter";break;case"merger":n="Merger";break;case"visualizer":n="Visualizer";break;case"workflow-cell":n=e.properties.cell.title}return h.createElement(h.Fragment,null,h.createElement(ae,{onClose:t},n),"workflow-cell"===e.type&&h.createElement(te,{cell:e.properties.cell}))}function se({chart:e,setChart:t,callbacks:n,config:r}){if(!e.selected.id)return h.createElement(h.Fragment,null);function a(){t({...e,selected:{}})}return h.createElement(P.A,{elevation:6,sx:{position:"absolute",top:20,right:20,width:380,maxHeight:"calc(100% - 40px)",overflowX:"clip",overflowY:"scroll"}},"link"===e.selected.type&&h.createElement(le,{link:e.links[e.selected.id],onClose:a}),"node"===e.selected.type&&h.createElement(ie,{node:e.nodes[e.selected.id],onClose:a}),h.createElement("div",{style:{margin:"15px"}},h.createElement(W.A,{variant:"contained",onClick:()=>n.onDeleteKey({config:r})},"Delete")))}var oe=n(3837),ce=n(9211),de=n(1228),ue=n(8183),pe=n(1178),me=n(6962),he=n(5603),ge=n(5002),fe=n(431),ye=n.n(fe),we=n(7375),ve=n.n(we),ke=n(4799),xe=n(8245);function Ee(){const e=(t=[22,23,0,1,2,3,4,5])[be(0,t.length-1)];var t;const n=be(0,59);return ye()().hour(e).minute(n)}function be(e,t){return e=Math.ceil(e),t=Math.floor(t),Math.floor(Math.random()*(t-e+1))+e}function Ce({periodUnit:e,setPeriodUnit:t}){return g().createElement(he.Stack,{direction:"row",spacing:2,style:{padding:"1rem",alignItems:"center"}},g().createElement(he.InputLabel,{id:"input-label",style:{width:"50%"}},"Run every"),g().createElement(he.Select,{id:"period-interval",labelId:"input-label","aria-describedby":"repetion periodUnit duration",value:e,onChange:e=>{t(e.target.value)},style:{width:"50%"},MenuProps:{sx:{zIndex:3e4}}},g().createElement(he.MenuItem,{value:"hour"},"hour"),g().createElement(he.MenuItem,{value:"day"},"day"),g().createElement(he.MenuItem,{value:"week"},"week"),g().createElement(he.MenuItem,{value:"month"},"month")))}function Se({time:e,setTime:t}){return g().createElement(he.Stack,{direction:"row",spacing:2,style:{padding:"1rem",alignItems:"center"}},g().createElement(he.InputLabel,{id:"day-of-week-label",style:{width:"40%"}},"On"),g().createElement(he.Select,{id:"day-of-week-select",labelId:"day-of-week-label",value:e.day(),onChange:n=>{t(e.day(Number(n.target.value)))},style:{width:"60%"},MenuProps:{sx:{zIndex:3e4}}},g().createElement(he.MenuItem,{value:1},"Monday"),g().createElement(he.MenuItem,{value:2},"Tuesday"),g().createElement(he.MenuItem,{value:3},"Wednesday"),g().createElement(he.MenuItem,{value:4},"Thursday"),g().createElement(he.MenuItem,{value:5},"Friday"),g().createElement(he.MenuItem,{value:6},"Saturday"),g().createElement(he.MenuItem,{value:0},"Sunday")))}function _e({time:e,setTime:t}){return g().createElement(he.Stack,{direction:"row",spacing:2,style:{padding:"1rem",alignItems:"center"}},g().createElement(he.InputLabel,{style:{width:"40%"}},"On day"),g().createElement(he.TextField,{type:"number",id:"time",label:"Day",value:e.date(),onChange:n=>{const r=Number(n.target.value);t(e.date(r))},style:{width:"60%"}}))}function Ae({periodUnit:e,time:t,setTime:n}){return g().createElement(g().Fragment,null,"week"===e&&g().createElement(Se,{time:t,setTime:n}),"month"===e&&g().createElement(_e,{time:t,setTime:n}),g().createElement(he.Container,null,g().createElement(he.Typography,{variant:"body2"},function(e,t){const n="Your workflow will run ";switch(e){case"hour":return n+`at minute :${t.format("mm")}`;case"day":case"week":case"month":return n+`during quiet hours at ${t.format("HH:mm")}`}}(e,t))))}function Ie({setCron:e}){const[t,n]=(0,h.useState)(null),[r,a]=(0,h.useState)(!1),[l,i]=(0,h.useState)("day"),[s,o]=(0,h.useState)(Ee);(0,h.useEffect)((()=>{e(r?function(e,t){switch(e){case"hour":return`${t.minute()} * * * *`;case"day":return`${t.minute()} ${t.hour()} * * *`;case"week":return`${t.minute()} ${t.hour()} * * ${t.day()}`;case"month":return`${t.minute()} ${t.hour()} ${t.date()} * *`}}(l,s):null)}),[r,e,l,s]);const c=()=>{n(null)},d=Boolean(t),u=d?"simple-popover":void 0;return g().createElement(g().Fragment,null,g().createElement(he.Button,{onClick:e=>{r||i("day"),a(!0),n(e.currentTarget)},size:"small",variant:"text",startIcon:g().createElement(ge.A,{fontSize:"inherit"}),style:{color:me.A[900],textTransform:"none",minWidth:"10rem"}},r?function(e,t){switch(e){case"hour":return`Every hour at :${t.format("mm")}`;case"day":return`Every day at ${t.format("HH:mm")}`;case"week":return`Every ${t.format("dddd")}`;case"month":return`On the ${t.format("Do")} of each month`}}(l,s):"Make recurring"),g().createElement(he.Popover,{id:u,open:d,anchorEl:t,onClose:c,anchorOrigin:{vertical:"bottom",horizontal:"left"},style:{zIndex:2e4}},g().createElement(ke.LocalizationProvider,{dateAdapter:xe.R},g().createElement(he.Container,{style:{padding:"1rem",minWidth:"25rem"}},g().createElement(Ce,{periodUnit:l,setPeriodUnit:i}),g().createElement(Ae,{periodUnit:l,time:s,setTime:o}),g().createElement(he.Stack,{direction:"row",spacing:2,style:{float:"right",margin:"1rem"}},g().createElement(he.Button,{onClick:()=>{a(!1),c()}},"Disable"),g().createElement(he.Button,{onClick:c,variant:"contained"},"Apply"))))))}function Oe({chart:e,settings:t}){const[n,r]=(0,h.useState)({}),[a,l]=(0,h.useState)({}),[i,s]=(0,h.useState)(null),[o,c]=(0,h.useState)(null),d=(e,t)=>{r((n=>({...n,[e]:t})))},u=(e,t)=>{l((n=>({...n,[e]:t})))};return(0,h.useEffect)((()=>{Object.values(e.nodes).forEach((e=>{e.properties.cell.params.forEach((e=>{d(e.name,{value:null,default_value:e.default_value})})),e.properties.cell.secrets.forEach((e=>{u(e.name,{value:null})}))}))}),[e.nodes]),g().createElement(f.A,{theme:_},g().createElement("div",{style:{display:"flex",overflow:"scroll",flexDirection:"column"}},o?g().createElement("div",{style:{padding:"10px",alignItems:"center",display:"flex",flexDirection:"column"}},g().createElement(ce.A,{fontSize:"large",sx:{color:pe.A[500]}}),g().createElement("p",{style:{fontSize:"large"}},"Workflow submitted! You can track it"," ",g().createElement("a",{target:"_blank",href:o.run_url},"here"))):g().createElement("div",null,0!==Object.keys(n).length&&g().createElement("div",{style:{textAlign:"right",padding:"10px 15px 0 0"}},g().createElement(W.A,{disabled:!1,onClick:async()=>{Object.entries(n).forEach((([e,t])=>{d(e,{value:t.default_value||null,default_value:t.default_value})}))},size:"small",variant:"text",endIcon:g().createElement(oe.A,{fontSize:"inherit"}),style:{color:me.A[900],textTransform:"none"}},"Use default parameter values")),g().createElement(q.A,null,g().createElement(B.A,{stickyHeader:!0,"aria-label":"sticky table"},g().createElement(Z.A,null,Object.entries(n).map((([e,t])=>g().createElement(Y.A,{hover:!0,role:"checkbox",tabIndex:-1,key:e},g().createElement(J.A,{key:e,align:"right"},e),g().createElement(J.A,{component:"th",scope:"row"},g().createElement(ue.A,{value:n[e].value,onChange:t=>(async(e,t)=>{d(t,{value:e.target.value,default_value:n[t].default_value})})(t,e)}))))),Object.entries(a).map((([e,t])=>g().createElement(Y.A,{hover:!0,role:"checkbox",tabIndex:-1,key:e},g().createElement(J.A,{key:e,align:"right"},e),g().createElement(J.A,{component:"th",scope:"row"},g().createElement(ue.A,{type:"password",autoComplete:"off",value:a[e].value,onChange:t=>(async(e,t)=>{u(t,{value:e.target.value})})(t,e)})))))))),g().createElement(de.A,{direction:"row",spacing:2,style:{float:"right",marginTop:"2rem",alignItems:"center"}},g().createElement(Ie,{setCron:s}),g().createElement(W.A,{variant:"contained",className:"lw-panel-button",onClick:()=>(async(n,r)=>{x("POST",`${t.workflowServiceUrl}/submit`,{},{virtual_lab:t.virtualLab,naavrewf2:e,params:n,secrets:r,cron_schedule:i}).then((e=>{if(200!==e.status_code)throw`${e.status_code} ${e.reason}`;const t=JSON.parse(e.content);c(t)})).catch((e=>{const t=`Error running the workflow: ${e}`;console.log(t),alert(t)}))})(n,a),color:"primary",disabled:!(()=>{let e=!0;return Object.values(n).forEach((t=>{e=e&&null!==t.value})),Object.values(a).forEach((t=>{e=e&&null!==t.value})),e})(),style:{float:"right"}},"Run")))))}ye().extend(ve());var Re=n(250);const Te=[{id:"splitter",title:"Splitter",type:"splitter",container_image:"",dependencies:[],inputs:[{name:"splitter_source",type:"list"}],outputs:[{name:"splitter_target",type:"list"}],confs:[],params:[],secrets:[]},{id:"merger",title:"Merger",type:"merger",container_image:"",dependencies:[],inputs:[{name:"merger_source",type:"list"}],outputs:[{name:"merger_target",type:"list"}],confs:[],params:[],secrets:[]},{id:"visualizer",title:"Visualizer",type:"visualizer",container_image:"",dependencies:[],inputs:[{name:"hostname",type:"string"},{name:"username",type:"string"},{name:"password",type:"string"},{name:"remote",type:"string"},{name:"num",type:"string"},{name:"mode",type:"string"},{name:"output",type:"string"}],outputs:[],confs:[],params:[],secrets:[]}];function Le(e){const t=new URL(e);if(t.searchParams.has("page")){const n=Number(t.searchParams.get("page"));if(isNaN(n))throw Error(`Unexpected url: ${e}`);return n}return 1}var Ge=n(5831);function Ue({cell:e}){const[t,n]=(0,h.useState)(!1),r=(0,h.useRef)(null);let a;(0,h.useEffect)((()=>{r.current&&n(r.current.scrollWidth>r.current.clientWidth)}),[]);const l=new RegExp(`-${e.owner}$`);return a=e.owner&&e.title.match(l)?g().createElement(g().Fragment,null,e.title.replace(l,""),g().createElement("span",{style:{color:"#6c6c6c"}},"-",e.owner)):e.title,g().createElement(O.A,{title:e.title,disableHoverListener:!t,placement:"bottom",arrow:!0},g().createElement("span",{ref:r,style:{overflow:"hidden",whiteSpace:"nowrap",textOverflow:"ellipsis"}},a))}function Me({cell:e,selectedCellInList:t,setSelectedCell:n}){const r=(0,h.useRef)(null),a=function(e){const t="type"in e?e.type:"workflow-cell";return{id:e.id,type:t,position:{x:35,y:15},properties:{cell:e},ports:Object.fromEntries([...e.inputs.map((e=>[e.name,{id:e.name,type:"left",properties:{color:S(e.name),parentNodeType:t}}])),...e.outputs.map((e=>[e.name,{id:e.name,type:"right",properties:{color:S(e.name),parentNodeType:t}}]))])}}(e),l="workflow-cell"!==a.type;return g().createElement("div",{ref:r,onClick:function(){t===e?n(null,null):n(e,r.current||null)},draggable:!0,onDragStart:e=>{e.dataTransfer.setData(w.REACT_FLOW_CHART,JSON.stringify({type:a.type,ports:a.ports,properties:a.properties}))},style:{margin:"10px",fontSize:"14px",display:"flex",height:"25px",border:"1px solid lightgray",justifyContent:"space-between",alignItems:"center",background:"rgb(195, 235, 202)",backgroundColor:l?"rgb(195, 235, 202)":"rgb(229,252,233)",borderRadius:"5px",padding:"10px",cursor:"move"}},g().createElement(Ue,{cell:e}),g().createElement(ne.A,{"aria-label":"Info",style:{borderRadius:"100%"}},g().createElement(Ge.A,null)))}function Ne({title:e,cells:t,minHeightInCells:n,selectedCellInList:r,setSelectedCell:a,button:l,filter:i,pageNav:s}){return g().createElement("div",null,g().createElement("div",{style:{display:"flex",justifyContent:"space-between",alignItems:"center",minHeight:"40px",paddingRight:"10px",paddingLeft:"10px",background:"#3c8f49",color:"white",fontSize:"medium"}},g().createElement("span",{style:{overflow:"hidden",textOverflow:"ellipsis"}},e),l&&l),i&&i,g().createElement("div",{style:{minHeight:n?57*n:void 0}},t.map((e=>g().createElement(Me,{cell:e,selectedCellInList:r,setSelectedCell:a})))),s&&s)}var He=n(9093),Ve=n(5875);function De({cellsListResponse:e,setCellsListUrl:t}){const[n,r]=function(e){let t,n;if(null===e.previous&&null===e.next)t=1,n=1;else if(null===e.previous&&null!==e.next)t=1,n=(0,p.ceil)(e.count/e.results.length);else if(null!==e.previous&&null!==e.next){t=Le(e.previous)+1;const r=e.results.length;n=(0,p.ceil)(e.count/r)}else{if(null===e.previous||null!==e.next)throw Error(`Unexpected pagination: ${e}`);t=Le(e.previous)+1,n=t}return[t,n]}(e);return g().createElement(de.A,{direction:"row",spacing:1,sx:{justifyContent:"center",alignItems:"center"}},g().createElement(ne.A,{"aria-label":"Previous",style:{borderRadius:"100%"},onClick:()=>t(e.previous),sx:{visibility:null===e.previous?"hidden":"visible"}},g().createElement(He.A,null)),g().createElement("p",null,"Page ",n," of ",r),g().createElement(ne.A,{"aria-label":"Next",style:{borderRadius:"100%"},onClick:()=>t(e.next),sx:{visibility:null===e.next?"hidden":"visible"}},g().createElement(Ve.A,null)))}var Fe=n(6336),$e=n(8125),We=n(1437),Pe=n(988);function ze({search:e,setSearch:t}){return g().createElement(ue.A,{value:e,onChange:e=>t(e.target.value),slotProps:{input:{startAdornment:g().createElement(he.InputAdornment,{position:"start"},g().createElement($e.A,null)),endAdornment:e&&g().createElement(he.InputAdornment,{position:"end"},g().createElement(ne.A,{"aria-label":"clear search",onClick:()=>t(""),edge:"end",style:{borderRadius:"100%"}},g().createElement(Fe.A,null)))}},size:"small",sx:{"& .MuiInputBase-root":{borderRadius:"100px"}}})}const je=[{value:"modified",label:"First modified"},{value:"-modified",label:"Last modified"},{value:"title",label:"A-Z"},{value:"-title",label:"Z-A"}];function Be({ordering:e,setOrdering:t}){const[n,r]=g().useState(null),a=Boolean(n);return g().createElement(g().Fragment,null,g().createElement(ne.A,{id:"ordering-button","aria-label":"ordering","aria-controls":a?"ordering-menu":void 0,"aria-expanded":a?"true":void 0,"aria-haspopup":"true",style:{borderRadius:"100%"},onClick:e=>r(e.currentTarget)},g().createElement(We.A,null)),g().createElement(he.Menu,{id:"ordering-menu",anchorEl:n,open:a,onClose:()=>r(null),slotProps:{list:{"aria-labelledby":"ordering-button"}}},je.map((n=>g().createElement(he.MenuItem,{key:n.value,selected:n.value===e,onClick:()=>{t(n.value),r(null)}},n.label)))))}function Ze({url:e,setUrl:t}){const[n,r]=(0,h.useState)(null),[a,l]=(0,h.useState)("-modified"),[i]=(0,Pe.useDebouncedValue)(n,200);return(0,h.useEffect)((()=>{const n=function(e,t){if(null===e)return null;const n=new URL(e);for(const[e,r]of Object.entries(t))null===r||""===r?n.searchParams.delete(e):n.searchParams.set(e,r);return n.toString()}(e,{search:i,ordering:a,page:null});t(n)}),[i,a]),g().createElement(de.A,{direction:"row",spacing:1,sx:{justifyContent:"center",alignItems:"center",padding:"10px"}},g().createElement(ze,{search:n,setSearch:r}),g().createElement(Be,{ordering:a,setOrdering:l}))}function Je({settings:e,selectedCellInList:t,setSelectedCell:n}){const r=`?ordering=-modified&virtual_lab=${e.virtualLab}`,[a,l]=(0,h.useState)(e.catalogueServiceUrl?`${e.catalogueServiceUrl}/workflow-cells/${r}`:null);(0,h.useEffect)((()=>{l(`${e.catalogueServiceUrl}/workflow-cells/${r}`)}),[e.catalogueServiceUrl]);const[i,s]=(0,h.useState)({count:0,next:null,previous:null,results:[]}),o=(0,h.useCallback)((e=>{e&&async function(e){const t=await x("GET",e,{accept:"application/json"});if(200!==t.status_code)throw`${t.status_code} ${t.reason}`;return JSON.parse(t.content)}(e).then((e=>s(e)))}),[]);return(0,h.useEffect)((()=>o(a)),[o,a]),g().createElement(P.A,{elevation:12,style:{position:"absolute",top:0,left:0,width:250,height:"100%",overflowX:"hidden",overflowY:"scroll",display:"flex",flexDirection:"column",borderRadius:0}},g().createElement(Ne,{title:"Cells Catalog",cells:i.results,minHeightInCells:10,selectedCellInList:t,setSelectedCell:n,button:g().createElement(O.A,{title:"Refresh",arrow:!0},g().createElement(ne.A,{"aria-label":"Reload",style:{color:"white",borderRadius:"100%"},onClick:()=>o(a)},g().createElement(Re.A,null))),filter:g().createElement(Ze,{url:a,setUrl:l}),pageNav:g().createElement(De,{cellsListResponse:i,setCellsListUrl:l})}),g().createElement(Ne,{title:"Special cells",cells:Te,selectedCellInList:t,setSelectedCell:n}))}function qe({cell:e,cellNode:t,onClose:n}){const[r,a]=(0,h.useState)(null);return(0,Pe.useClickOutside)(n,null,[r,t]),g().createElement(P.A,{ref:a,elevation:12,sx:{position:"absolute",top:20,left:"calc(20px + 250px)",width:380,maxHeight:"calc(100% - 40px)",overflowX:"clip",overflowY:"scroll"}},g().createElement("div",{className:"naavre-workflow-section-header",style:{display:"flex",justifyContent:"space-between",alignItems:"center"}},g().createElement("p",{style:{margin:"0"}},e.title),g().createElement(ne.A,{"aria-label":"Close",style:{color:"white",borderRadius:"100%"},onClick:n},g().createElement(re.A,null))),g().createElement(te,{cell:e}))}const Ye={chart:C,selectedCellInList:null,selectedCellNode:null};class Ke extends h.Component{constructor(e){super(e),this.state=Ye,this.chartStateActions=(0,p.mapValues)(y,(e=>(...t)=>{const n=e(...t)(this.state.chart);this.setState({chart:{...this.state.chart,...n}})})),this.chartConfig={readonly:!1},this.setSelectedCell=(e,t)=>{this.setState({selectedCellInList:e,selectedCellNode:t})},this.setChart=e=>{this.setState({chart:e})},this.getRunWorkflowDialogOptions=()=>({title:"Run Workflow",body:a.ReactWidget.create(h.createElement(Oe,{chart:this.state.chart,settings:this.props.settings})),buttons:[],hasClose:!0}),this.exportWorkflow=async e=>{x("POST",`${this.props.settings.workflowServiceUrl}/convert`,{},{virtual_lab:this.props.settings.virtualLab,naavrewf2:this.state.chart}).then((t=>{var n;null===(n=e.tracker.currentWidget)||void 0===n||n.model.upload(new File([t.content],"workflow.yaml"))})).catch((e=>{const t=`Error exporting the workflow: ${String(e)}`;console.log(t),alert(t)}))}}componentDidUpdate(){}render(){return h.createElement(f.A,{theme:_},h.createElement("div",{style:{display:"flex",flexDirection:"row",flex:1,maxWidth:"100vw",maxHeight:"100vh"}},h.createElement("div",{style:{display:"flex",flexDirection:"column",flex:"1",overflow:"hidden"}},h.createElement(w.FlowChart,{chart:this.state.chart,callbacks:this.chartStateActions,config:this.chartConfig,Components:{Node:L,NodeInner:H,Port:$}}),this.state.chart.selected.id&&h.createElement(se,{chart:this.state.chart,setChart:this.setChart,callbacks:this.chartStateActions,config:this.chartConfig}),this.state.selectedCellInList&&h.createElement(qe,{cell:this.state.selectedCellInList,cellNode:this.state.selectedCellNode,onClose:()=>this.setSelectedCell(null,null)}),h.createElement(Je,{settings:this.props.settings,selectedCellInList:this.state.selectedCellInList,setSelectedCell:this.setSelectedCell}))))}}class Xe extends d.DocumentWidget{constructor(e){super(e)}updateSettings(e){this.content.updateSettings(e)}dispose(){this.content.dispose(),super.dispose()}}class Qe extends a.ReactWidget{constructor(e){super(),this.settings={},this._onContentChanged=()=>{var e;null===(e=this.composerRef.current)||void 0===e||e.setState({chart:this._model.chart})},this.addClass("vre-composer"),this.composerRef=g().createRef(),this._model=e.model,e.ready.then((e=>{this._model.contentChanged.connect(this._onContentChanged),this._onContentChanged(),this.update()})),this._onContentChanged()}updateSettings(e){this.settings={...this.settings,...e},this.update()}render(){return g().createElement(Ke,{ref:this.composerRef,settings:this.settings})}dispose(){this.isDisposed||(this._model.contentChanged.disconnect(this._onContentChanged),u.Signal.clearData(this),super.dispose())}onAfterAttach(e){super.onAfterAttach(e),this.node.addEventListener("focusout",this,!0)}onBeforeDetach(e){this.node.removeEventListener("focusout",this,!0),super.onBeforeDetach(e)}handleEvent(e){var t,n;e.preventDefault(),e.stopPropagation(),e.type&&"focusout"===e.type&&(m().isEqual(this._model.chart,null===(t=this.composerRef.current)||void 0===t?void 0:t.state.chart)||(this._model.chart=(null===(n=this.composerRef.current)||void 0===n?void 0:n.state.chart)||C))}}var et=n(8e3);class tt{constructor(e){this.defaultKernelName="",this.defaultKernelLanguage="",this.sharedModel=nt.create(),this._onClientChanged=()=>{const e=this.sharedModel.awareness.getStates();this._clientChanged.emit(e)},this._onSharedModelChanged=(e,t)=>{t.chartChange&&this.triggerContentChange(),t.stateChange&&t.stateChange.forEach((e=>{"dirty"===e.name?this.dirty=e.newValue:e.oldValue!==e.newValue&&this.triggerStateChange({newValue:void 0,oldValue:void 0,...e})}))},this._dirty=!1,this._isDisposed=!1,this._readOnly=!1,this._clientChanged=new u.Signal(this),this._contentChanged=new u.Signal(this),this._stateChanged=new u.Signal(this);const{collaborationEnabled:t,sharedModel:n}=e;this._collaborationEnabled=!!t,this.sharedModel=n||nt.create(),this.sharedModel.changed.connect(this._onSharedModelChanged),this.sharedModel.awareness.on("change",this._onClientChanged)}get collaborative(){return this._collaborationEnabled}get dirty(){return this._dirty}set dirty(e){const t=this._dirty;e!==t&&(this._dirty=e,this.triggerStateChange({name:"dirty",oldValue:t,newValue:e}))}get isDisposed(){return this._isDisposed}get readOnly(){return this._readOnly}set readOnly(e){if(e===this._readOnly)return;const t=this._readOnly;this._readOnly=e,this.triggerStateChange({name:"readOnly",oldValue:t,newValue:e})}get clientId(){return this.sharedModel.awareness.clientID}get chart(){return this.sharedModel.get("chart")}set chart(e){this.sharedModel.set("chart",e)}get clientChanged(){return this._clientChanged}get contentChanged(){return this._contentChanged}get stateChanged(){return this._stateChanged}dispose(){this._isDisposed||(this._isDisposed=!0,u.Signal.clearData(this))}toString(){return this.sharedModel.getSource()}fromString(e){this.sharedModel.setSource(e)}toJSON(){return JSON.parse(this.toString()||"null")}fromJSON(e){this.fromString(JSON.stringify(e))}initialize(){}triggerStateChange(e){this._stateChanged.emit(e)}triggerContentChange(){this._contentChanged.emit(void 0),this.dirty=!0}}class nt extends et.YDocument{constructor(){super(),this.version="1.0.0",this._contentObserver=e=>{const t={};e.keysChanged.has("chart")&&(t.chartChange=this._content.get("chart")),this._changed.emit(t)},this._content=this.ydoc.getMap("content"),this._content.observe(this._contentObserver)}getSource(){var e;const t={chart:null!==(e=this.get("chart"))&&void 0!==e?e:C};return JSON.stringify(t,null,2)}setSource(e){let t=C;if(e){const n=JSON.parse(e);t=n.chart}this.transact((()=>{this.set("chart",t)}))}dispose(){this.isDisposed||(this._content.unobserve(this._contentObserver),super.dispose())}static create(){return new nt}get(e){const t=this._content.get(e);return"chart"===e?t?JSON.parse(t):C:null!=t?t:""}set(e,t){this._content.set(e,["chart"].includes(e)?JSON.stringify(t):t)}}class rt extends d.ABCWidgetFactory{constructor(e){super(e)}createNewWidget(e){return new Xe({context:e,content:new Qe(e)})}}class at{constructor(){this.collaborative=!0,this._disposed=!1}get name(){return"naavrewf-model"}get contentType(){return"naavrewfdoc"}get fileFormat(){return"text"}get isDisposed(){return this._disposed}dispose(){this._disposed=!0}preferredLanguage(e){return""}createNew(e){return new tt(e)}}var lt,it=n(9346);!function(e){e.createSaveButton=function(e,t){return new a.ToolbarButton({label:"Save",tooltip:"Save the workflow",icon:it.saveIcon,onClick:()=>{t.execute("docmanager:save")}})},e.createExportButton=function(e,t){return new a.ToolbarButton({label:"Export",tooltip:"Export the workflow",icon:it.codeIcon,onClick:()=>{var n;null===(n=e.content.composerRef.current)||void 0===n||n.exportWorkflow(t)}})},e.createRunButton=function(e){return new a.ToolbarButton({label:"Run",tooltip:"Run the workflow",icon:it.runIcon,onClick:()=>{var t;return(0,a.showDialog)(null===(t=e.content.composerRef.current)||void 0===t?void 0:t.getRunWorkflowDialogOptions())}})}}(lt||(lt={}));const st=new it.LabIcon({name:"launcher-icon",svgstr:'<?xml version="1.0" encoding="UTF-8" standalone="no"?>\n<svg\n   width="66.69"\n   height="66.69"\n   viewBox="0 0 66.69 66.69"\n   version="1.1"\n   id="svg5"\n   sodipodi:docname="launcher-icon.svg"\n   inkscape:version="1.4 (e7c3feb100, 2024-10-09)"\n   xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape"\n   xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd"\n   xmlns:xlink="http://www.w3.org/1999/xlink"\n   xmlns="http://www.w3.org/2000/svg"\n   xmlns:svg="http://www.w3.org/2000/svg">\n  <sodipodi:namedview\n     id="namedview5"\n     pagecolor="#ffffff"\n     bordercolor="#666666"\n     borderopacity="1.0"\n     inkscape:showpageshadow="2"\n     inkscape:pageopacity="0.0"\n     inkscape:pagecheckerboard="0"\n     inkscape:deskcolor="#d1d1d1"\n     inkscape:zoom="5.6423717"\n     inkscape:cx="12.671976"\n     inkscape:cy="62.739574"\n     inkscape:current-layer="svg5" />\n  <defs\n     id="defs1">\n    <linearGradient\n       id="swatch5"\n       inkscape:swatch="solid">\n      <stop\n         style="stop-color:#3c8f49;stop-opacity:1;"\n         offset="0"\n         id="stop5" />\n    </linearGradient>\n    <style\n       id="style1">\n      .a92fba6e-7ebd-4c32-8963-8296e20ef654 {\n        fill: #0f4e8b;\n      }\n    </style>\n    <linearGradient\n       inkscape:collect="always"\n       xlink:href="#swatch5"\n       id="linearGradient5"\n       x1="0"\n       y1="33.352931"\n       x2="66.69"\n       y2="33.352931"\n       gradientUnits="userSpaceOnUse" />\n  </defs>\n  <g\n     id="a472ef7c-dd17-4d49-9df0-027f7f177a8f"\n     data-name="Livello 2"\n     style="fill:url(#linearGradient5)">\n    <g\n       id="b55479a9-ce75-42ce-9f6a-fdbd00d931c6"\n       data-name="Livello 1"\n       style="fill:url(#linearGradient5)">\n      <g\n         id="g5"\n         style="fill:url(#linearGradient5)">\n        <path\n           class="a92fba6e-7ebd-4c32-8963-8296e20ef654"\n           d="M33.34,40.87a5.38,5.38,0,1,0,5.38,5.38,5.39,5.39,0,0,0-5.38-5.38Zm0,8.61a3.23,3.23,0,1,1,3.23-3.23,3.23,3.23,0,0,1-3.23,3.23Z"\n           id="path1"\n           style="fill:url(#linearGradient5)" />\n        <rect\n           class="a92fba6e-7ebd-4c32-8963-8296e20ef654"\n           x="32.27"\n           y="4.3"\n           width="8.6"\n           height="2.15"\n           id="rect1"\n           style="fill:url(#linearGradient5)" />\n        <rect\n           class="a92fba6e-7ebd-4c32-8963-8296e20ef654"\n           x="32.27"\n           y="8.6"\n           width="8.6"\n           height="2.15"\n           id="rect2"\n           style="fill:url(#linearGradient5)" />\n        <rect\n           class="a92fba6e-7ebd-4c32-8963-8296e20ef654"\n           x="25.81"\n           y="12.91"\n           width="15.06"\n           height="2.15"\n           id="rect3"\n           style="fill:url(#linearGradient5)" />\n        <rect\n           class="a92fba6e-7ebd-4c32-8963-8296e20ef654"\n           x="25.81"\n           y="17.21"\n           width="15.06"\n           height="2.15"\n           id="rect4"\n           style="fill:url(#linearGradient5)" />\n        <rect\n           class="a92fba6e-7ebd-4c32-8963-8296e20ef654"\n           x="25.81"\n           y="21.51"\n           width="15.06"\n           height="2.15"\n           id="rect5"\n           style="fill:url(#linearGradient5)" />\n        <path\n           class="a92fba6e-7ebd-4c32-8963-8296e20ef654"\n           d="M66.69,34.42V25.81H51.63v8.61h6.45V45.17H45.17V43.32l-2.64-.88L43.78,40l-4.14-4.14-2.49,1.25-.88-2.64H34.42V28H45.17V15.06H58.08v6L55.62,18.6l-1.53,1.52,5.07,5.06,5.06-5.06L62.7,18.6l-2.47,2.47V12.91H45.17V0H28.6L21.51,7.08v5.83H6.45v8.16L4,18.6,2.47,20.12l5.06,5.06,5.06-5.06L11.07,18.6,8.6,21.07v-6H21.51V28H32.27v6.45H30.42l-.88,2.64-2.49-1.25L22.91,40l1.24,2.49-2.64.88v1.85H8.6V34.42h6.46V25.81H0v8.61H6.45V51.78a4.31,4.31,0,1,0,2.15,0V47.33h6.46v13.1a3.23,3.23,0,1,0,2.15,0V47.33h4.3v1.85l2.64.88-1.24,2.49,4.14,4.14,2.49-1.25.88,2.64h5.85l.88-2.64,2.49,1.25,4.14-4.14-1.25-2.49,2.64-.88V47.33h4.31v13.1a3.23,3.23,0,1,0,2.15,0V47.33h6.45v4.45a4.31,4.31,0,1,0,2.15,0V34.42ZM28,3.67V6.45H25.18ZM23.66,8.6h6.46V2.15H43V25.81H23.66ZM2.15,28H12.91v4.3H2.15Zm7.53,28a2.15,2.15,0,1,1-2.15-2.15,2.15,2.15,0,0,1,2.15,2.15Zm6.45,8.61a1.08,1.08,0,1,1,1.08-1.08,1.08,1.08,0,0,1-1.08,1.08ZM43,47.63l-2.46.82-.19.47c0,.14-.1.28-.16.41L40,49.8l1.16,2.32-1.94,2-2.33-1.16-.46.2-.41.17-.48.18-.82,2.47H32l-.83-2.47-.48-.18-.4-.17-.46-.2-2.33,1.16-1.95-2,1.17-2.32-.21-.47c-.06-.13-.11-.27-.17-.41l-.18-.47-2.47-.82V44.87l2.47-.82.18-.47c.06-.14.11-.28.17-.41l.21-.47-1.17-2.32,1.95-2,2.33,1.16.46-.2.4-.17.48-.18L32,36.57h2.75L35.54,39l.48.18.41.17.46.21,2.33-1.17,1.94,2L40,42.7l.21.47c.06.13.11.27.17.41l.18.47,2.46.83Zm7.53,16.91a1.08,1.08,0,1,1,1.08-1.08,1.08,1.08,0,0,1-1.08,1.08Zm10.76-8.61a2.15,2.15,0,1,1-2.15-2.15,2.15,2.15,0,0,1,2.15,2.15ZM53.78,28H64.54v4.3H53.78Z"\n           id="path5"\n           style="fill:url(#linearGradient5)" />\n      </g>\n    </g>\n  </g>\n</svg>\n'});var ot,ct;new it.LabIcon({name:"panel-icon",svgstr:'<?xml version="1.0" encoding="UTF-8" standalone="no"?>\n\x3c!-- Created with Inkscape (http://www.inkscape.org/) --\x3e\n\n<svg\n   width="20"\n   height="20"\n   version="1.1"\n   viewBox="0 0 5.2916639 5.2916639"\n   xml:space="preserve"\n   id="svg7"\n   sodipodi:docname="extension-icon.svg"\n   inkscape:version="1.4 (e7c3feb100, 2024-10-09)"\n   xmlns:inkscape="http://www.inkscape.org/namespaces/inkscape"\n   xmlns:sodipodi="http://sodipodi.sourceforge.net/DTD/sodipodi-0.dtd"\n   xmlns:xlink="http://www.w3.org/1999/xlink"\n   xmlns="http://www.w3.org/2000/svg"\n   xmlns:svg="http://www.w3.org/2000/svg"><defs\n     id="defs7"><linearGradient\n       id="swatch20"\n       inkscape:swatch="solid"><stop\n         style="stop-color:#000000;stop-opacity:1;"\n         offset="0"\n         id="stop20" /></linearGradient><linearGradient\n       id="swatch12"\n       inkscape:swatch="solid"><stop\n         style="stop-color:#000000;stop-opacity:1;"\n         offset="0"\n         id="stop12" /></linearGradient><linearGradient\n       id="swatch9"\n       inkscape:swatch="solid"><stop\n         style="stop-color:#000000;stop-opacity:1;"\n         offset="0"\n         id="stop9" /></linearGradient><linearGradient\n       id="swatch8"\n       inkscape:swatch="solid"><stop\n         style="stop-color:#3c8f49;stop-opacity:1;"\n         offset="0"\n         id="stop8" /></linearGradient><linearGradient\n       id="swatch7"\n       inkscape:swatch="solid"><stop\n         style="stop-color:#000000;stop-opacity:1;"\n         offset="0"\n         id="stop7" /></linearGradient><clipPath\n       clipPathUnits="userSpaceOnUse"\n       id="clipPath33"><path\n         d="M 0,0 H 595.276 V 841.89 H 0 Z"\n         transform="translate(-364.14791,-348.99961)"\n         id="path33" /></clipPath><clipPath\n       clipPathUnits="userSpaceOnUse"\n       id="clipPath40"><path\n         d="M 0,0 H 595.276 V 841.89 H 0 Z"\n         transform="translate(-395.09281,-354.98901)"\n         id="path40" /></clipPath><linearGradient\n       inkscape:collect="always"\n       xlink:href="#swatch8"\n       id="linearGradient7"\n       x1="92.20253"\n       y1="296.08044"\n       x2="141.51561"\n       y2="296.08044"\n       gradientUnits="userSpaceOnUse"\n       gradientTransform="matrix(20.437953,0,0,20.400997,24.954893,177.72344)" /><linearGradient\n       inkscape:collect="always"\n       xlink:href="#swatch8"\n       id="linearGradient9"\n       gradientUnits="userSpaceOnUse"\n       x1="92.20253"\n       y1="296.08044"\n       x2="141.51561"\n       y2="296.08044"\n       gradientTransform="matrix(20.437953,0,0,20.400997,24.954893,177.72344)" /><linearGradient\n       inkscape:collect="always"\n       xlink:href="#swatch8"\n       id="linearGradient10"\n       gradientUnits="userSpaceOnUse"\n       x1="92.20253"\n       y1="296.08044"\n       x2="141.51561"\n       y2="296.08044"\n       gradientTransform="matrix(20.437953,0,0,20.400997,24.95489,177.72344)" /><linearGradient\n       inkscape:collect="always"\n       xlink:href="#swatch8"\n       id="linearGradient11"\n       gradientUnits="userSpaceOnUse"\n       x1="92.20253"\n       y1="296.08044"\n       x2="141.51561"\n       y2="296.08044"\n       gradientTransform="matrix(20.437953,0,0,20.400997,24.954893,177.72344)" /><linearGradient\n       inkscape:collect="always"\n       xlink:href="#swatch8"\n       id="linearGradient12"\n       x1="38.725582"\n       y1="239.17892"\n       x2="119.33492"\n       y2="239.17892"\n       gradientUnits="userSpaceOnUse"\n       gradientTransform="matrix(20.437955,0,0,20.400997,24.954895,177.72344)" /><linearGradient\n       inkscape:collect="always"\n       xlink:href="#swatch8"\n       id="linearGradient13"\n       x1="75.722961"\n       y1="217.14847"\n       x2="82.33754"\n       y2="217.14847"\n       gradientUnits="userSpaceOnUse"\n       gradientTransform="matrix(20.437954,0,0,20.400997,24.954894,177.72344)" /><linearGradient\n       inkscape:collect="always"\n       xlink:href="#swatch8"\n       id="linearGradient20"\n       x1="31.019951"\n       y1="250.64404"\n       x2="53.045799"\n       y2="250.64404"\n       gradientUnits="userSpaceOnUse"\n       gradientTransform="matrix(20.437954,0,0,20.400997,24.954893,177.72344)" /><linearGradient\n       inkscape:collect="always"\n       xlink:href="#swatch8"\n       id="linearGradient21"\n       x1="105.01471"\n       y1="250.64404"\n       x2="127.04055"\n       y2="250.64404"\n       gradientUnits="userSpaceOnUse"\n       gradientTransform="matrix(20.437955,0,0,20.400998,24.954894,177.72344)" /><linearGradient\n       inkscape:collect="always"\n       xlink:href="#swatch8"\n       id="linearGradient22"\n       x1="68.017326"\n       y1="250.64404"\n       x2="90.043175"\n       y2="250.64404"\n       gradientUnits="userSpaceOnUse"\n       gradientTransform="matrix(20.437955,0,0,20.400998,24.954894,177.72344)" /></defs><sodipodi:namedview\n     id="namedview7"\n     pagecolor="#ffffff"\n     bordercolor="#666666"\n     borderopacity="1.0"\n     inkscape:showpageshadow="2"\n     inkscape:pageopacity="0.0"\n     inkscape:pagecheckerboard="0"\n     inkscape:deskcolor="#d1d1d1"\n     inkscape:zoom="27.188668"\n     inkscape:cx="7.3192259"\n     inkscape:cy="21.001397"\n     inkscape:current-layer="g22"\n     showgrid="false"><inkscape:grid\n       id="grid1"\n       units="px"\n       originx="-0.5291664"\n       originy="-0.5291664"\n       spacingx="0.2645832"\n       spacingy="0.2645832"\n       empcolor="#ff3f3f"\n       empopacity="0.25098039"\n       color="#3f3fff"\n       opacity="0.1254902"\n       empspacing="10"\n       enabled="true"\n       visible="false" /></sodipodi:namedview><g\n     id="g22"\n     transform="matrix(0.04892858,0,0,0.04901721,-1.2210061,-8.7115099)"\n     style="stroke-width:5.40265;stroke-dasharray:none"><path\n       id="rect7"\n       style="opacity:1;fill:none;stroke:url(#linearGradient7);stroke-width:5.40263;stroke-miterlimit:8;stroke-dasharray:none;paint-order:stroke fill markers"\n       d="m 27.65618,261.39123 h 21.635064 v 21.58618 H 27.65618 Z"\n       sodipodi:nodetypes="ccccc" /><path\n       id="rect9"\n       style="opacity:1;fill:none;stroke:url(#linearGradient9);stroke-width:5.40263;stroke-miterlimit:8;stroke-dasharray:none;paint-order:stroke fill markers"\n       d="m 65.508951,261.39123 h 21.635064 v 21.58618 H 65.508951 Z"\n       sodipodi:nodetypes="ccccc" /><path\n       id="rect10"\n       style="opacity:1;fill:none;stroke:url(#linearGradient10);stroke-width:5.40263;stroke-miterlimit:8;stroke-dasharray:none;paint-order:stroke fill markers"\n       d="m 103.36172,261.39123 h 21.63507 v 21.58618 h -21.63507 z"\n       sodipodi:nodetypes="ccccc" /><path\n       id="rect11"\n       style="opacity:1;fill:none;stroke:url(#linearGradient11);stroke-width:5.40262;stroke-miterlimit:8;stroke-dasharray:none;paint-order:stroke fill markers"\n       d="M 65.508946,180.42481 V 202.011 H 87.14402 v -21.58619 z" /><path\n       style="opacity:1;fill:none;stroke:url(#linearGradient13);stroke-width:5.40263;stroke-miterlimit:8;stroke-dasharray:none;paint-order:stroke fill markers"\n       d="m 76.324548,210.11006 v 37.78433"\n       id="path11"\n       sodipodi:nodetypes="cc" /><path\n       style="opacity:1;fill:none;stroke:url(#linearGradient12);stroke-width:5.40263;stroke-miterlimit:8;stroke-dasharray:none;stroke-opacity:1;paint-order:stroke fill markers"\n       d="M 38.471258,247.89439 V 223.6069 h 75.710452 v 24.28749"\n       id="path12"\n       sodipodi:nodetypes="cccc" /><path\n       style="opacity:1;fill:none;stroke:url(#linearGradient20);stroke-width:5.40263;stroke-miterlimit:8;stroke-dasharray:none;stroke-opacity:1;paint-order:stroke fill markers"\n       d="m 26.855112,237.89486 11.716755,11.59659 11.716756,-11.59659"\n       id="path18"\n       inkscape:transform-center-y="-0.28421607"\n       sodipodi:nodetypes="ccc" /><path\n       style="opacity:1;fill:none;stroke:url(#linearGradient21);stroke-width:5.40263;stroke-miterlimit:8;stroke-dasharray:none;stroke-opacity:1;paint-order:stroke fill markers"\n       d="m 102.56065,237.89487 11.71676,11.59659 11.71676,-11.59659"\n       id="path19"\n       inkscape:transform-center-y="-0.28421561"\n       sodipodi:nodetypes="ccc" /><path\n       style="opacity:1;fill:none;stroke:url(#linearGradient22);stroke-width:5.40263;stroke-miterlimit:8;stroke-dasharray:none;stroke-opacity:1;paint-order:stroke fill markers"\n       d="m 64.707883,237.89487 11.716756,11.59659 11.716756,-11.59659"\n       id="path20"\n       inkscape:transform-center-y="-0.28421561"\n       sodipodi:nodetypes="ccc" /></g></svg>\n'}),function(e){e.createNew="create-vre-composer"}(ot||(ot={})),function(e){e.addCommands=function(e,t,n){e.addCommand(ot.createNew,{label:"Experiment Manager",caption:"Launch Workflow Composition",icon:e=>e.isPalette?void 0:st,execute:r=>{var a;return async function(e,t,n){const r=await e.execute("docmanager:new-untitled",{path:t,type:"file",ext:"naavrewf"});if(void 0!==r){const t=await e.execute("docmanager:open",{path:r.path,factory:n});return t.isUntitled=!0,t}}(e,r.cwd||(null===(a=t.tracker.currentWidget)||void 0===a?void 0:a.model.path),n)}})}}(ct||(ct={}));const dt="NaaVRE workflow editor",ut=new i.Token("naavrewfDocTracker"),pt={id:"@naavre/workflow-jupyterlab:plugin",autoStart:!0,requires:[r.ILayoutRestorer,l.ILauncher,o.ITranslator,a.IToolbarWidgetRegistry,s.ISettingRegistry,c.IFileBrowserFactory],optional:[],provides:ut,activate:(e,t,n,r,l,i,s)=>{let o;console.log("JupyterLab extension @naavre/workflow-jupyterlab is activated!"),ct.addCommands(e.commands,s,dt),n&&n.add({command:ot.createNew,category:"VRE Components",rank:0}),l&&(l.registerFactory(dt,"saveWorkflow",(t=>lt.createSaveButton(t,e.commands))),l.registerFactory(dt,"exportWorkflow",(e=>lt.createExportButton(e,s))),l.registerFactory(dt,"runWorkflow",(e=>lt.createRunButton(e))),i&&(o=(0,a.createToolbarFactory)(l,i,dt,pt.id,r)));const c=new a.WidgetTracker({namespace:"documents-naavrewf"});function d(e){var t;null===(t=c.currentWidget)||void 0===t||t.updateSettings(e.composite)}t&&t.restore(c,{command:"docmanager:open",args:e=>({path:e.context.path,factory:dt}),name:e=>e.context.path}),i&&Promise.all([e.restored,i.load(pt.id)]).then((([,e])=>{d(e),e.changed.connect(d),c.currentChanged.connect((()=>d(e)))})).catch((e=>{console.error("Failed to load settings for @naavre/containerizer-jupyterlab.",e)})),e.docRegistry.addFileType({name:"naavrewf",displayName:"NaaVRE Workflow",mimeTypes:["text/json","application/json"],extensions:[".naavrewf"],fileFormat:"text",contentType:"naavrewfdoc"});const u=new at;e.docRegistry.addModelFactory(u);const p=new rt({name:dt,modelName:"naavrewf-model",fileTypes:["naavrewf"],defaultFor:["naavrewf"],toolbarFactory:o});p.widgetCreated.connect(((e,t)=>{t.context.pathChanged.connect((()=>{c.save(t)})),c.add(t)})),e.docRegistry.addWidgetFactory(p)}},mt=pt}}]);