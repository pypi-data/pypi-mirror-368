#include "inttypes.h"
#include "ntt.h"
#include "params.h"
#include "reduce.h"

#define zetas AIGIS_ENC_NAMESPACE(zetas)
const int16_t zetas[PARAM_N] = { 0,3777,-3182,3625,-3696,-1100,2456,2194,121,-2250,834,-2495,-2319,2876,-1701,1414,2816,-2088,-2237,1986,-1599,1993,3706,-2006,-1525,-2557,1296,1483,-2830,3364,617,1921,-3689,-1738,3266,-3600,810,1887,-638,-7,-438,-679,-1305,-1760,396,-3174,-3555,-1881,3772,-2535,-2440,-2555,1535,-549,3153,2310,-1399,1321,514,-2956,-103,2804,-2043,-1431,-1054,1698,-3456,1166,2426,3831,915,-2,-3417,-194,2919,2789,3405,2385,-2113,-2732,2175,373,3692,-730,-1756,3135,-2391,660,-1497,2572,-3145,1350,-2224,-3588,-1681,2883,-1390,1598,3750,2762,2835,2764,-2233,3816,-1533,1464,-727,1521,1386,-3428,-921,-2743,-2160,2649,-859,2579,1532,1919,-486,404,-1056,783,1799,-2665,3480,2133,-3310,-1168,-17,3744,2422,2001,1278,929,-1348,-2230,-179,-1242,-2059,-1070,2161,1649,2072,3177,-2071,1121,-436,236,715,670,-658,-1476,-2378,2767,3542,-226,1203,1181,-151,-3794,1712,-222,2786,-451,-3547,1779,-1151,-434,3568,-3693,3581,-1586,1509,2918,2339,-1407,3434,-3550,2340,2891,2998,-3314,3461,-2719,-2247,-2589,1144,1072,1295,-2815,-3770,3450,3781,-2258,796,3163,-3208,-589,2963,-124,3214,3334,-3366,-3745,3723,1931,-429,-402,-3408,83,-1526,826,-1338,2345,-2303,2515,-642,-1837,-2965,-791,370,293,3312,2083,-1689,-777,2070,2262,-893,2386,-188,-1519,-2874,-1404,1012,2130,1441,2532,-3335,-1084,-3343,2937,509,-1403,2812,3763,592,2005,3657,2460,-3677,3752,692,1669,2167,-3287 };

#define zetas_inv AIGIS_ENC_NAMESPACE(zetas_inv)
const int16_t zetas_inv[PARAM_N] = { 3287,-2167,-1669,-692,-3752,3677,-2460,-3657,-2005,-592,-3763,-2812,1403,-509,-2937,3343,1084,3335,-2532,-1441,-2130,-1012,1404,2874,1519,188,-2386,893,-2262,-2070,777,1689,-2083,-3312,-293,-370,791,2965,1837,642,-2515,2303,-2345,1338,-826,1526,-83,3408,402,429,-1931,-3723,3745,3366,-3334,-3214,124,-2963,589,3208,-3163,-796,2258,-3781,-3450,3770,2815,-1295,-1072,-1144,2589,2247,2719,-3461,3314,-2998,-2891,-2340,3550,-3434,1407,-2339,-2918,-1509,1586,-3581,3693,-3568,434,1151,-1779,3547,451,-2786,222,-1712,3794,151,-1181,-1203,226,-3542,-2767,2378,1476,658,-670,-715,-236,436,-1121,2071,-3177,-2072,-1649,-2161,1070,2059,1242,179,2230,1348,-929,-1278,-2001,-2422,-3744,17,1168,3310,-2133,-3480,2665,-1799,-783,1056,-404,486,-1919,-1532,-2579,859,-2649,2160,2743,921,3428,-1386,-1521,727,-1464,1533,-3816,2233,-2764,-2835,-2762,-3750,-1598,1390,-2883,1681,3588,2224,-1350,3145,-2572,1497,-660,2391,-3135,1756,730,-3692,-373,-2175,2732,2113,-2385,-3405,-2789,-2919,194,3417,2,-915,-3831,-2426,-1166,3456,-1698,1054,1431,2043,-2804,103,2956,-514,-1321,1399,-2310,-3153,549,-1535,2555,2440,2535,-3772,1881,3555,3174,-396,1760,1305,679,438,7,638,-1887,-810,3600,-3266,1738,3689,-1921,-617,-3364,2830,-1483,-1296,2557,1525,2006,-3706,-1993,1599,-1986,2237,2088,-2816,-1414,1701,-2876,2319,2495,-834,2250,-121,-2194,-2456,1100,3696,-3625,3182,-1905 };

#define chac AIGIS_ENC_NAMESPACE(chac)
#if BITS_PK == 9
const uint16_t chac[512] = { 2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,0,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2 };
#elif BITS_PK == 10
const uint16_t chac[1024] = { 0,4,0,19,0,34,0,49,0,64,0,79,0,94,0,109,0,124,0,139,0,154,0,169,0,184,0,199,0,214,0,229,0,244,0,259,0,274,0,289,0,304,0,319,0,334,0,349,0,364,0,379,0,394,0,409,0,424,0,439,0,454,0,469,0,484,0,499,0,514,0,529,0,544,0,559,0,574,0,589,0,604,0,619,0,634,0,649,0,664,0,679,0,694,0,709,0,724,0,739,0,754,0,769,0,784,0,799,0,814,0,829,0,844,0,859,0,874,0,889,0,904,0,919,0,934,0,949,0,964,0,979,0,994,0,1009,0,1024,0,1039,0,1054,0,1069,0,1084,0,1099,0,1114,0,1129,0,1144,0,1159,0,1174,0,1189,0,1204,0,1219,0,1234,0,1249,0,1264,0,1279,0,1294,0,1309,0,1324,0,1339,0,1354,0,1369,0,1384,0,1399,0,1414,0,1429,0,1444,0,1459,0,1474,0,1489,0,1504,0,1519,0,1534,0,1549,0,1564,0,1579,0,1594,0,1609,0,1624,0,1639,0,1654,0,1669,0,1684,0,1699,0,1714,0,1729,0,1744,0,1759,0,1774,0,1789,0,1804,0,1819,0,1834,0,1849,0,1864,0,1879,0,1894,0,1909,1917,0,1932,0,1947,0,1962,0,1977,0,1992,0,2007,0,2022,0,2037,0,2052,0,2067,0,2082,0,2097,0,2112,0,2127,0,2142,0,2157,0,2172,0,2187,0,2202,0,2217,0,2232,0,2247,0,2262,0,2277,0,2292,0,2307,0,2322,0,2337,0,2352,0,2367,0,2382,0,2397,0,2412,0,2427,0,2442,0,2457,0,2472,0,2487,0,2502,0,2517,0,2532,0,2547,0,2562,0,2577,0,2592,0,2607,0,2622,0,2637,0,2652,0,2667,0,2682,0,2697,0,2712,0,2727,0,2742,0,2757,0,2772,0,2787,0,2802,0,2817,0,2832,0,2847,0,2862,0,2877,0,2892,0,2907,0,2922,0,2937,0,2952,0,2967,0,2982,0,2997,0,3012,0,3027,0,3042,0,3057,0,3072,0,3087,0,3102,0,3117,0,3132,0,3147,0,3162,0,3177,0,3192,0,3207,0,3222,0,3237,0,3252,0,3267,0,3282,0,3297,0,3312,0,3327,0,3342,0,3357,0,3372,0,3387,0,3402,0,3417,0,3432,0,3447,0,3462,0,3477,0,3492,0,3507,0,3522,0,3537,0,3552,0,3567,0,3582,0,3597,0,3612,0,3627,0,3642,0,3657,0,3672,0,3687,0,3702,0,3717,0,3732,0,3747,0,3762,0,3777,0,3792,0,3807,0,3822,0,3837,0,3852,0,3867,0,3882,0,3897,0,3912,0,3927,0,3942,0,3957,0,3972,0,3987,0,4002,0,4017,0,4032,0,4047,0,4062,0,4077,0,4092,0,4107,0,4122,0,4137,0,4152,0,4167,0,4182,0,4197,0,4212,0,4227,0,4242,0,4257,0,4272,0,4287,0,4302,0,4317,0,4332,0,4347,0,4362,0,4377,0,4392,0,4407,0,4422,0,4437,0,4452,0,4467,0,4482,0,4497,0,4512,0,4527,0,4542,0,4557,0,4572,0,4587,0,4602,0,4617,0,4632,0,4647,0,4662,0,4677,0,4692,0,4707,0,4722,0,4737,0,4752,0,4767,0,4782,0,4797,0,4812,0,4827,0,4842,0,4857,0,4872,0,4887,0,4902,0,4917,0,4932,0,4947,0,4962,0,4977,0,4992,0,5007,0,5022,0,5037,0,5052,0,5067,0,5082,0,5097,0,5112,0,5127,0,5142,0,5157,0,5172,0,5187,0,5202,0,5217,0,5232,0,5247,0,5262,0,5277,0,5292,0,5307,0,5322,0,5337,0,5352,0,5367,0,5382,0,5397,0,5412,0,5427,0,5442,0,5457,0,5472,0,5487,0,5502,0,5517,0,5532,0,5547,0,5562,0,5577,0,5592,0,5607,0,5622,0,5637,0,5652,0,5667,0,5682,0,5697,0,5712,0,5727,0,5742,0,5757,5765,0,5780,0,5795,0,5810,0,5825,0,5840,0,5855,0,5870,0,5885,0,5900,0,5915,0,5930,0,5945,0,5960,0,5975,0,5990,0,6005,0,6020,0,6035,0,6050,0,6065,0,6080,0,6095,0,6110,0,6125,0,6140,0,6155,0,6170,0,6185,0,6200,0,6215,0,6230,0,6245,0,6260,0,6275,0,6290,0,6305,0,6320,0,6335,0,6350,0,6365,0,6380,0,6395,0,6410,0,6425,0,6440,0,6455,0,6470,0,6485,0,6500,0,6515,0,6530,0,6545,0,6560,0,6575,0,6590,0,6605,0,6620,0,6635,0,6650,0,6665,0,6680,0,6695,0,6710,0,6725,0,6740,0,6755,0,6770,0,6785,0,6800,0,6815,0,6830,0,6845,0,6860,0,6875,0,6890,0,6905,0,6920,0,6935,0,6950,0,6965,0,6980,0,6995,0,7010,0,7025,0,7040,0,7055,0,7070,0,7085,0,7100,0,7115,0,7130,0,7145,0,7160,0,7175,0,7190,0,7205,0,7220,0,7235,0,7250,0,7265,0,7280,0,7295,0,7310,0,7325,0,7340,0,7355,0,7370,0,7385,0,7400,0,7415,0,7430,0,7445,0,7460,0,7475,0,7490,0,7505,0,7520,0,7535,0,7550,0,7565,0,7580,0,7595,0,7610,0,7625,0,7640,0,7655,0,7670 };
#elif BITS_PK == 11
const uint16_t chac[2048] = { 0,4,8,11,0,19,23,26,0,34,38,41,0,49,53,56,0,64,68,71,0,79,83,86,0,94,98,101,0,109,113,116,0,124,128,131,0,139,143,146,0,154,158,161,0,169,173,176,0,184,188,191,0,199,203,206,0,214,218,221,0,229,233,236,0,244,248,251,0,259,263,266,0,274,278,281,0,289,293,296,0,304,308,311,0,319,323,326,0,334,338,341,0,349,353,356,0,364,368,371,0,379,383,386,0,394,398,401,0,409,413,416,0,424,428,431,0,439,443,446,0,454,458,461,0,469,473,476,0,484,488,491,0,499,503,506,0,514,518,521,0,529,533,536,0,544,548,551,0,559,563,566,0,574,578,581,0,589,593,596,0,604,608,611,0,619,623,626,0,634,638,641,0,649,653,656,0,664,668,671,0,679,683,686,0,694,698,701,0,709,713,716,0,724,728,731,0,739,743,746,0,754,758,761,0,769,773,776,0,784,788,791,0,799,803,806,0,814,818,821,0,829,833,836,0,844,848,851,0,859,863,866,0,874,878,881,0,889,893,896,0,904,908,911,0,919,923,926,0,934,938,941,0,949,953,956,960,0,968,971,975,0,983,986,990,0,998,1001,1005,0,1013,1016,1020,0,1028,1031,1035,0,1043,1046,1050,0,1058,1061,1065,0,1073,1076,1080,0,1088,1091,1095,0,1103,1106,1110,0,1118,1121,1125,0,1133,1136,1140,0,1148,1151,1155,0,1163,1166,1170,0,1178,1181,1185,0,1193,1196,1200,0,1208,1211,1215,0,1223,1226,1230,0,1238,1241,1245,0,1253,1256,1260,0,1268,1271,1275,0,1283,1286,1290,0,1298,1301,1305,0,1313,1316,1320,0,1328,1331,1335,0,1343,1346,1350,0,1358,1361,1365,0,1373,1376,1380,0,1388,1391,1395,0,1403,1406,1410,0,1418,1421,1425,0,1433,1436,1440,0,1448,1451,1455,0,1463,1466,1470,0,1478,1481,1485,0,1493,1496,1500,0,1508,1511,1515,0,1523,1526,1530,0,1538,1541,1545,0,1553,1556,1560,0,1568,1571,1575,0,1583,1586,1590,0,1598,1601,1605,0,1613,1616,1620,0,1628,1631,1635,0,1643,1646,1650,0,1658,1661,1665,0,1673,1676,1680,0,1688,1691,1695,0,1703,1706,1710,0,1718,1721,1725,0,1733,1736,1740,0,1748,1751,1755,0,1763,1766,1770,0,1778,1781,1785,0,1793,1796,1800,0,1808,1811,1815,0,1823,1826,1830,0,1838,1841,1845,0,1853,1856,1860,0,1868,1871,1875,0,1883,1886,1890,0,1898,1901,1905,0,1913,1916,1920,0,1928,1932,1935,0,1943,1947,1950,0,1958,1962,1965,0,1973,1977,1980,0,1988,1992,1995,0,2003,2007,2010,0,2018,2022,2025,0,2033,2037,2040,0,2048,2052,2055,0,2063,2067,2070,0,2078,2082,2085,0,2093,2097,2100,0,2108,2112,2115,0,2123,2127,2130,0,2138,2142,2145,0,2153,2157,2160,0,2168,2172,2175,0,2183,2187,2190,0,2198,2202,2205,0,2213,2217,2220,0,2228,2232,2235,0,2243,2247,2250,0,2258,2262,2265,0,2273,2277,2280,0,2288,2292,2295,0,2303,2307,2310,0,2318,2322,2325,0,2333,2337,2340,0,2348,2352,2355,0,2363,2367,2370,0,2378,2382,2385,0,2393,2397,2400,0,2408,2412,2415,0,2423,2427,2430,0,2438,2442,2445,0,2453,2457,2460,0,2468,2472,2475,0,2483,2487,2490,0,2498,2502,2505,0,2513,2517,2520,0,2528,2532,2535,0,2543,2547,2550,0,2558,2562,2565,0,2573,2577,2580,0,2588,2592,2595,0,2603,2607,2610,0,2618,2622,2625,0,2633,2637,2640,0,2648,2652,2655,0,2663,2667,2670,0,2678,2682,2685,0,2693,2697,2700,0,2708,2712,2715,0,2723,2727,2730,0,2738,2742,2745,0,2753,2757,2760,0,2768,2772,2775,0,2783,2787,2790,0,2798,2802,2805,0,2813,2817,2820,0,2828,2832,2835,0,2843,2847,2850,0,2858,2862,2865,0,2873,2877,2880,2884,0,2892,2895,2899,0,2907,2910,2914,0,2922,2925,2929,0,2937,2940,2944,0,2952,2955,2959,0,2967,2970,2974,0,2982,2985,2989,0,2997,3000,3004,0,3012,3015,3019,0,3027,3030,3034,0,3042,3045,3049,0,3057,3060,3064,0,3072,3075,3079,0,3087,3090,3094,0,3102,3105,3109,0,3117,3120,3124,0,3132,3135,3139,0,3147,3150,3154,0,3162,3165,3169,0,3177,3180,3184,0,3192,3195,3199,0,3207,3210,3214,0,3222,3225,3229,0,3237,3240,3244,0,3252,3255,3259,0,3267,3270,3274,0,3282,3285,3289,0,3297,3300,3304,0,3312,3315,3319,0,3327,3330,3334,0,3342,3345,3349,0,3357,3360,3364,0,3372,3375,3379,0,3387,3390,3394,0,3402,3405,3409,0,3417,3420,3424,0,3432,3435,3439,0,3447,3450,3454,0,3462,3465,3469,0,3477,3480,3484,0,3492,3495,3499,0,3507,3510,3514,0,3522,3525,3529,0,3537,3540,3544,0,3552,3555,3559,0,3567,3570,3574,0,3582,3585,3589,0,3597,3600,3604,0,3612,3615,3619,0,3627,3630,3634,0,3642,3645,3649,0,3657,3660,3664,0,3672,3675,3679,0,3687,3690,3694,0,3702,3705,3709,0,3717,3720,3724,0,3732,3735,3739,0,3747,3750,3754,0,3762,3765,3769,0,3777,3780,3784,0,3792,3795,3799,0,3807,3810,3814,0,3822,3825,3829,0,3837,3841,3844,0,3852,3856,3859,0,3867,3871,3874,0,3882,3886,3889,0,3897,3901,3904,0,3912,3916,3919,0,3927,3931,3934,0,3942,3946,3949,0,3957,3961,3964,0,3972,3976,3979,0,3987,3991,3994,0,4002,4006,4009,0,4017,4021,4024,0,4032,4036,4039,0,4047,4051,4054,0,4062,4066,4069,0,4077,4081,4084,0,4092,4096,4099,0,4107,4111,4114,0,4122,4126,4129,0,4137,4141,4144,0,4152,4156,4159,0,4167,4171,4174,0,4182,4186,4189,0,4197,4201,4204,0,4212,4216,4219,0,4227,4231,4234,0,4242,4246,4249,0,4257,4261,4264,0,4272,4276,4279,0,4287,4291,4294,0,4302,4306,4309,0,4317,4321,4324,0,4332,4336,4339,0,4347,4351,4354,0,4362,4366,4369,0,4377,4381,4384,0,4392,4396,4399,0,4407,4411,4414,0,4422,4426,4429,0,4437,4441,4444,0,4452,4456,4459,0,4467,4471,4474,0,4482,4486,4489,0,4497,4501,4504,0,4512,4516,4519,0,4527,4531,4534,0,4542,4546,4549,0,4557,4561,4564,0,4572,4576,4579,0,4587,4591,4594,0,4602,4606,4609,0,4617,4621,4624,0,4632,4636,4639,0,4647,4651,4654,0,4662,4666,4669,0,4677,4681,4684,0,4692,4696,4699,0,4707,4711,4714,0,4722,4726,4729,0,4737,4741,4744,0,4752,4756,4759,0,4767,4771,4774,0,4782,4786,4789,0,4797,4801,4804,4808,0,4816,4819,4823,0,4831,4834,4838,0,4846,4849,4853,0,4861,4864,4868,0,4876,4879,4883,0,4891,4894,4898,0,4906,4909,4913,0,4921,4924,4928,0,4936,4939,4943,0,4951,4954,4958,0,4966,4969,4973,0,4981,4984,4988,0,4996,4999,5003,0,5011,5014,5018,0,5026,5029,5033,0,5041,5044,5048,0,5056,5059,5063,0,5071,5074,5078,0,5086,5089,5093,0,5101,5104,5108,0,5116,5119,5123,0,5131,5134,5138,0,5146,5149,5153,0,5161,5164,5168,0,5176,5179,5183,0,5191,5194,5198,0,5206,5209,5213,0,5221,5224,5228,0,5236,5239,5243,0,5251,5254,5258,0,5266,5269,5273,0,5281,5284,5288,0,5296,5299,5303,0,5311,5314,5318,0,5326,5329,5333,0,5341,5344,5348,0,5356,5359,5363,0,5371,5374,5378,0,5386,5389,5393,0,5401,5404,5408,0,5416,5419,5423,0,5431,5434,5438,0,5446,5449,5453,0,5461,5464,5468,0,5476,5479,5483,0,5491,5494,5498,0,5506,5509,5513,0,5521,5524,5528,0,5536,5539,5543,0,5551,5554,5558,0,5566,5569,5573,0,5581,5584,5588,0,5596,5599,5603,0,5611,5614,5618,0,5626,5629,5633,0,5641,5644,5648,0,5656,5659,5663,0,5671,5674,5678,0,5686,5689,5693,0,5701,5704,5708,0,5716,5719,5723,0,5731,5734,5738,0,5746,5749,5753,0,5761,5765,5768,0,5776,5780,5783,0,5791,5795,5798,0,5806,5810,5813,0,5821,5825,5828,0,5836,5840,5843,0,5851,5855,5858,0,5866,5870,5873,0,5881,5885,5888,0,5896,5900,5903,0,5911,5915,5918,0,5926,5930,5933,0,5941,5945,5948,0,5956,5960,5963,0,5971,5975,5978,0,5986,5990,5993,0,6001,6005,6008,0,6016,6020,6023,0,6031,6035,6038,0,6046,6050,6053,0,6061,6065,6068,0,6076,6080,6083,0,6091,6095,6098,0,6106,6110,6113,0,6121,6125,6128,0,6136,6140,6143,0,6151,6155,6158,0,6166,6170,6173,0,6181,6185,6188,0,6196,6200,6203,0,6211,6215,6218,0,6226,6230,6233,0,6241,6245,6248,0,6256,6260,6263,0,6271,6275,6278,0,6286,6290,6293,0,6301,6305,6308,0,6316,6320,6323,0,6331,6335,6338,0,6346,6350,6353,0,6361,6365,6368,0,6376,6380,6383,0,6391,6395,6398,0,6406,6410,6413,0,6421,6425,6428,0,6436,6440,6443,0,6451,6455,6458,0,6466,6470,6473,0,6481,6485,6488,0,6496,6500,6503,0,6511,6515,6518,0,6526,6530,6533,0,6541,6545,6548,0,6556,6560,6563,0,6571,6575,6578,0,6586,6590,6593,0,6601,6605,6608,0,6616,6620,6623,0,6631,6635,6638,0,6646,6650,6653,0,6661,6665,6668,0,6676,6680,6683,0,6691,6695,6698,0,6706,6710,6713,0,6721,6725,6728,6732,0,6740,6743,6747,0,6755,6758,6762,0,6770,6773,6777,0,6785,6788,6792,0,6800,6803,6807,0,6815,6818,6822,0,6830,6833,6837,0,6845,6848,6852,0,6860,6863,6867,0,6875,6878,6882,0,6890,6893,6897,0,6905,6908,6912,0,6920,6923,6927,0,6935,6938,6942,0,6950,6953,6957,0,6965,6968,6972,0,6980,6983,6987,0,6995,6998,7002,0,7010,7013,7017,0,7025,7028,7032,0,7040,7043,7047,0,7055,7058,7062,0,7070,7073,7077,0,7085,7088,7092,0,7100,7103,7107,0,7115,7118,7122,0,7130,7133,7137,0,7145,7148,7152,0,7160,7163,7167,0,7175,7178,7182,0,7190,7193,7197,0,7205,7208,7212,0,7220,7223,7227,0,7235,7238,7242,0,7250,7253,7257,0,7265,7268,7272,0,7280,7283,7287,0,7295,7298,7302,0,7310,7313,7317,0,7325,7328,7332,0,7340,7343,7347,0,7355,7358,7362,0,7370,7373,7377,0,7385,7388,7392,0,7400,7403,7407,0,7415,7418,7422,0,7430,7433,7437,0,7445,7448,7452,0,7460,7463,7467,0,7475,7478,7482,0,7490,7493,7497,0,7505,7508,7512,0,7520,7523,7527,0,7535,7538,7542,0,7550,7553,7557,0,7565,7568,7572,0,7580,7583,7587,0,7595,7598,7602,0,7610,7613,7617,0,7625,7628,7632,0,7640,7643,7647,0,7655,7658,7662,0,7670,7673,7677 };
#endif

void ntt(int16_t *a)
{
	int level, start, j, k, step;
	int32_t zeta;
	int16_t t;

	k = 1;
	step = (1 << 7);
	for (start = 0; start < PARAM_N; start = j + step)
	{
		zeta = zetas[k++];
		for (j = start; j < start + step; ++j)
		{
			t = montgomery_reduce(zeta * a[j + step]);
			a[j + step] = a[j] - t;
			a[j] = a[j] + t;
		}
	}
	step = (1 << 6);
	for (start = 0; start < PARAM_N; start = j + step)
	{
		zeta = zetas[k++];
		for (j = start; j < start + step; ++j)
		{
			t = montgomery_reduce(zeta * a[j + step]);
			a[j + step] = barrett_reduce(a[j] - t);
			a[j] = barrett_reduce(a[j] + t);
		}
	}

	for (level = 5; level >= 4; level--)
	{
		step = (1 << level);
		for (start = 0; start < PARAM_N; start = j + step)
		{
			zeta = zetas[k++];
			for (j = start; j < start + step; ++j)
			{
				t = montgomery_reduce(zeta * a[j + step]);
				a[j + step] = a[j] - t;
				a[j] = a[j] + t;
			}
		}
	}
	step = (1 << 3);
	for (start = 0; start < PARAM_N; start = j + step)
	{
		zeta = zetas[k++];
		for (j = start; j < start + step; ++j)
		{
			t = montgomery_reduce(zeta * a[j + step]);
			a[j + step] = barrett_reduce(a[j] - t);
			a[j] = barrett_reduce(a[j] + t);
		}
	}
	for (level = 2; level >= 1; level--)
	{
		step = (1 << level);
		for (start = 0; start < PARAM_N; start = j + step)
		{
			zeta = zetas[k++];
			for (j = start; j < start + step; ++j)
			{
				t = montgomery_reduce(zeta * a[j + step]);
				a[j + step] = a[j] - t;
				a[j] = a[j] + t;
			}
		}
	}
	step = 1;
	for (start = 0; start < PARAM_N; start = j + step)
	{
		zeta = zetas[k++];
		for (j = start; j < start + step; ++j)
		{
			t = montgomery_reduce(zeta * a[j + step]);
			a[j + step] = barrett_reduce(a[j] - t);
			a[j] = barrett_reduce(a[j] + t);
		}
	}
}

void invntt(int16_t * a) {
	int start, level, step, j, k;
	int32_t zeta, t;

	k = 0;
	for (level = 0; level < 7; level++) {
		step = (1 << level);
		for (start = 0; start < PARAM_N; start = j + step) {
			zeta = zetas_inv[k++];
			for (j = start; j < start + step; ++j)
			{
				t = a[j];
				if (level & 1)
					a[j] = barrett_reduce(t + a[j + step]);
				else
					a[j] = t + a[j + step];
				t -= a[j + step];
				a[j + step] = montgomery_reduce(zeta * t);
			}
		}
	}

	step = (1 << 7);
	for (start = 0; start < PARAM_N; start = j + step) {
		zeta = zetas_inv[k++];
		for (j = start; j < start + step; ++j)
		{
			t = a[j];
			a[j] = t + a[j + step];
			a[j] = montgomery_reduce(256 * (int32_t)a[j]);
			t -= a[j + step];
			a[j + step] = montgomery_reduce(zeta * t);
		}
	}
}
