Metadata-Version: 2.4
Name: anime_api_scraper
Version: 1.0.1
Summary: Scraper robusto para extraer informaciÃ³n de sitios de anime, comenzando con AnimeFlv
Author-email: DSt3v3n <haroldsabogal48@gmail.com>
License: MIT
Project-URL: Homepage, https://github.com/dst3v3n/Anime-Api
Project-URL: Documentation, https://github.com/dst3v3n/Anime-Api#readme
Project-URL: Repository, https://github.com/dst3v3n/Anime-Api.git
Project-URL: Bug Tracker, https://github.com/dst3v3n/Anime-Api/issues
Keywords: anime,scraper,web-scraping,animeflv,streaming
Classifier: Development Status :: 4 - Beta
Classifier: Intended Audience :: Developers
Classifier: License :: OSI Approved :: MIT License
Classifier: Operating System :: OS Independent
Classifier: Programming Language :: Python :: 3
Classifier: Programming Language :: Python :: 3.8
Classifier: Programming Language :: Python :: 3.9
Classifier: Programming Language :: Python :: 3.10
Classifier: Programming Language :: Python :: 3.11
Classifier: Programming Language :: Python :: 3.12
Classifier: Topic :: Internet :: WWW/HTTP :: Dynamic Content
Classifier: Topic :: Software Development :: Libraries :: Python Modules
Requires-Python: >=3.8
Description-Content-Type: text/markdown
License-File: LICENSE
Requires-Dist: beautifulsoup4>=4.11.0
Requires-Dist: cloudscraper>=1.2.60
Requires-Dist: requests>=2.28.0
Requires-Dist: lxml>=4.9.0
Provides-Extra: dev
Requires-Dist: pytest>=7.0.0; extra == "dev"
Requires-Dist: pytest-cov>=4.0.0; extra == "dev"
Requires-Dist: black>=22.0.0; extra == "dev"
Requires-Dist: flake8>=5.0.0; extra == "dev"
Requires-Dist: mypy>=0.991; extra == "dev"
Dynamic: license-file

# ğŸŒ Anime Scraper

Un scraper web robusto y escalable para extraer informaciÃ³n de sitios de anime, comenzando con **AnimeFlv**. Este proyecto estÃ¡ diseÃ±ado con una arquitectura modular que permite agregar fÃ¡cilmente nuevos sitios de anime en el futuro.

## ğŸ“‹ CaracterÃ­sticas

- ğŸ” **BÃºsqueda de animes** por nombre con paginaciÃ³n
- ğŸ“Š **InformaciÃ³n detallada** de animes (sinopsis, gÃ©neros, episodios, etc.)
- ğŸ†• **Animes mÃ¡s recientes** desde la pÃ¡gina principal
- ğŸ“º **Episodios recientes** con informaciÃ³n actualizada
- ğŸ”— **Enlaces de reproducciÃ³n** para episodios especÃ­ficos
- ğŸ›¡ï¸ **ProtecciÃ³n anti-bot** usando cloudscraper
- ğŸ—ï¸ **Arquitectura modular** para fÃ¡cil extensiÃ³n a nuevos sitios

## ğŸš€ InstalaciÃ³n

### Requisitos previos

- Python 3.8+
- pip (gestor de paquetes de Python)

### InstalaciÃ³n desde PyPI

```bash
pip install anime-api-scraper
```

**Dependencias incluidas:**
- `beautifulsoup4` - Parsing HTML
- `cloudscraper` - Evadir protecciones anti-bot
- `requests` - Peticiones HTTP
- `lxml` - Parser XML/HTML rÃ¡pido

## ğŸ“ Estructura del Proyecto

```
anime_api_scraper/
â”œâ”€â”€ models/
â”‚   â””â”€â”€ data_models.py          # Modelos de datos (AnimeInfo, SearchResponse, etc.)
â”œâ”€â”€ processors/
â”‚   â”œâ”€â”€ base_processors.py      # Clase base para procesadores
â”‚   â””â”€â”€ animeflv_processors.py  # Procesador especÃ­fico para AnimeFlv
â”œâ”€â”€ scraper/
â”‚   â”œâ”€â”€ base_scraper.py         # Clase base para scrapers
â”‚   â””â”€â”€ animeflv_scraper.py     # Scraper especÃ­fico para AnimeFlv
â”œâ”€â”€ services/
â”‚   â”œâ”€â”€ base_services.py        # Clase base para servicios
â”‚   â””â”€â”€ animeflv_services.py    # Servicio principal para AnimeFlv
â””â”€â”€ utils/
    â””â”€â”€ exception.py            # Excepciones personalizadas
```

## ğŸ”§ Uso

### InicializaciÃ³n del Servicio

```python
from anime_api_scraper import AnimeFLV

# Usando context manager (recomendado)
with AnimeFLV() as anime_service:
    # Tu cÃ³digo aquÃ­
    pass
```

### BÃºsqueda de Animes

```python
with AnimeFLV() as anime_service:
    # Buscar animes por nombre
    resultados = anime_service.search_anime("Naruto", pagina=1)
    
    print(f"PÃ¡gina {resultados.pagination.pagina_actual} de {resultados.pagination.pagina_total}")
    
    for anime in resultados.results:
        print(f"ID: {anime.anime_id}")
        print(f"Nombre: {anime.nombre}")
        print(f"Imagen: {anime.imagen}")
```

### InformaciÃ³n Detallada de un Anime

```python
with AnimeFLV() as anime_service:
    # Obtener informaciÃ³n completa
    anime_info = anime_service.anime_info("naruto-tv")
    
    print(f"Nombre: {anime_info.nombre}")
    print(f"Tipo: {anime_info.tipo}")
    print(f"GÃ©neros: {anime_info.genero}")
    print(f"DescripciÃ³n: {anime_info.descripcion}")
    print(f"Estado: {anime_info.estado}")
    print(f"Episodios disponibles: {len(anime_info.episodios)}")
    
    if anime_info.proximo_episodio:
        print(f"PrÃ³ximo episodio: {anime_info.proximo_episodio}")
    
    # Animes relacionados
    for relacionado in anime_info.animes_relacionados:
        print(f"- {relacionado.nombre} (ID: {relacionado.anime_id})")
```

### Animes y Episodios Recientes

```python
with AnimeFLV() as anime_service:
    # Obtener animes mÃ¡s recientes
    animes_recientes = anime_service.latest_anime()
    
    for anime in animes_recientes:
        print(f"{anime.nombre} - {anime.tipo} - â­{anime.puntaje}")
    
    # Obtener episodios mÃ¡s recientes
    episodios_recientes = anime_service.latest_episodes()
    
    for episodio in episodios_recientes:
        print(f"{episodio.nombre} - Episodio {episodio.episodio}")
```

### Enlaces de ReproducciÃ³n

```python
with AnimeFLV() as anime_service:
    # Obtener enlaces para un episodio especÃ­fico
    enlaces = anime_service.links("naruto", "1")
    
    for enlace in enlaces:
        print(f"Servidor: {enlace.server}")
        print(f"TÃ­tulo: {enlace.titulo}")
        print(f"URL: {enlace.url}")
```

## ğŸ“Š Modelos de Datos

### AnimeSearchResult
InformaciÃ³n bÃ¡sica para resultados de bÃºsqueda:
- `anime_id`: Identificador Ãºnico
- `nombre`: TÃ­tulo del anime
- `imagen`: URL de la imagen de portada

### AnimeInfo
InformaciÃ³n completa del anime:
- `anime_id`: Identificador Ãºnico
- `nombre`: TÃ­tulo completo
- `tipo`: Tipo (TV, Movie, OVA, etc.)
- `genero`: GÃ©neros separados por comas
- `descripcion`: Sinopsis del anime
- `animes_relacionados`: Lista de animes relacionados
- `episodios`: Lista de nÃºmeros de episodios disponibles
- `estado`: Estado de emisiÃ³n (En emisiÃ³n, Finalizado, etc.)
- `proximo_episodio`: Fecha del prÃ³ximo episodio (si aplica)

### LatestAnime
InformaciÃ³n de animes recientes:
- `anime_id`: Identificador Ãºnico
- `nombre`: TÃ­tulo del anime
- `tipo`: Tipo de anime
- `puntaje`: PuntuaciÃ³n (rating)
- `descripciÃ³n`: DescripciÃ³n breve
- `imagen`: URL de la imagen

### LatestEpisodes
InformaciÃ³n de episodios recientes:
- `anime_id`: Identificador del anime
- `nombre`: Nombre del anime
- `episodio`: NÃºmero del episodio
- `imagen`: URL de la imagen del episodio

## ğŸ—ï¸ Arquitectura

### PatrÃ³n de DiseÃ±o

El proyecto utiliza una **arquitectura modular** basada en el patrÃ³n de responsabilidad Ãºnica:

1. **Services** (`BaseServices` â†’ `AnimeFLVServices`)
   - Capa de abstracciÃ³n principal para el cliente
   - GestiÃ³n optimizada de recursos y contexto
   - API limpia y consistente

2. **Scrapers** (`BaseScraper` â†’ `AnimeFLVScraper`)
   - Manejan las peticiones HTTP
   - Coordinan el flujo de scraping
   - Gestionan la sesiÃ³n y configuraciÃ³n especÃ­fica del sitio

3. **Processors** (`BaseProcessors` â†’ `AnimeFLVProcessors`)
   - Procesan el HTML crudo
   - Extraen y estructuran los datos
   - Convierten HTML en objetos Python

4. **Models** (`data_models.py`)
   - Definen la estructura de datos
   - Validan tipos usando dataclasses
   - Proporcionan consistencia entre componentes

### Ventajas de esta Arquitectura

- âœ… **Escalabilidad**: FÃ¡cil agregar nuevos sitios
- âœ… **Mantenibilidad**: SeparaciÃ³n clara de responsabilidades
- âœ… **ReutilizaciÃ³n**: Componentes base reutilizables
- âœ… **Testeo**: Cada componente se puede testear independientemente

## ğŸ”® Extensibilidad

Para agregar un nuevo sitio de anime (ej: Crunchyroll):

1. **Crear el procesador especÃ­fico**:
```python
from anime_api_scraper.processors.base_processors import BaseProcessors

class CrunchyrollProcessors(BaseProcessors):
    def process_search(self, response):
        # LÃ³gica especÃ­fica para Crunchyroll
        pass
```

2. **Crear el scraper especÃ­fico**:
```python
from anime_api_scraper.scraper.base_scraper import BaseScraper

class CrunchyrollScraper(BaseScraper):
    def __init__(self):
        self._base_url = "https://crunchyroll.com"
        self._processor = CrunchyrollProcessors()
```

3. **Crear el servicio especÃ­fico**:
```python
from anime_api_scraper.services.base_services import BaseServices

class CrunchyrollServices(BaseServices):
    def __init__(self):
        super().__init__()
        self._scraper = CrunchyrollScraper()
```

## âš¡ Manejo de Errores

El proyecto incluye manejo robusto de errores:

### AnimeException
ExcepciÃ³n personalizada que incluye:
- `message`: DescripciÃ³n del error
- `metodo`: MÃ©todo donde ocurriÃ³ el error
- `source`: Fuente del error (ej: "animeflv")

### Validaciones Comunes
- âœ… ValidaciÃ³n de parÃ¡metros de entrada
- âœ… VerificaciÃ³n de elementos HTML existentes
- âœ… Manejo de contenido malformado
- âœ… Timeout y errores de conectividad

## ğŸ›¡ï¸ CaracterÃ­sticas TÃ©cnicas

### Anti-Bot Protection
- Utiliza `cloudscraper` para evadir protecciones Cloudflare
- Headers realistas de navegador
- Manejo automÃ¡tico de challenges JavaScript

### Parsing Robusto
- MÃºltiples selectores CSS como fallback
- ValidaciÃ³n de datos extraÃ­dos
- Manejo graceful de contenido faltante

### Performance
- SesiÃ³n persistente para mÃºltiples requests
- Parser `lxml` para velocidad optimizada
- Context managers para gestiÃ³n eficiente de recursos

## ğŸ“ Ejemplos Avanzados

### BÃºsqueda con PaginaciÃ³n Completa

```python
def buscar_anime_completo(nombre):
    """Busca un anime en todas las pÃ¡ginas disponibles."""
    from anime_api_scraper import AnimeFLV
    
    with AnimeFLV() as anime_service:
        todos_resultados = []
        pagina = 1
        
        while True:
            resultado = anime_service.search_anime(nombre, pagina)
            todos_resultados.extend(resultado.results)
            
            if pagina >= resultado.pagination.pagina_total:
                break
            pagina += 1
        
        return todos_resultados
```

### InformaciÃ³n Completa de un Anime

```python
def info_anime_completa(anime_id):
    """Obtiene toda la informaciÃ³n disponible de un anime."""
    from anime_api_scraper import AnimeFLV
    
    with AnimeFLV() as anime_service:
        info = anime_service.anime_info(anime_id)
        
        # Obtener enlaces del primer episodio si estÃ¡ disponible
        enlaces = []
        if info.episodios:
            try:
                enlaces = anime_service.links(anime_id, info.episodios[0])
            except Exception as e:
                print(f"No se pudieron obtener enlaces: {e}")
        
        return {
            'info': info,
            'enlaces_primer_episodio': enlaces
        }
```

## ğŸ¤ Contribuir

1. Fork el repositorio
2. Crea una rama para tu feature (`git checkout -b feature/nueva-funcionalidad`)
3. Commit tus cambios (`git commit -am 'Agrega nueva funcionalidad'`)
4. Push a la rama (`git push origin feature/nueva-funcionalidad`)
5. Crea un Pull Request

### GuÃ­as para Contribuir

- Sigue el estilo de cÃ³digo existente
- Agrega docstrings a todas las funciones pÃºblicas
- Incluye manejo de errores apropiado
- Escribe tests para nuevas funcionalidades

## âš ï¸ Consideraciones Legales

Este proyecto estÃ¡ diseÃ±ado para **uso educativo y personal**. Los usuarios son responsables de:

- Cumplir con los tÃ©rminos de servicio de los sitios web
- Respetar los derechos de autor del contenido
- Usar el scraper de manera responsable y Ã©tica
- No sobrecargar los servidores con requests excesivos

## ğŸ› ResoluciÃ³n de Problemas

### Errores Comunes

**Error: "No se encontraron resultados"**
- Verifica que el nombre del anime estÃ© escrito correctamente
- Algunos animes pueden tener nombres especÃ­ficos en el sitio

**Error de conexiÃ³n**
- Verifica tu conexiÃ³n a internet
- El sitio podrÃ­a estar temporalmente inaccesible
- Considera implementar reintentos automÃ¡ticos

**Error: "No se pudieron obtener enlaces"**
- Verifica que el anime_id y nÃºmero de episodio sean correctos
- Algunos episodios pueden no tener enlaces disponibles

## ğŸ”„ Roadmap

### VersiÃ³n Actual (v1.0)
- âœ… Scraper completo para AnimeFlv
- âœ… BÃºsqueda, informaciÃ³n detallada y enlaces
- âœ… Manejo robusto de errores

### Futuras Versiones
- ğŸ“‹ Soporte para mÃºltiples sitios de anime
- ğŸ”„ Sistema de cache para mejorar performance
- ğŸ“Š API REST para acceso programÃ¡tico
- ğŸ¤– Rate limiting inteligente
- ğŸ“± Interfaz web para uso fÃ¡cil
- ğŸ” BÃºsqueda avanzada con filtros
- ğŸ“ˆ EstadÃ­sticas y analytics

## ğŸ·ï¸ Versionado

Utilizamos [SemVer](http://semver.org/) para el versionado. Para las versiones disponibles, revisa los [tags de este repositorio](https://github.com/dst3v3n/Anime-Api/tags).

## ğŸ“„ Licencia

Este proyecto estÃ¡ bajo la Licencia MIT - revisa el archivo [LICENSE](LICENSE) para mÃ¡s detalles.

## ğŸ‘¥ Autores

- **DSt3v3n** - *Desarrollo inicial* - [dst3v3n](https://github.com/dst3v3n)

## ğŸ™ Agradecimientos

- Comunidad de desarrolladores de Python
- Mantenedores de BeautifulSoup y cloudscraper
- Sitios de anime que proporcionan contenido a los fans

## ğŸ“ Soporte

Si encuentras algÃºn problema o tienes preguntas:

1. Revisa la secciÃ³n de [Issues](https://github.com/dst3v3n/Anime-Api/issues)
2. Crea un nuevo issue con detalles del problema
3. Incluye informaciÃ³n de tu entorno (Python version, OS, etc.)

---

**âš¡ Â¿Te gusta el proyecto?** Â¡Dale una estrella â­ en GitHub!
