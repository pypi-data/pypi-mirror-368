var r=null,d=0,m="",u;const l=document.getElementById("loader"),c=document.getElementById("loginbutton"),f=document.getElementById("login-btn-inactive"),i=document.getElementById("username"),s=document.getElementById("password"),y=document.querySelector(".show-password");function g(e){i.value.length>0&&s.value.length>0&&(f.classList.add("hide"),l.classList.contains("hide")&&c.classList.remove("hide")),(i.value.length<=0||s.value.length<=0)&&(f.classList.remove("hide"),c.classList.add("hide")),i.value.length>0&&s.value.length>0&&e&&e.keyCode===13&&(e.preventDefault(),p())}window.onload=async function(){const t=(await(await fetch("/api/v1/system/version")).json()).result,n=document.getElementById("versionHolder");n.innerHTML=t,navigator.userAgent.indexOf("Chrome")!=-1||navigator.userAgent.indexOf("Edg")!=-1||navigator.userAgent.indexOf("Edge")!=-1||navigator.userAgent.indexOf("Firefox")!=-1||(document.getElementById("browserWarning").style.display="block")};async function p(){c.classList.add("hide"),l.classList.remove("hide"),i.tabIndex="-1",s.tabIndex="-1",i.disabled=!0,s.disabled=!0;const e=await fetch("api/v1/auth/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({username:i.value,password:s.value})}),t=await e.json();if(e.ok&&t.success)u=t.result,localStorage.setItem("postLoginInfo",JSON.stringify(u)),L(),setTimeout(function(){l.classList.add("hide"),c.classList.remove("hide"),u.isConnected?document.location.href="/":document.location.href="/#/connectivity"},1e3);else{const n=/\d+/,a=t.message.toString(),o=a.match(n);o!==null&&r===null&&(r=setInterval(I,1e3),d=o,m=a),v(t.message.toString()),l.classList.add("hide"),c.classList.remove("hide")}i.tabIndex="1",s.tabIndex="1",i.disabled=!1,s.disabled=!1}function L(){const e=document.getElementById("error");e.innerHTML="";const t=document.createElement("div");t.classList.add("alert"),t.classList.add("alert--info");const n=document.createElement("div");n.classList.add("alert__icon"),n.classList.add("icon-info-outline"),t.appendChild(n);const a=document.createElement("div");a.classList.add("alert__message");const o=document.createElement("a"),h=document.createTextNode("If your browser does not automatically redirect you, please click here.");o.appendChild(h),a.appendChild(o),o.title="redirection",o.href="/",t.appendChild(a),e.appendChild(t)}function v(e){const t=document.getElementById("error");t.innerHTML="";const n=document.createElement("div");n.classList.add("alert"),n.classList.add("alert--warning");const a=document.createElement("div");a.classList.add("alert__icon"),a.classList.add("icon-warning-outline"),n.appendChild(a);const o=document.createElement("div");o.classList.add("alert__message"),o.textContent=e,n.appendChild(o),t.appendChild(n)}function I(){if(d-=1,v(m.replace(/\d+/,d)),d==0){clearInterval(r);const e=document.getElementById("error");e.innerHTML="",r=null,d=0,m=""}}function E(){const e=document.querySelector(".icon");e.classList.contains("icon-eye")?(e.classList.remove("icon-eye"),e.classList.add("icon-eye-closed")):e.classList.contains("icon-eye-closed")&&(e.classList.remove("icon-eye-closed"),e.classList.add("icon-eye")),s.type!="password"?s.type="password":s.type="text"}y.onclick=E;c.onclick=p;i.onkeyup=g;s.onkeyup=g;setInterval(()=>{g()},250);
