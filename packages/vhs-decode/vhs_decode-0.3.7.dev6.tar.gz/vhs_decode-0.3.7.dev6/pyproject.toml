[build-system]
requires = ["setuptools>=61", "setuptools-rust", "setuptools_scm>=6.2", "wheel", "Cython", "numpy"]
# requires = ["setuptools>=61", "wheel", "Cython", "numpy"]
build-backend = "setuptools.build_meta"

[project]
name = "vhs_decode"
description = "Software Decoder for raw rf captures of laserdisc, vhs and other analog video formats"
readme = "README_pypi.md"
requires-python = ">=3.8"
keywords = ["laserdisc", "vhs", "video", "tape", "decoder"]
license = {file = "LICENSE"}
classifiers = [
    "Topic :: Multimedia :: Video",
    "Programming Language :: Rust",
]
dependencies = [
    "numpy>=1.22","numba>=0.58.1","scipy>=1.10.1",'samplerate==0.1; platform_system == "Linux"', 'samplerate; platform_system != "Linux"', "static-ffmpeg", "cython", "soundfile>=0.13.1", "sounddevice", "importlib_resources >= 5.0; python_version < '3.10'", "matplotlib", "noisereduce>=2.0.0", "rocket-fft>=0.2.5; python_version <= '3.12'", "setproctitle"
]
dynamic = ["version"]
# version = "0.2.1dev0"

[project.optional-dependencies]
intel = [ "intel-cmplr-lib-rt", "icc_rt" ]
hifi_gui = [ "PyQt5>=5.14.1" ]
hifi_gui_qt6 = [ "PyQt6>=6.4.2" ]
# Can probably be depcretaded now since it's also an option in vhs-decode to use it.
hifi_gnuradio = [ "pyzmq" ]
gnuradio = [ "pyzmq" ]

[project.scripts]
ld-decode = "lddecode.main:main"
vhs-decode = "vhsdecode.main:main"
cvbs-decode = "cvbsdecode.main:main"
hifi-decode = "vhsdecode.hifi.main:main"
filter-tune = "filter_tune.filter_tune:main"

#[console_scripts]
# TODO: These should maybe be made modules too
#ld-cut = "ld-cut"
#cx-expander = "cx-expander"
#tbc-video-export = "tbc-video-export"

[project.urls]
Homepage = "https://www.domesday86.com"

[tool.setuptools_scm]
write_to = "vhsdecode/_version.py"
local_scheme = "no-local-version"

[tool.setuptools.package-data]
vhs_decode = ["*.txt"]

[[tool.setuptools-rust.ext-modules]]
# Private Rust extension module to be nested into the Python package
target = "vhsd_rust"

# Needed to prevent building for older macos versions not supported by rust - see https://cibuildwheel.pypa.io/en/stable/faq/#building-rust-wheels
[tool.cibuildwheel.macos.environment]
MACOSX_DEPLOYMENT_TARGET = "10.12"
