"use strict";(self.webpackChunkteamized_reactapp=self.webpackChunkteamized_reactapp||[]).push([[170],{221:(e,s,t)=>{t.d(s,{A:()=>a});var n=t(4848),i=t(9336),l=t(6540);function a({title:e,className:s="",children:t}){const a=(0,l.useRef)(null);return(0,l.useEffect)(()=>{const e=new i.m_(a.current);return()=>e.dispose()},[]),(0,n.jsx)("abbr",{className:s,title:e,"data-bs-toggle":"tooltip",ref:a,children:t})}},1818:(e,s,t)=>{t.d(s,{A:()=>l});var n=t(4848),i=t(1820);const l={Column:function({className:e="",size:s=12,sizes:t={},grow:i=!1,children:l}){let a=`dashboard-column d-flex flex-column ${e} col-${s}`;for(const e of Object.keys(t))a+=` col-${e}-${t[e]}`;return i&&(a+=" flex-grow-1"),(0,n.jsx)("div",{className:a,children:l})},Page:function({loading:e=!1,title:s=null,subtitle:t=null,text:i=null,children:l}){return(0,n.jsxs)("div",{className:"dashboard p-0 w-100 h-100 d-flex flex-column",children:[s&&(0,n.jsx)("h4",{className:"dashboard-title pt-3 mx-3 text-bold",children:s}),t&&(0,n.jsx)("h5",{className:"dashboard-subtitle mt-2 mx-3",children:t}),i&&(0,n.jsx)("p",{className:"dashboard-text mt-2 mx-3",children:i}),e?(0,n.jsxs)("div",{className:"w-100 flex-grow-1 d-flex flex-column align-items-center justify-content-center",children:[(0,n.jsx)("div",{className:"spinner-border mb-3",role:"status",children:(0,n.jsx)("span",{className:"visually-hidden",children:"Laden..."})}),(0,n.jsx)("p",{children:"Seiteninhalt wird geladen..."})]}):(0,n.jsx)("div",{className:"dashboard-row row w-100 g-0 ms-0 px-2 pt-2",children:l})]})},Row:function({className:e="",grow:s=!1,children:t}){let i=`dashboard-row row w-100 g-0 ${e}`;return s&&(i+=" flex-grow-1"),(0,n.jsx)("div",{className:i,children:t})},Tile:function({title:e=null,help:s=null,grow:t=!1,className:l="",children:a=null,loading:r=!1,ref:c=null}){let d=`dashboard-tile row border border-dark rounded mx-2 mb-3 mt-0 flex-column ${l}`;return t&&(d+=" flex-grow-1"),(0,n.jsxs)("div",{className:d,ref:c,children:[e&&(0,n.jsxs)(n.Fragment,{children:[(0,n.jsxs)("h5",{className:"dashboard-tile-title pt-2 text-bold",style:{flexBasis:0},children:[e,s&&(0,n.jsx)(i.A,{className:"ms-2 small",title:s})]}),(0,n.jsx)("hr",{className:"m-0"})]}),(0,n.jsx)("div",{className:"p-2 w-100 overflow-auto flex-grow-1",children:r?(0,n.jsxs)("div",{className:"text-center my-5",children:[(0,n.jsx)("i",{className:"fa-solid fa-spinner fa-spin"}),(0,n.jsx)("span",{className:"ms-2",children:"Daten werden geladen..."})]}):a})]})}}},1820:(e,s,t)=>{t.d(s,{A:()=>l});var n=t(4848),i=t(221);function l({title:e,icon:s="fa-solid fa-info-circle",className:t=""}){return(0,n.jsx)(i.A,{className:t,title:e,children:(0,n.jsx)("i",{className:s})})}},3335:(e,s,t)=>{t.d(s,{A:()=>a});var n=t(4848);function i({show:e=!0,noTopBorder:s=!1,children:t}){return e?(0,n.jsx)("tfoot",{className:s?"border-top-0":"",children:(0,n.jsx)("tr",{children:(0,n.jsx)("td",{colSpan:100,className:"border-bottom-0",children:(0,n.jsx)("div",{className:"w-100 d-inline-flex justify-content-end gap-2",children:t})})})}):null}var l=t(6540);const a={VerticalDataTable:function({items:e,children:s}){const t={head:null,foot:null};return l.Children.forEach(s,e=>{if(l.isValidElement(e))switch(e.type){case"thead":t.head=e;break;case"tfoot":case i:t.foot=e;break;default:console.warn("VerticalDataTable: Unsupported child type",e.type)}}),(0,n.jsxs)("table",{className:"table mb-0",children:[t.head,(0,n.jsx)("tbody",{children:e.map((e,s)=>({item:e,index:s})).filter(({item:e})=>!e.hide).map(({item:e,index:s})=>(0,n.jsxs)("tr",{className:e.isDebugId?"debug-id":"",children:[(0,n.jsxs)("th",{scope:"row",className:e.limitWidth?"pe-3":"",style:{width:e.limitWidth?"1px":void 0},children:[e.label,":"]}),(0,n.jsx)("td",{children:e.value})]},s))}),t.foot]})},ButtonFooter:i,SimpleTable:function({className:e="",children:s}){const t=`table mb-0 ${e}`;return(0,n.jsx)("table",{className:t,children:s})},Th:function({className:e="",children:s,noWrapFlex:t=!1}){return t?(0,n.jsx)("th",{className:"text-nowrap {className}",children:(0,n.jsx)("div",{className:"d-flex flex-nowrap gap-1",children:s})}):(0,n.jsx)("th",{className:e,children:s})}}},9170:(e,s,t)=>{t.r(s),t.d(s,{default:()=>D});var n=t(4848),i=t(6540),l=t(353),a=t(855),r=t(416),c=t(1889),d=t(4100),o=t(1818),m=t(4653),h=t(4921),u=t(9107),x=t(7984),j=t(5869),f=t(5593),g=t(8194),b=t(30);function p({sessions:e,start:s,end:t}){const i=l.F0(e,s,t),a=l.Hn(e)/3600;return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("div",{className:"row row-cols-lg-auto m-1 g-2 align-items-center",children:(0,n.jsx)("div",{className:"col-12 mt-0",children:(0,n.jsxs)("span",{className:"text-muted",children:["Gesamtdauer: ",a.toFixed(2),"h"]})})}),(0,n.jsx)(m.u,{width:"100%",minHeight:400,height:"90%",children:(0,n.jsxs)(h.E,{data:i,margin:{top:30,right:20,left:0,bottom:5},children:[(0,n.jsx)(u.d,{strokeDasharray:"3 3"}),(0,n.jsx)(x.W,{dataKey:"name"}),(0,n.jsx)(j.h,{dataKey:"duration_h",domain:[0,"dataMax"]}),(0,n.jsx)(f.m,{}),(0,n.jsx)(g.s,{}),(0,n.jsx)(b.y,{dataKey:"duration_h",name:"Dauer",unit:"h",fill:"#8884d8"})]})})]})}var w=t(3335),N=t(1820);function v({team:e,session:s}){const t=(0,r.qb)();return(0,n.jsxs)("tr",{children:[(0,n.jsx)("td",{children:(0,n.jsxs)("span",{children:[new Date(s.time_start).toLocaleString()," bis",(0,n.jsx)("br",{}),new Date(s.time_end).toLocaleString(),s.is_created_via_tracking?(0,n.jsx)(N.A,{icon:"fa-solid fa-stopwatch",title:"Diese Sitzung wurde via Aufzeichnung erstellt.",className:"ms-1"}):(0,n.jsx)(N.A,{icon:"fa-solid fa-pencil",title:"Diese Sitzung wurde manuell erfasst.",className:"ms-1"})]})}),(0,n.jsx)("td",{children:(0,n.jsx)("span",{children:(()=>{const e=(0,c.xk)(s.duration);return`${e.hours}h ${e.minutes}min ${e.seconds}s`})()})}),(0,n.jsx)("td",{children:(0,n.jsx)("span",{children:s.note})}),(0,n.jsx)("td",{children:(0,n.jsx)("a",{className:"btn btn-outline-dark border-1",onClick:()=>{l.iX(e,s).then(e=>{e.isConfirmed&&t()})},title:"Sitzung bearbeiten",children:(0,n.jsx)("i",{className:"fa-solid fa-pen-to-square"})})}),(0,n.jsx)("td",{children:(0,n.jsx)("a",{className:"btn btn-outline-danger border-1",onClick:()=>{l.jJ(e,s).then(e=>{e.isConfirmed&&t()})},title:"Sitzung löschen",children:(0,n.jsx)("i",{className:"fa-solid fa-trash"})})}),(0,n.jsx)("td",{className:"debug-id",children:s.id})]})}function y({sessions:e,team:s,loading:t}){return(0,n.jsxs)(w.A.SimpleTable,{children:[(0,n.jsx)("thead",{children:(0,n.jsxs)("tr",{children:[(0,n.jsx)("th",{style:{minWidth:"13rem"},children:"Start & Ende"}),(0,n.jsx)("th",{style:{minWidth:"8rem"},children:"Dauer"}),(0,n.jsx)("th",{style:{minWidth:"15rem"},children:"Notiz"}),(0,n.jsx)("th",{style:{width:"1px"}}),(0,n.jsx)("th",{style:{width:"1px"}}),(0,n.jsx)("th",{className:"debug-id",children:"ID"})]})}),(0,n.jsx)("tbody",{children:t?(0,n.jsx)("tr",{children:(0,n.jsx)("td",{colSpan:3,children:"Laden..."})}):0===e.length?(0,n.jsx)("tr",{children:(0,n.jsx)("td",{colSpan:3,children:"Noch keine Zeiten im ausgewählten Zeitraum erfasst."})}):e.map(e=>(0,n.jsx)(v,{session:e,team:s},e.id))})]})}function A(e){if(e){const s=(new Date).getTime()-new Date(e.time_start).getTime(),t=(0,c.cK)(s);return`${t.hours}:${t.minutes}:${t.seconds}`}return"00:00:00"}function z({team:e}){const s=(0,r.DO)(),t=(0,r.qb)(),a=s.current_worksession,[c,d]=(0,i.useState)(A(a)),o=(0,i.useRef)(null),m=(0,i.useRef)(null),h=(0,i.useRef)(!1),u=(0,i.useRef)(!1);return(0,i.useEffect)(()=>{const s=()=>{const e=A(a);d(e)};return o.current=setInterval(s,1e3),m.current=setInterval(async()=>{const s=a,n=await l.go();!s||n&&s.id===n.id?s&&n&&s.note!==n.note&&t():l.H6(e.id).then(t)},15e3),s(),()=>{o.current&&clearInterval(o.current),m.current&&clearInterval(m.current)}},[a,t,e.id]),(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)("h1",{className:"text-center",children:c}),(0,n.jsx)("div",{className:"text-center",children:a?(0,n.jsxs)("div",{className:"row m-2 g-2",children:[(0,n.jsx)("button",{className:"btn btn-danger col-12",onClick:async()=>{u.current||(u.current=!0,await l.u2().then(t),u.current=!1)},children:"Aufzeichnung beenden"}),(0,n.jsx)("button",{className:"btn btn-outline-dark col-12",onClick:()=>{l._K(e,a).then(e=>{e.isConfirmed&&t()})},children:"Aufzeichnung benennen"})]}):(0,n.jsx)("div",{className:"row m-2",children:(0,n.jsx)("button",{className:"btn btn-success col-12",onClick:async()=>{h.current||(h.current=!0,await l.YO(e.id).then(t),h.current=!1)},children:"Aufzeichnung starten"})})})]})}const k=864e5;function D(){const e=(0,r.qb)(),s=(0,d.CQ)(),t=s?.team,[m,h]=(0,i.useState)((0,c.cJ)(new Date((new Date).getTime()-7*k))),[u,x]=(0,i.useState)((0,c.cJ)(new Date,1)),j=(0,i.useId)(),f=(0,i.useId)(),g=Object.values(s.me_worksessions),b=s._state.me_worksessions._initial;(0,i.useEffect)(()=>{b&&l.H6(t.id).then(e)});const w=l.hl(g,m,u).sort((e,s)=>new Date(s.time_start).getTime()-new Date(e.time_start).getTime());return(0,n.jsxs)(o.A.Page,{title:"Deine Arbeitszeit",subtitle:"Erfasse und verwalte deine Arbeitszeit",loading:b,children:[(0,n.jsxs)(o.A.Column,{sizes:{lg:3},children:[(0,n.jsxs)(o.A.Row,{children:[(0,n.jsx)(o.A.Column,{size:12,sizes:{lg:12,sm:6,md:6},children:(0,n.jsx)(o.A.Tile,{title:"Sitzung aufzeichnen",grow:!0,children:(0,n.jsx)(z,{team:t})})}),(0,n.jsx)(o.A.Column,{size:12,sizes:{lg:12,sm:6,md:6},children:(0,n.jsxs)(o.A.Tile,{title:"Sitzung erfassen",grow:!0,children:[(0,n.jsx)("p",{className:"ms-1",children:"Aufzeichnung vergessen? Kein Problem. Hier können Sitzungen nachträglich manuell erfasst werden."}),(0,n.jsx)("div",{className:"row m-2",children:(0,n.jsx)("button",{className:"btn btn-outline-success col-12",onClick:()=>{l.Us(t).then(s=>{s.isConfirmed&&e()})},children:"Sitzung hinzufügen"})})]})})]}),(0,n.jsx)(o.A.Row,{children:(0,n.jsx)(o.A.Column,{children:(0,n.jsx)(o.A.Tile,{title:"Filter",children:(0,n.jsxs)("div",{className:"row m-2 g-2",children:[(0,n.jsxs)("div",{className:"input-group col-12 p-0 m-0",children:[(0,n.jsx)("div",{className:"input-group-text",style:{minWidth:"4em"},children:"Von"}),(0,n.jsx)("input",{type:"datetime-local",className:"form-control",id:j,required:!0,min:"2022-01-01T00:00",defaultValue:(0,c.VT)(m)})]}),(0,n.jsxs)("div",{className:"input-group col-12 p-0",children:[(0,n.jsx)("div",{className:"input-group-text",style:{minWidth:"4em"},children:"Bis"}),(0,n.jsx)("input",{type:"datetime-local",className:"form-control",id:f,required:!0,min:"2022-01-01T00:00",defaultValue:(0,c.VT)(u)})]}),(0,n.jsx)("button",{className:"btn btn-outline-primary col-12",onClick:()=>{const e=document.getElementById(j).value,s=new Date(e),t=document.getElementById(f).value,n=new Date(t);console.log(e,s,t,n),e&&t&&s&&n?s>n?(0,a.n7)("Hallo Zeitreisender!","Das Startdatum muss vor dem Enddatum liegen."):(h(s),x(n)):(0,a.n7)("Was ist das?","Ein angegebenes Datum ist ungültig")},children:"Anwenden"})]})})})})]}),(0,n.jsx)(o.A.Column,{sizes:{lg:9},children:(0,n.jsx)(o.A.Tile,{title:"Statistiken",help:"Statistiken für den ausgewählten Zeitraum.",grow:!0,children:(0,n.jsx)(p,{sessions:w,start:m,end:u})})}),(0,n.jsx)(o.A.Column,{children:(0,n.jsx)(o.A.Tile,{title:"Erfasste Zeiten",help:"Erfasste Zeiten im ausgewählten Zeitraum.",children:(0,n.jsx)(y,{sessions:w,team:t,loading:b})})})]})}}}]);