[build-system]
requires = ["setuptools", "setuptools-scm"]
build-backend = "setuptools.build_meta"

[project]
name = "tri3d"
authors = [{ name = "Nicolas Granger", email = "nicolas.granger@cea.fr" }]
description = "A unified interface to various 3D driving datasets"
readme = "README.md"
requires-python = ">=3.10"
keywords = []
license = { text = "CECILL-C" }
classifiers = []
dependencies = ["numpy", "Pillow", "shapely", "pyarrow", "pypcd4", "numba"]
dynamic = ["version"]

[project.optional-dependencies]
plot = ["matplotlib", "k3d"]
align_nuscenes = ["torch", "torch-cluster", "tqdm"]

[tool.setuptools]
packages = ["tri3d"]

[tool.setuptools_scm]

[tool.pytest.ini_options]
testpaths = ["tests"]

[tool.coverage.report]
exclude_lines = [
    "@abstractmethod",
    "__repr__",
    "raise ValueError",
    "raise NotImplementedError",
]

[tool.ruff]
extend-include = ["*.ipynb"]

[tool.ruff.lint]
fixable = ["ALL"]
extend-select = ["I"]

[[tool.uv.index]]
name = "pyg"
url = "https://data.pyg.org/whl/torch-2.7.0+cu126.html"
ignore-error-codes = [403]
format = "flat"

[tool.uv.sources]
torch-scatter = { index = "pyg" }
torch-cluster = { index = "pyg" }

[dependency-groups]
dev = [
    "furo",
    "ipykernel",
    "ipympl",
    "ipywidgets",
    "nbsphinx",
    "nbstripout",
    "pytest",
    "pytest-cov",
    "ruff",
    "scipy",
    "sphinx",
]
