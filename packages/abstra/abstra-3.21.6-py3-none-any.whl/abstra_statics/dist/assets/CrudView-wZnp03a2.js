import{c as S,d as O,B as R,r as z}from"./router-D5wfdag3.js";import{_ as j}from"./DocsButton.vue_vue_type_script_setup_true_lang-BnwqPwfA.js";import{i as E}from"./url-CoyBb3Dp.js";import{G as L}from"./PhDotsThreeVertical.vue-B1x6I4wD.js";import{d as P,aK as q,r as $,B as u,m as o,D as s,O as G,G as n,g as p,aj as H,l as V,F as B,U as x,ak as W,p as m,al as Y,aY as Z,aQ as Q,aS as J,$ as c,V as d,aZ as X,e as K,W as ee,n as w,M as A,Y as te,aq as D,H as ae,a_ as le,a$ as ne,aP as se,Z as _,b0 as F,b1 as oe,b2 as ue,b3 as re,aW as M,aH as N,q as ie,ap as pe}from"./jwt-decode.esm-Dca5fHH5.js";import{S as U}from"./index-ZQBk4l6i.js";(function(){try{var v=typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{},y=new Error().stack;y&&(v._sentryDebugIds=v._sentryDebugIds||{},v._sentryDebugIds[y]="197d0b8b-5123-4de5-a874-8164580d4d9b",v._sentryDebugIdIdentifier="sentry-dbid-197d0b8b-5123-4de5-a874-8164580d4d9b")}catch{}})();const ce=P({__name:"CreationModal",props:{entityName:{},fields:{},create:{type:Function}},setup(v,{expose:y}){const g=v,T=`Create ${g.entityName}`,i=q({inputValue:{}}),h=$(!1),b=()=>h.value=!0,C=()=>{h.value=!1,i.inputValue={}},I=async()=>{try{await g.create(i.inputValue),C()}catch(r){r instanceof Error&&X.error({message:"Failed to create",description:r.message})}},l=(r,t)=>{const e=r.target.value,a=g.fields.find(k=>k.key===t);a?.format?i.inputValue[t]=a.format(e):i.inputValue[t]=e},f=(r,t)=>{const e=r.target.value,a=g.fields.find(k=>k.key===t);a?.blur?i.inputValue[t]=a.blur(e):i.inputValue[t]=e};return y({open:b,close:C}),(r,t)=>(o(),u(s(G),{open:h.value,title:T,onCancel:C,onOk:I},{default:n(()=>[p(s(H),{layout:"vertical"},{default:n(()=>[(o(!0),V(B,null,x(r.fields,e=>(o(),u(s(W),{key:e.key,label:e.label,help:e.hint?.(i.inputValue[e.key]),tooltip:e.tooltip},{default:n(()=>[!e.type||e.type==="text"||e.type==="password"?(o(),u(s(Y),{key:0,value:i.inputValue[e.key],"onUpdate:value":a=>i.inputValue[e.key]=a,placeholder:e.placeholder??"",type:e.type??"text",onInput:a=>l(a,e.key),onBlur:a=>f(a,e.key)},null,8,["value","onUpdate:value","placeholder","type","onInput","onBlur"])):e.type==="multiline-text"?(o(),u(s(Z),{key:1,value:i.inputValue[e.key],"onUpdate:value":a=>i.inputValue[e.key]=a,placeholder:e.placeholder??"",onInput:a=>l(a,e.key),onBlur:a=>f(a,e.key)},null,8,["value","onUpdate:value","placeholder","onInput","onBlur"])):e.type==="select"?(o(),u(s(Q),{key:2,value:i.inputValue[e.key],"onUpdate:value":a=>i.inputValue[e.key]=a,mode:e.mode},{default:n(()=>[(o(!0),V(B,null,x(e.options,a=>(o(),u(s(J),{key:typeof a=="string"?a:a.value,value:typeof a=="string"?a:a.value},{default:n(()=>[c(d(typeof a=="string"?a:a.label),1)]),_:2},1032,["value"]))),128))]),_:2},1032,["value","onUpdate:value","mode"])):m("",!0)]),_:2},1032,["label","help","tooltip"]))),128))]),_:1})]),_:1},8,["open"]))}}),de={class:"action-warning"},ye=P({__name:"CrudView",props:{table:{},loading:{type:Boolean},title:{},emptyTitle:{},entityName:{},description:{},create:{type:Function},createButtonText:{},docsPath:{},live:{type:Boolean},fields:{}},setup(v){const y=v,g=$(null),T=(l,f)=>{const r=y.table.rows[0]?.cells[f].type;if(!(r==="actions"||r==="slot"))return(t,e)=>i(t,e,f)},i=(l,f,r)=>{const t=l.cells[r],e=f.cells[r];return t.type==="text"&&e.type==="text"||t.type==="tag"&&e.type==="tag"?t.text.localeCompare(e.text):t.type==="tags"&&e.type==="tags"?t.tags[0].text.localeCompare(e.tags[0].text):t.type==="secret"&&e.type==="secret"||t.type==="link"&&e.type==="link"?t.text.localeCompare(e.text):(t.type==="actions"&&e.type==="actions",0)},h=async()=>{y.fields?g.value?.open():y.create&&await y.create({})},b=$(!1);async function C(l,f){if(!b.value){b.value=!0;try{"onClick"in l?await l.onClick({key:f.key}):"link"in l&&(typeof l.link=="string"&&E(l.link)?open(l.link,"_blank"):z.push(l.link))}finally{b.value=!1}}}const I=K(()=>({"--columnCount":`${y.table.columns.length}`}));return(l,f)=>{const r=ee("RouterLink");return o(),V(B,null,[p(s(U),{direction:"vertical",class:"crud-view"},{default:n(()=>[p(s(A),{align:"center",justify:"space-between"},{default:n(()=>[l.title?(o(),u(s(te),{key:0},{default:n(()=>[c(d(l.title),1)]),_:1})):m("",!0),w(l.$slots,"more",{},void 0,!0)]),_:3}),l.description?(o(),u(s(D),{key:0},{default:n(()=>[c(d(l.description)+" ",1),w(l.$slots,"description",{},void 0,!0),l.docsPath?(o(),u(j,{key:0,path:l.docsPath},null,8,["path"])):m("",!0)]),_:3})):m("",!0),p(s(A),{gap:"middle"},{default:n(()=>[l.createButtonText?(o(),u(s(ae),{key:0,type:"primary",onClick:h},{default:n(()=>[c(d(l.createButtonText),1)]),_:1})):m("",!0),w(l.$slots,"secondary",{},void 0,!0)]),_:3}),w(l.$slots,"extra",{},void 0,!0),p(s(le),{"filter-dropdown":!0,size:"small",style:ne(I.value),"data-source":l.table.rows,loading:b.value||l.loading&&!l.live,height:400,columns:l.table.columns?.map((t,e)=>({...t,key:e,filtered:!0,align:t.align??"center",sorter:T(t,e)}))},{emptyText:n(()=>[c(d(l.emptyTitle),1)]),headerCell:n(t=>[c(d(t.title),1)]),bodyCell:n(({column:{key:t},record:e})=>[e.cells[t].type==="slot"?w(l.$slots,e.cells[t].key,{key:0,payload:e.cells[t].payload},void 0,!0):(o(),u(s(M),{key:1,open:e.cells[t].hover?void 0:!1},{content:n(()=>[p(s(D),{style:{width:"300px",overflow:"auto","font-family":"monospace"},copyable:"",content:e.cells[t].hover},null,8,["content"])]),default:n(()=>[e.cells[t].type==="text"?(o(),u(s(_),{key:0,secondary:e.cells[t].secondary,code:e.cells[t].code},{default:n(()=>[p(s(R),{dot:e.cells[t].contentType==="warning",color:"#faad14"},{default:n(()=>[c(d(e.cells[t].text),1)]),_:2},1032,["dot"])]),_:2},1032,["secondary","code"])):e.cells[t].type==="secret"?(o(),u(s(_),{key:1,copyable:{text:e.cells[t].text}},{default:n(()=>[c(" ******** ")]),_:2},1032,["copyable"])):e.cells[t].type==="tag"?(o(),u(s(F),{key:2,color:e.cells[t].tagColor},{default:n(()=>[c(d(e.cells[t].text),1)]),_:2},1032,["color"])):e.cells[t].type==="tags"?(o(),u(s(U),{key:3},{default:n(()=>[(o(!0),V(B,null,x(e.cells[t].tags,(a,k)=>(o(),u(s(F),{key:k,color:a.color},{default:n(()=>[c(d(a.text),1)]),_:2},1032,["color"]))),128))]),_:2},1024)):e.cells[t].type==="link"?(o(),u(r,{key:4,to:e.cells[t].to},{default:n(()=>[c(d(e.cells[t].text),1)]),_:2},1032,["to"])):e.cells[t].type==="actions"?(o(),u(s(oe),{key:5},{overlay:n(()=>[p(s(ue),{disabled:b.value},{default:n(()=>[(o(!0),V(B,null,x(e.cells[t].actions.filter(a=>!a.hide),(a,k)=>(o(),u(s(re),{key:k,danger:a.dangerous,onClick:fe=>C(a,e)},{default:n(()=>[a.popoverMessage?(o(),u(s(M),{key:0,placement:"left"},{content:n(()=>[ie("div",de,[p(s(_),null,{default:n(()=>[c(d(a.popoverMessage),1)]),_:2},1024)])]),default:n(()=>[p(s(_),{disabled:a.disabled,class:"action-item"},{default:n(()=>[a.icon?(o(),u(N(a.icon),{key:0})):m("",!0),c(" "+d(a.label),1)]),_:2},1032,["disabled"])]),_:2},1024)):(o(),u(s(_),{key:1,disabled:a.disabled,class:"action-item"},{default:n(()=>[a.icon?(o(),u(N(a.icon),{key:0})):m("",!0),c(" "+d(a.label),1)]),_:2},1032,["disabled"]))]),_:2},1032,["danger","onClick"]))),128))]),_:2},1032,["disabled"])]),default:n(()=>[p(s(L),{style:{cursor:"pointer"},size:"25px"})]),_:2},1024)):m("",!0)]),_:2},1032,["open"]))]),footer:n(()=>[l.live?(o(),u(s(O),{key:0,justify:"end",gutter:10},{default:n(()=>[p(s(S),null,{default:n(()=>[p(s(se),{size:"small"})]),_:1}),p(s(S),null,{default:n(()=>[p(s(_),null,{default:n(()=>[c(" auto updating ")]),_:1})]),_:1})]),_:1})):m("",!0)]),_:3},8,["style","data-source","loading","columns"])]),_:3}),l.fields&&l.create?(o(),u(ce,{key:0,ref_key:"modalRef",ref:g,fields:l.fields,"entity-name":l.entityName,create:l.create},null,8,["fields","entity-name","create"])):m("",!0)],64)}}}),he=pe(ye,[["__scopeId","data-v-edc1e74b"]]);export{he as C};
//# sourceMappingURL=CrudView-wZnp03a2.js.map
