”B404"NConsider possible security implications associated with the subprocess module.˜¢import subprocessª“import os
import tempfile
import subprocess
import shutil
from rich.syntax import Syntax
from rich.console import Console

console = Console()

ALLOWED_EDITORS = ["vim", "vi", "nano", "emacs", "code", "subl"]

def beautify_diff(diff_output: str) -> None:
    syntax = Syntax(À2Êbanditê
ai_git_utils/utils.py ò_https://bandit.readthedocs.io/en/1.7.9/blacklists/blacklist_imports.html#b404-import-subprocessËB603"9subprocess call - check for execution of untrusted input.˜¢<        subprocess.run([editor_to_use, tf_name], check=True)ª´
            # å¦‚æžœè¿ž vim éƒ½æ²¡æœ‰ï¼Œåˆ™éœ€è¦å¤„ç†é”™è¯¯æƒ…å†µ
            console.print("[red]Error:[/red] Default editor 'vim' not found. Please install it or set a valid EDITOR environment variable from the allowed list.")
            os.unlink(tf_name) # æ¸…ç†ä¸´æ—¶æ–‡ä»¶
            # æ ¹æ®ä½ çš„åº”ç”¨é€»è¾‘ï¼Œè¿™é‡Œå¯ä»¥æŠ›å‡ºå¼‚å¸¸æˆ–è¿”å›žåŽŸå§‹æ¶ˆæ¯
            # raise RuntimeError("No valid editor found.")
            return initial_message # æˆ–è€…ç®€å•è¿”å›žæœªç¼–è¾‘çš„æ¶ˆæ¯

    try:
        # æŽ¨èä½¿ç”¨ subprocess.run æ›¿ä»£ subprocess.call
        # check=True ä¼šåœ¨å‘½ä»¤è¿”å›žéžé›¶é€€å‡ºç æ—¶æŠ›å‡º CalledProcessError å¼‚å¸¸
        subprocess.run([editor_to_use, tf_name], check=True)
    except FileNotFoundError:
        console.print(f"[red]Error:[/red] Editor command '{editor_to_use}' not found. Please check your installation and PATH.")
        os.unlink(tf_name)
        return initial_message # è¿”å›žæœªç¼–è¾‘çš„æ¶ˆæ¯
    except subprocess.CalledProcessError as e:
        console.print(f"[red]Error:[/red] Editor '{editor_to_use}' exited with status {e.returncode}.")
        # å³ä½¿ç¼–è¾‘å™¨å‡ºé”™ï¼Œæ–‡ä»¶å¯èƒ½å·²è¢«éƒ¨åˆ†ä¿®æ”¹ï¼Œä½†æˆ‘ä»¬é€šå¸¸è®¤ä¸ºç¼–è¾‘å¤±è´¥
        os.unlink(tf_name)
        return initial_message # è¿”å›žæœªç¼–è¾‘çš„æ¶ˆæ¯
    except Exception as e:À2Êbanditê!
ai_git_utils/utils.py:: <ò]https://bandit.readthedocs.io/en/1.7.9/plugins/b603_subprocess_without_shell_equals_true.html