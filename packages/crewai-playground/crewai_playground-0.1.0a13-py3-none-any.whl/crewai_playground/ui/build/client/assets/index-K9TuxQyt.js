var Ls=Object.defineProperty;var Ps=(e,t,n)=>t in e?Ls(e,t,{enumerable:!0,configurable:!0,writable:!0,value:n}):e[t]=n;var ie=(e,t,n)=>Ps(e,typeof t!="symbol"?t+"":t,n);import{r as L,t as Dr,v as Os,l as $}from"./chunk-GNGMS2XR-KLeu_BA0.js";import{s as ce,d as Rr,i as cn,T as Tt,a as At,b as Dt,t as js}from"./transform-BEtJ_6wc.js";import"./index-BKaxNvVC.js";function ae(e){if(typeof e=="string"||typeof e=="number")return""+e;let t="";if(Array.isArray(e))for(let n=0,r;n<e.length;n++)(r=ae(e[n]))!==""&&(t+=(t&&" ")+r);else for(let n in e)e[n]&&(t+=(t&&" ")+n);return t}function Ts(e){let t;for(;t=e.sourceEvent;)e=t;return e}function ue(e,t){if(e=Ts(e),t===void 0&&(t=e.currentTarget),t){var n=t.ownerSVGElement||t;if(n.createSVGPoint){var r=n.createSVGPoint();return r.x=e.clientX,r.y=e.clientY,r=r.matrixTransform(t.getScreenCTM().inverse()),[r.x,r.y]}if(t.getBoundingClientRect){var o=t.getBoundingClientRect();return[e.clientX-o.left-t.clientLeft,e.clientY-o.top-t.clientTop]}}return[e.pageX,e.pageY]}const As={passive:!1},Ge={capture:!0,passive:!1};function Rt(e){e.stopImmediatePropagation()}function Pe(e){e.preventDefault(),e.stopImmediatePropagation()}function zr(e){var t=e.document.documentElement,n=ce(e).on("dragstart.drag",Pe,Ge);"onselectstart"in t?n.on("selectstart.drag",Pe,Ge):(t.__noselect=t.style.MozUserSelect,t.style.MozUserSelect="none")}function Hr(e,t){var n=e.document.documentElement,r=ce(e).on("dragstart.drag",null);t&&(r.on("click.drag",Pe,Ge),setTimeout(function(){r.on("click.drag",null)},0)),"onselectstart"in n?r.on("selectstart.drag",null):(n.style.MozUserSelect=n.__noselect,delete n.__noselect)}const it=e=>()=>e;function Qt(e,{sourceEvent:t,subject:n,target:r,identifier:o,active:i,x:s,y:a,dx:c,dy:l,dispatch:u}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},subject:{value:n,enumerable:!0,configurable:!0},target:{value:r,enumerable:!0,configurable:!0},identifier:{value:o,enumerable:!0,configurable:!0},active:{value:i,enumerable:!0,configurable:!0},x:{value:s,enumerable:!0,configurable:!0},y:{value:a,enumerable:!0,configurable:!0},dx:{value:c,enumerable:!0,configurable:!0},dy:{value:l,enumerable:!0,configurable:!0},_:{value:u}})}Qt.prototype.on=function(){var e=this._.on.apply(this._,arguments);return e===this._?this:e};function Ds(e){return!e.ctrlKey&&!e.button}function Rs(){return this.parentNode}function zs(e,t){return t??{x:e.x,y:e.y}}function Hs(){return navigator.maxTouchPoints||"ontouchstart"in this}function Vr(){var e=Ds,t=Rs,n=zs,r=Hs,o={},i=Rr("start","drag","end"),s=0,a,c,l,u,d=0;function f(b){b.on("mousedown.drag",h).filter(r).on("touchstart.drag",x).on("touchmove.drag",y,As).on("touchend.drag touchcancel.drag",N).style("touch-action","none").style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}function h(b,v){if(!(u||!e.call(this,b,v))){var M=g(this,t.call(this,b,v),b,v,"mouse");M&&(ce(b.view).on("mousemove.drag",p,Ge).on("mouseup.drag",m,Ge),zr(b.view),Rt(b),l=!1,a=b.clientX,c=b.clientY,M("start",b))}}function p(b){if(Pe(b),!l){var v=b.clientX-a,M=b.clientY-c;l=v*v+M*M>d}o.mouse("drag",b)}function m(b){ce(b.view).on("mousemove.drag mouseup.drag",null),Hr(b.view,l),Pe(b),o.mouse("end",b)}function x(b,v){if(e.call(this,b,v)){var M=b.changedTouches,C=t.call(this,b,v),I=M.length,T,z;for(T=0;T<I;++T)(z=g(this,C,b,v,M[T].identifier,M[T]))&&(Rt(b),z("start",b,M[T]))}}function y(b){var v=b.changedTouches,M=v.length,C,I;for(C=0;C<M;++C)(I=o[v[C].identifier])&&(Pe(b),I("drag",b,v[C]))}function N(b){var v=b.changedTouches,M=v.length,C,I;for(u&&clearTimeout(u),u=setTimeout(function(){u=null},500),C=0;C<M;++C)(I=o[v[C].identifier])&&(Rt(b),I("end",b,v[C]))}function g(b,v,M,C,I,T){var z=i.copy(),P=ue(T||M,v),D,A,w;if((w=n.call(b,new Qt("beforestart",{sourceEvent:M,target:f,identifier:I,active:s,x:P[0],y:P[1],dx:0,dy:0,dispatch:z}),C))!=null)return D=w.x-P[0]||0,A=w.y-P[1]||0,function S(E,_,O){var k=P,j;switch(E){case"start":o[I]=S,j=s++;break;case"end":delete o[I],--s;case"drag":P=ue(O||_,v),j=s;break}z.call(E,b,new Qt(E,{sourceEvent:_,subject:w,target:f,identifier:I,active:j,x:P[0]+D,y:P[1]+A,dx:P[0]-k[0],dy:P[1]-k[1],dispatch:z}),C)}}return f.filter=function(b){return arguments.length?(e=typeof b=="function"?b:it(!!b),f):e},f.container=function(b){return arguments.length?(t=typeof b=="function"?b:it(b),f):t},f.subject=function(b){return arguments.length?(n=typeof b=="function"?b:it(b),f):n},f.touchable=function(b){return arguments.length?(r=typeof b=="function"?b:it(!!b),f):r},f.on=function(){var b=i.on.apply(i,arguments);return b===i?f:b},f.clickDistance=function(b){return arguments.length?(d=(b=+b)*b,f):Math.sqrt(d)},f}var Vs=1e-12;function Ln(e){return((e=Math.exp(e))+1/e)/2}function Bs(e){return((e=Math.exp(e))-1/e)/2}function Fs(e){return((e=Math.exp(2*e))-1)/(e+1)}const ft=function e(t,n,r){function o(i,s){var a=i[0],c=i[1],l=i[2],u=s[0],d=s[1],f=s[2],h=u-a,p=d-c,m=h*h+p*p,x,y;if(m<Vs)y=Math.log(f/l)/t,x=function(C){return[a+C*h,c+C*p,l*Math.exp(t*C*y)]};else{var N=Math.sqrt(m),g=(f*f-l*l+r*m)/(2*l*n*N),b=(f*f-l*l-r*m)/(2*f*n*N),v=Math.log(Math.sqrt(g*g+1)-g),M=Math.log(Math.sqrt(b*b+1)-b);y=(M-v)/t,x=function(C){var I=C*y,T=Ln(v),z=l/(n*N)*(T*Fs(t*I+v)-Bs(v));return[a+z*h,c+z*p,l*T/Ln(t*I+v)]}}return x.duration=y*1e3*t/Math.SQRT2,x}return o.rho=function(i){var s=Math.max(.001,+i),a=s*s,c=a*a;return e(s,a,c)},o}(Math.SQRT2,2,4),st=e=>()=>e;function Ys(e,{sourceEvent:t,target:n,transform:r,dispatch:o}){Object.defineProperties(this,{type:{value:e,enumerable:!0,configurable:!0},sourceEvent:{value:t,enumerable:!0,configurable:!0},target:{value:n,enumerable:!0,configurable:!0},transform:{value:r,enumerable:!0,configurable:!0},_:{value:o}})}function zt(e){e.stopImmediatePropagation()}function Be(e){e.preventDefault(),e.stopImmediatePropagation()}function Gs(e){return(!e.ctrlKey||e.type==="wheel")&&!e.button}function Ws(){var e=this;return e instanceof SVGElement?(e=e.ownerSVGElement||e,e.hasAttribute("viewBox")?(e=e.viewBox.baseVal,[[e.x,e.y],[e.x+e.width,e.y+e.height]]):[[0,0],[e.width.baseVal.value,e.height.baseVal.value]]):[[0,0],[e.clientWidth,e.clientHeight]]}function Pn(){return this.__zoom||cn}function Xs(e){return-e.deltaY*(e.deltaMode===1?.05:e.deltaMode?1:.002)*(e.ctrlKey?10:1)}function qs(){return navigator.maxTouchPoints||"ontouchstart"in this}function Us(e,t,n){var r=e.invertX(t[0][0])-n[0][0],o=e.invertX(t[1][0])-n[1][0],i=e.invertY(t[0][1])-n[0][1],s=e.invertY(t[1][1])-n[1][1];return e.translate(o>r?(r+o)/2:Math.min(0,r)||Math.max(0,o),s>i?(i+s)/2:Math.min(0,i)||Math.max(0,s))}function Br(){var e=Gs,t=Ws,n=Us,r=Xs,o=qs,i=[0,1/0],s=[[-1/0,-1/0],[1/0,1/0]],a=250,c=ft,l=Rr("start","zoom","end"),u,d,f,h=500,p=150,m=0,x=10;function y(w){w.property("__zoom",Pn).on("wheel.zoom",I,{passive:!1}).on("mousedown.zoom",T).on("dblclick.zoom",z).filter(o).on("touchstart.zoom",P).on("touchmove.zoom",D).on("touchend.zoom touchcancel.zoom",A).style("-webkit-tap-highlight-color","rgba(0,0,0,0)")}y.transform=function(w,S,E,_){var O=w.selection?w.selection():w;O.property("__zoom",Pn),w!==O?v(w,S,E,_):O.interrupt().each(function(){M(this,arguments).event(_).start().zoom(null,typeof S=="function"?S.apply(this,arguments):S).end()})},y.scaleBy=function(w,S,E,_){y.scaleTo(w,function(){var O=this.__zoom.k,k=typeof S=="function"?S.apply(this,arguments):S;return O*k},E,_)},y.scaleTo=function(w,S,E,_){y.transform(w,function(){var O=t.apply(this,arguments),k=this.__zoom,j=E==null?b(O):typeof E=="function"?E.apply(this,arguments):E,R=k.invert(j),H=typeof S=="function"?S.apply(this,arguments):S;return n(g(N(k,H),j,R),O,s)},E,_)},y.translateBy=function(w,S,E,_){y.transform(w,function(){return n(this.__zoom.translate(typeof S=="function"?S.apply(this,arguments):S,typeof E=="function"?E.apply(this,arguments):E),t.apply(this,arguments),s)},null,_)},y.translateTo=function(w,S,E,_,O){y.transform(w,function(){var k=t.apply(this,arguments),j=this.__zoom,R=_==null?b(k):typeof _=="function"?_.apply(this,arguments):_;return n(cn.translate(R[0],R[1]).scale(j.k).translate(typeof S=="function"?-S.apply(this,arguments):-S,typeof E=="function"?-E.apply(this,arguments):-E),k,s)},_,O)};function N(w,S){return S=Math.max(i[0],Math.min(i[1],S)),S===w.k?w:new Tt(S,w.x,w.y)}function g(w,S,E){var _=S[0]-E[0]*w.k,O=S[1]-E[1]*w.k;return _===w.x&&O===w.y?w:new Tt(w.k,_,O)}function b(w){return[(+w[0][0]+ +w[1][0])/2,(+w[0][1]+ +w[1][1])/2]}function v(w,S,E,_){w.on("start.zoom",function(){M(this,arguments).event(_).start()}).on("interrupt.zoom end.zoom",function(){M(this,arguments).event(_).end()}).tween("zoom",function(){var O=this,k=arguments,j=M(O,k).event(_),R=t.apply(O,k),H=E==null?b(R):typeof E=="function"?E.apply(O,k):E,F=Math.max(R[1][0]-R[0][0],R[1][1]-R[0][1]),V=O.__zoom,G=typeof S=="function"?S.apply(O,k):S,X=c(V.invert(H).concat(F/V.k),G.invert(H).concat(F/G.k));return function(Y){if(Y===1)Y=G;else{var B=X(Y),q=F/B[2];Y=new Tt(q,H[0]-B[0]*q,H[1]-B[1]*q)}j.zoom(null,Y)}})}function M(w,S,E){return!E&&w.__zooming||new C(w,S)}function C(w,S){this.that=w,this.args=S,this.active=0,this.sourceEvent=null,this.extent=t.apply(w,S),this.taps=0}C.prototype={event:function(w){return w&&(this.sourceEvent=w),this},start:function(){return++this.active===1&&(this.that.__zooming=this,this.emit("start")),this},zoom:function(w,S){return this.mouse&&w!=="mouse"&&(this.mouse[1]=S.invert(this.mouse[0])),this.touch0&&w!=="touch"&&(this.touch0[1]=S.invert(this.touch0[0])),this.touch1&&w!=="touch"&&(this.touch1[1]=S.invert(this.touch1[0])),this.that.__zoom=S,this.emit("zoom"),this},end:function(){return--this.active===0&&(delete this.that.__zooming,this.emit("end")),this},emit:function(w){var S=ce(this.that).datum();l.call(w,this.that,new Ys(w,{sourceEvent:this.sourceEvent,target:y,transform:this.that.__zoom,dispatch:l}),S)}};function I(w,...S){if(!e.apply(this,arguments))return;var E=M(this,S).event(w),_=this.__zoom,O=Math.max(i[0],Math.min(i[1],_.k*Math.pow(2,r.apply(this,arguments)))),k=ue(w);if(E.wheel)(E.mouse[0][0]!==k[0]||E.mouse[0][1]!==k[1])&&(E.mouse[1]=_.invert(E.mouse[0]=k)),clearTimeout(E.wheel);else{if(_.k===O)return;E.mouse=[k,_.invert(k)],At(this),E.start()}Be(w),E.wheel=setTimeout(j,p),E.zoom("mouse",n(g(N(_,O),E.mouse[0],E.mouse[1]),E.extent,s));function j(){E.wheel=null,E.end()}}function T(w,...S){if(f||!e.apply(this,arguments))return;var E=w.currentTarget,_=M(this,S,!0).event(w),O=ce(w.view).on("mousemove.zoom",H,!0).on("mouseup.zoom",F,!0),k=ue(w,E),j=w.clientX,R=w.clientY;zr(w.view),zt(w),_.mouse=[k,this.__zoom.invert(k)],At(this),_.start();function H(V){if(Be(V),!_.moved){var G=V.clientX-j,X=V.clientY-R;_.moved=G*G+X*X>m}_.event(V).zoom("mouse",n(g(_.that.__zoom,_.mouse[0]=ue(V,E),_.mouse[1]),_.extent,s))}function F(V){O.on("mousemove.zoom mouseup.zoom",null),Hr(V.view,_.moved),Be(V),_.event(V).end()}}function z(w,...S){if(e.apply(this,arguments)){var E=this.__zoom,_=ue(w.changedTouches?w.changedTouches[0]:w,this),O=E.invert(_),k=E.k*(w.shiftKey?.5:2),j=n(g(N(E,k),_,O),t.apply(this,S),s);Be(w),a>0?ce(this).transition().duration(a).call(v,j,_,w):ce(this).call(y.transform,j,_,w)}}function P(w,...S){if(e.apply(this,arguments)){var E=w.touches,_=E.length,O=M(this,S,w.changedTouches.length===_).event(w),k,j,R,H;for(zt(w),j=0;j<_;++j)R=E[j],H=ue(R,this),H=[H,this.__zoom.invert(H),R.identifier],O.touch0?!O.touch1&&O.touch0[2]!==H[2]&&(O.touch1=H,O.taps=0):(O.touch0=H,k=!0,O.taps=1+!!u);u&&(u=clearTimeout(u)),k&&(O.taps<2&&(d=H[0],u=setTimeout(function(){u=null},h)),At(this),O.start())}}function D(w,...S){if(this.__zooming){var E=M(this,S).event(w),_=w.changedTouches,O=_.length,k,j,R,H;for(Be(w),k=0;k<O;++k)j=_[k],R=ue(j,this),E.touch0&&E.touch0[2]===j.identifier?E.touch0[0]=R:E.touch1&&E.touch1[2]===j.identifier&&(E.touch1[0]=R);if(j=E.that.__zoom,E.touch1){var F=E.touch0[0],V=E.touch0[1],G=E.touch1[0],X=E.touch1[1],Y=(Y=G[0]-F[0])*Y+(Y=G[1]-F[1])*Y,B=(B=X[0]-V[0])*B+(B=X[1]-V[1])*B;j=N(j,Math.sqrt(Y/B)),R=[(F[0]+G[0])/2,(F[1]+G[1])/2],H=[(V[0]+X[0])/2,(V[1]+X[1])/2]}else if(E.touch0)R=E.touch0[0],H=E.touch0[1];else return;E.zoom("touch",n(g(j,R,H),E.extent,s))}}function A(w,...S){if(this.__zooming){var E=M(this,S).event(w),_=w.changedTouches,O=_.length,k,j;for(zt(w),f&&clearTimeout(f),f=setTimeout(function(){f=null},h),k=0;k<O;++k)j=_[k],E.touch0&&E.touch0[2]===j.identifier?delete E.touch0:E.touch1&&E.touch1[2]===j.identifier&&delete E.touch1;if(E.touch1&&!E.touch0&&(E.touch0=E.touch1,delete E.touch1),E.touch0)E.touch0[1]=this.__zoom.invert(E.touch0[0]);else if(E.end(),E.taps===2&&(j=ue(j,this),Math.hypot(d[0]-j[0],d[1]-j[1])<x)){var R=ce(this).on("dblclick.zoom");R&&R.apply(this,arguments)}}}return y.wheelDelta=function(w){return arguments.length?(r=typeof w=="function"?w:st(+w),y):r},y.filter=function(w){return arguments.length?(e=typeof w=="function"?w:st(!!w),y):e},y.touchable=function(w){return arguments.length?(o=typeof w=="function"?w:st(!!w),y):o},y.extent=function(w){return arguments.length?(t=typeof w=="function"?w:st([[+w[0][0],+w[0][1]],[+w[1][0],+w[1][1]]]),y):t},y.scaleExtent=function(w){return arguments.length?(i[0]=+w[0],i[1]=+w[1],y):[i[0],i[1]]},y.translateExtent=function(w){return arguments.length?(s[0][0]=+w[0][0],s[1][0]=+w[1][0],s[0][1]=+w[0][1],s[1][1]=+w[1][1],y):[[s[0][0],s[0][1]],[s[1][0],s[1][1]]]},y.constrain=function(w){return arguments.length?(n=w,y):n},y.duration=function(w){return arguments.length?(a=+w,y):a},y.interpolate=function(w){return arguments.length?(c=w,y):c},y.on=function(){var w=l.on.apply(l,arguments);return w===l?y:w},y.clickDistance=function(w){return arguments.length?(m=(w=+w)*w,y):Math.sqrt(m)},y.tapDistance=function(w){return arguments.length?(x=+w,y):x},y}const ge={error001:()=>"[React Flow]: Seems like you have not used zustand provider as an ancestor. Help: https://reactflow.dev/error#001",error002:()=>"It looks like you've created a new nodeTypes or edgeTypes object. If this wasn't on purpose please define the nodeTypes/edgeTypes outside of the component or memoize them.",error003:e=>`Node type "${e}" not found. Using fallback type "default".`,error004:()=>"The React Flow parent container needs a width and a height to render the graph.",error005:()=>"Only child nodes can use a parent extent.",error006:()=>"Can't create edge. An edge needs a source and a target.",error007:e=>`The old edge with id=${e} does not exist.`,error009:e=>`Marker type "${e}" doesn't exist.`,error008:(e,{id:t,sourceHandle:n,targetHandle:r})=>`Couldn't create edge for ${e} handle id: "${e==="source"?n:r}", edge id: ${t}.`,error010:()=>"Handle: No node id found. Make sure to only use a Handle inside a custom Node.",error011:e=>`Edge type "${e}" not found. Using fallback type "default".`,error012:e=>`Node with id "${e}" does not exist, it may have been removed. This can happen when a node is deleted before the "onNodeClick" handler is called.`,error013:(e="react")=>`It seems that you haven't loaded the styles. Please import '@xyflow/${e}/dist/style.css' or base.css to make sure everything is working properly.`,error014:()=>"useNodeConnections: No node ID found. Call useNodeConnections inside a custom Node or provide a node ID.",error015:()=>"It seems that you are trying to drag a node that is not initialized. Please use onNodesChange as explained in the docs."},We=[[Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY],[Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY]],Fr=["Enter"," ","Escape"],Yr={"node.a11yDescription.default":"Press enter or space to select a node. Press delete to remove it and escape to cancel.","node.a11yDescription.keyboardDisabled":"Press enter or space to select a node. You can then use the arrow keys to move the node around. Press delete to remove it and escape to cancel.","node.a11yDescription.ariaLiveMessage":({direction:e,x:t,y:n})=>`Moved selected node ${e}. New position, x: ${t}, y: ${n}`,"edge.a11yDescription.default":"Press enter or space to select an edge. You can then press delete to remove it or escape to cancel.","controls.ariaLabel":"Control Panel","controls.zoomIn.ariaLabel":"Zoom In","controls.zoomOut.ariaLabel":"Zoom Out","controls.fitView.ariaLabel":"Fit View","controls.interactive.ariaLabel":"Toggle Interactivity","minimap.ariaLabel":"Mini Map","handle.ariaLabel":"Handle"};var Oe;(function(e){e.Strict="strict",e.Loose="loose"})(Oe||(Oe={}));var _e;(function(e){e.Free="free",e.Vertical="vertical",e.Horizontal="horizontal"})(_e||(_e={}));var Xe;(function(e){e.Partial="partial",e.Full="full"})(Xe||(Xe={}));const Gr={inProgress:!1,isValid:null,from:null,fromHandle:null,fromPosition:null,fromNode:null,to:null,toHandle:null,toPosition:null,toNode:null};var be;(function(e){e.Bezier="default",e.Straight="straight",e.Step="step",e.SmoothStep="smoothstep",e.SimpleBezier="simplebezier"})(be||(be={}));var ht;(function(e){e.Arrow="arrow",e.ArrowClosed="arrowclosed"})(ht||(ht={}));var W;(function(e){e.Left="left",e.Top="top",e.Right="right",e.Bottom="bottom"})(W||(W={}));const On={[W.Left]:W.Right,[W.Right]:W.Left,[W.Top]:W.Bottom,[W.Bottom]:W.Top};function Wr(e){return e===null?null:e?"valid":"invalid"}const Xr=e=>"id"in e&&"source"in e&&"target"in e,Ks=e=>"id"in e&&"position"in e&&!("source"in e)&&!("target"in e),ln=e=>"id"in e&&"internals"in e&&!("source"in e)&&!("target"in e),Ze=(e,t=[0,0])=>{const{width:n,height:r}=ye(e),o=e.origin??t,i=n*o[0],s=r*o[1];return{x:e.position.x-i,y:e.position.y-s}},Zs=(e,t={nodeOrigin:[0,0]})=>{if(e.length===0)return{x:0,y:0,width:0,height:0};const n=e.reduce((r,o)=>{const i=typeof o=="string";let s=!t.nodeLookup&&!i?o:void 0;t.nodeLookup&&(s=i?t.nodeLookup.get(o):ln(o)?o:t.nodeLookup.get(o.id));const a=s?gt(s,t.nodeOrigin):{x:0,y:0,x2:0,y2:0};return vt(r,a)},{x:1/0,y:1/0,x2:-1/0,y2:-1/0});return Et(n)},Qe=(e,t={})=>{if(e.size===0)return{x:0,y:0,width:0,height:0};let n={x:1/0,y:1/0,x2:-1/0,y2:-1/0};return e.forEach(r=>{if(t.filter===void 0||t.filter(r)){const o=gt(r);n=vt(n,o)}}),Et(n)},un=(e,t,[n,r,o]=[0,0,1],i=!1,s=!1)=>{const a={...Je(t,[n,r,o]),width:t.width/o,height:t.height/o},c=[];for(const l of e.values()){const{measured:u,selectable:d=!0,hidden:f=!1}=l;if(s&&!d||f)continue;const h=u.width??l.width??l.initialWidth??null,p=u.height??l.height??l.initialHeight??null,m=qe(a,Te(l)),x=(h??0)*(p??0),y=i&&m>0;(!l.internals.handleBounds||y||m>=x||l.dragging)&&c.push(l)}return c},Qs=(e,t)=>{const n=new Set;return e.forEach(r=>{n.add(r.id)}),t.filter(r=>n.has(r.source)||n.has(r.target))};function Js(e,t){const n=new Map,r=t!=null&&t.nodes?new Set(t.nodes.map(o=>o.id)):null;return e.forEach(o=>{o.measured.width&&o.measured.height&&((t==null?void 0:t.includeHiddenNodes)||!o.hidden)&&(!r||r.has(o.id))&&n.set(o.id,o)}),n}async function ea({nodes:e,width:t,height:n,panZoom:r,minZoom:o,maxZoom:i},s){if(e.size===0)return Promise.resolve(!0);const a=Js(e,s),c=Qe(a),l=dn(c,t,n,(s==null?void 0:s.minZoom)??o,(s==null?void 0:s.maxZoom)??i,(s==null?void 0:s.padding)??.1);return await r.setViewport(l,{duration:s==null?void 0:s.duration,ease:s==null?void 0:s.ease,interpolate:s==null?void 0:s.interpolate}),Promise.resolve(!0)}function qr({nodeId:e,nextPosition:t,nodeLookup:n,nodeOrigin:r=[0,0],nodeExtent:o,onError:i}){const s=n.get(e),a=s.parentId?n.get(s.parentId):void 0,{x:c,y:l}=a?a.internals.positionAbsolute:{x:0,y:0},u=s.origin??r;let d=o;if(s.extent==="parent"&&!s.expandParent)if(!a)i==null||i("005",ge.error005());else{const h=a.measured.width,p=a.measured.height;h&&p&&(d=[[c,l],[c+h,l+p]])}else a&&Ae(s.extent)&&(d=[[s.extent[0][0]+c,s.extent[0][1]+l],[s.extent[1][0]+c,s.extent[1][1]+l]]);const f=Ae(d)?Se(t,d,s.measured):t;return(s.measured.width===void 0||s.measured.height===void 0)&&(i==null||i("015",ge.error015())),{position:{x:f.x-c+(s.measured.width??0)*u[0],y:f.y-l+(s.measured.height??0)*u[1]},positionAbsolute:f}}async function ta({nodesToRemove:e=[],edgesToRemove:t=[],nodes:n,edges:r,onBeforeDelete:o}){const i=new Set(e.map(f=>f.id)),s=[];for(const f of n){if(f.deletable===!1)continue;const h=i.has(f.id),p=!h&&f.parentId&&s.find(m=>m.id===f.parentId);(h||p)&&s.push(f)}const a=new Set(t.map(f=>f.id)),c=r.filter(f=>f.deletable!==!1),u=Qs(s,c);for(const f of c)a.has(f.id)&&!u.find(p=>p.id===f.id)&&u.push(f);if(!o)return{edges:u,nodes:s};const d=await o({nodes:s,edges:u});return typeof d=="boolean"?d?{edges:u,nodes:s}:{edges:[],nodes:[]}:d}const je=(e,t=0,n=1)=>Math.min(Math.max(e,t),n),Se=(e={x:0,y:0},t,n)=>({x:je(e.x,t[0][0],t[1][0]-((n==null?void 0:n.width)??0)),y:je(e.y,t[0][1],t[1][1]-((n==null?void 0:n.height)??0))});function Ur(e,t,n){const{width:r,height:o}=ye(n),{x:i,y:s}=n.internals.positionAbsolute;return Se(e,[[i,s],[i+r,s+o]],t)}const jn=(e,t,n)=>e<t?je(Math.abs(e-t),1,t)/t:e>n?-je(Math.abs(e-n),1,t)/t:0,Kr=(e,t,n=15,r=40)=>{const o=jn(e.x,r,t.width-r)*n,i=jn(e.y,r,t.height-r)*n;return[o,i]},vt=(e,t)=>({x:Math.min(e.x,t.x),y:Math.min(e.y,t.y),x2:Math.max(e.x2,t.x2),y2:Math.max(e.y2,t.y2)}),Jt=({x:e,y:t,width:n,height:r})=>({x:e,y:t,x2:e+n,y2:t+r}),Et=({x:e,y:t,x2:n,y2:r})=>({x:e,y:t,width:n-e,height:r-t}),Te=(e,t=[0,0])=>{var o,i;const{x:n,y:r}=ln(e)?e.internals.positionAbsolute:Ze(e,t);return{x:n,y:r,width:((o=e.measured)==null?void 0:o.width)??e.width??e.initialWidth??0,height:((i=e.measured)==null?void 0:i.height)??e.height??e.initialHeight??0}},gt=(e,t=[0,0])=>{var o,i;const{x:n,y:r}=ln(e)?e.internals.positionAbsolute:Ze(e,t);return{x:n,y:r,x2:n+(((o=e.measured)==null?void 0:o.width)??e.width??e.initialWidth??0),y2:r+(((i=e.measured)==null?void 0:i.height)??e.height??e.initialHeight??0)}},Zr=(e,t)=>Et(vt(Jt(e),Jt(t))),qe=(e,t)=>{const n=Math.max(0,Math.min(e.x+e.width,t.x+t.width)-Math.max(e.x,t.x)),r=Math.max(0,Math.min(e.y+e.height,t.y+t.height)-Math.max(e.y,t.y));return Math.ceil(n*r)},Tn=e=>de(e.width)&&de(e.height)&&de(e.x)&&de(e.y),de=e=>!isNaN(e)&&isFinite(e),na=(e,t)=>{},Nt=(e,t=[1,1])=>({x:t[0]*Math.round(e.x/t[0]),y:t[1]*Math.round(e.y/t[1])}),Je=({x:e,y:t},[n,r,o],i=!1,s=[1,1])=>{const a={x:(e-n)/o,y:(t-r)/o};return i?Nt(a,s):a},pt=({x:e,y:t},[n,r,o])=>({x:e*o+n,y:t*o+r});function Ie(e,t){if(typeof e=="number")return Math.floor((t-t/(1+e))*.5);if(typeof e=="string"&&e.endsWith("px")){const n=parseFloat(e);if(!Number.isNaN(n))return Math.floor(n)}if(typeof e=="string"&&e.endsWith("%")){const n=parseFloat(e);if(!Number.isNaN(n))return Math.floor(t*n*.01)}return console.error(`[React Flow] The padding value "${e}" is invalid. Please provide a number or a string with a valid unit (px or %).`),0}function ra(e,t,n){if(typeof e=="string"||typeof e=="number"){const r=Ie(e,n),o=Ie(e,t);return{top:r,right:o,bottom:r,left:o,x:o*2,y:r*2}}if(typeof e=="object"){const r=Ie(e.top??e.y??0,n),o=Ie(e.bottom??e.y??0,n),i=Ie(e.left??e.x??0,t),s=Ie(e.right??e.x??0,t);return{top:r,right:s,bottom:o,left:i,x:i+s,y:r+o}}return{top:0,right:0,bottom:0,left:0,x:0,y:0}}function oa(e,t,n,r,o,i){const{x:s,y:a}=pt(e,[t,n,r]),{x:c,y:l}=pt({x:e.x+e.width,y:e.y+e.height},[t,n,r]),u=o-c,d=i-l;return{left:Math.floor(s),top:Math.floor(a),right:Math.floor(u),bottom:Math.floor(d)}}const dn=(e,t,n,r,o,i)=>{const s=ra(i,t,n),a=(t-s.x)/e.width,c=(n-s.y)/e.height,l=Math.min(a,c),u=je(l,r,o),d=e.x+e.width/2,f=e.y+e.height/2,h=t/2-d*u,p=n/2-f*u,m=oa(e,h,p,u,t,n),x={left:Math.min(m.left-s.left,0),top:Math.min(m.top-s.top,0),right:Math.min(m.right-s.right,0),bottom:Math.min(m.bottom-s.bottom,0)};return{x:h-x.left+x.right,y:p-x.top+x.bottom,zoom:u}},mt=()=>{var e;return typeof navigator<"u"&&((e=navigator==null?void 0:navigator.userAgent)==null?void 0:e.indexOf("Mac"))>=0};function Ae(e){return e!==void 0&&e!=="parent"}function ye(e){var t,n;return{width:((t=e.measured)==null?void 0:t.width)??e.width??e.initialWidth??0,height:((n=e.measured)==null?void 0:n.height)??e.height??e.initialHeight??0}}function Qr(e){var t,n;return(((t=e.measured)==null?void 0:t.width)??e.width??e.initialWidth)!==void 0&&(((n=e.measured)==null?void 0:n.height)??e.height??e.initialHeight)!==void 0}function Jr(e,t={width:0,height:0},n,r,o){const i={...e},s=r.get(n);if(s){const a=s.origin||o;i.x+=s.internals.positionAbsolute.x-(t.width??0)*a[0],i.y+=s.internals.positionAbsolute.y-(t.height??0)*a[1]}return i}function An(e,t){if(e.size!==t.size)return!1;for(const n of e)if(!t.has(n))return!1;return!0}function ia(){let e,t;return{promise:new Promise((r,o)=>{e=r,t=o}),resolve:e,reject:t}}function sa(e){return{...Yr,...e||{}}}function Ye(e,{snapGrid:t=[0,0],snapToGrid:n=!1,transform:r,containerBounds:o}){const{x:i,y:s}=he(e),a=Je({x:i-((o==null?void 0:o.left)??0),y:s-((o==null?void 0:o.top)??0)},r),{x:c,y:l}=n?Nt(a,t):a;return{xSnapped:c,ySnapped:l,...a}}const fn=e=>({width:e.offsetWidth,height:e.offsetHeight}),eo=e=>{var t;return((t=e==null?void 0:e.getRootNode)==null?void 0:t.call(e))||(window==null?void 0:window.document)},aa=["INPUT","SELECT","TEXTAREA"];function to(e){var r,o;const t=((o=(r=e.composedPath)==null?void 0:r.call(e))==null?void 0:o[0])||e.target;return(t==null?void 0:t.nodeType)!==1?!1:aa.includes(t.nodeName)||t.hasAttribute("contenteditable")||!!t.closest(".nokey")}const no=e=>"clientX"in e,he=(e,t)=>{var i,s;const n=no(e),r=n?e.clientX:(i=e.touches)==null?void 0:i[0].clientX,o=n?e.clientY:(s=e.touches)==null?void 0:s[0].clientY;return{x:r-((t==null?void 0:t.left)??0),y:o-((t==null?void 0:t.top)??0)}},Dn=(e,t,n,r,o)=>{const i=t.querySelectorAll(`.${e}`);return!i||!i.length?null:Array.from(i).map(s=>{const a=s.getBoundingClientRect();return{id:s.getAttribute("data-handleid"),type:e,nodeId:o,position:s.getAttribute("data-handlepos"),x:(a.left-n.left)/r,y:(a.top-n.top)/r,...fn(s)}})};function ro({sourceX:e,sourceY:t,targetX:n,targetY:r,sourceControlX:o,sourceControlY:i,targetControlX:s,targetControlY:a}){const c=e*.125+o*.375+s*.375+n*.125,l=t*.125+i*.375+a*.375+r*.125,u=Math.abs(c-e),d=Math.abs(l-t);return[c,l,u,d]}function at(e,t){return e>=0?.5*e:t*25*Math.sqrt(-e)}function Rn({pos:e,x1:t,y1:n,x2:r,y2:o,c:i}){switch(e){case W.Left:return[t-at(t-r,i),n];case W.Right:return[t+at(r-t,i),n];case W.Top:return[t,n-at(n-o,i)];case W.Bottom:return[t,n+at(o-n,i)]}}function oo({sourceX:e,sourceY:t,sourcePosition:n=W.Bottom,targetX:r,targetY:o,targetPosition:i=W.Top,curvature:s=.25}){const[a,c]=Rn({pos:n,x1:e,y1:t,x2:r,y2:o,c:s}),[l,u]=Rn({pos:i,x1:r,y1:o,x2:e,y2:t,c:s}),[d,f,h,p]=ro({sourceX:e,sourceY:t,targetX:r,targetY:o,sourceControlX:a,sourceControlY:c,targetControlX:l,targetControlY:u});return[`M${e},${t} C${a},${c} ${l},${u} ${r},${o}`,d,f,h,p]}function io({sourceX:e,sourceY:t,targetX:n,targetY:r}){const o=Math.abs(n-e)/2,i=n<e?n+o:n-o,s=Math.abs(r-t)/2,a=r<t?r+s:r-s;return[i,a,o,s]}function ca({sourceNode:e,targetNode:t,selected:n=!1,zIndex:r,elevateOnSelect:o=!1}){if(r!==void 0)return r;const i=o&&n?1e3:0,s=Math.max(e.parentId?e.internals.z:0,t.parentId?t.internals.z:0);return i+s}function la({sourceNode:e,targetNode:t,width:n,height:r,transform:o}){const i=vt(gt(e),gt(t));i.x===i.x2&&(i.x2+=1),i.y===i.y2&&(i.y2+=1);const s={x:-o[0]/o[2],y:-o[1]/o[2],width:n/o[2],height:r/o[2]};return qe(s,Et(i))>0}const ua=({source:e,sourceHandle:t,target:n,targetHandle:r})=>`xy-edge__${e}${t||""}-${n}${r||""}`,da=(e,t)=>t.some(n=>n.source===e.source&&n.target===e.target&&(n.sourceHandle===e.sourceHandle||!n.sourceHandle&&!e.sourceHandle)&&(n.targetHandle===e.targetHandle||!n.targetHandle&&!e.targetHandle)),fa=(e,t)=>{if(!e.source||!e.target)return t;let n;return Xr(e)?n={...e}:n={...e,id:ua(e)},da(n,t)?t:(n.sourceHandle===null&&delete n.sourceHandle,n.targetHandle===null&&delete n.targetHandle,t.concat(n))};function so({sourceX:e,sourceY:t,targetX:n,targetY:r}){const[o,i,s,a]=io({sourceX:e,sourceY:t,targetX:n,targetY:r});return[`M ${e},${t}L ${n},${r}`,o,i,s,a]}const zn={[W.Left]:{x:-1,y:0},[W.Right]:{x:1,y:0},[W.Top]:{x:0,y:-1},[W.Bottom]:{x:0,y:1}},ha=({source:e,sourcePosition:t=W.Bottom,target:n})=>t===W.Left||t===W.Right?e.x<n.x?{x:1,y:0}:{x:-1,y:0}:e.y<n.y?{x:0,y:1}:{x:0,y:-1},Hn=(e,t)=>Math.sqrt(Math.pow(t.x-e.x,2)+Math.pow(t.y-e.y,2));function ga({source:e,sourcePosition:t=W.Bottom,target:n,targetPosition:r=W.Top,center:o,offset:i}){const s=zn[t],a=zn[r],c={x:e.x+s.x*i,y:e.y+s.y*i},l={x:n.x+a.x*i,y:n.y+a.y*i},u=ha({source:c,sourcePosition:t,target:l}),d=u.x!==0?"x":"y",f=u[d];let h=[],p,m;const x={x:0,y:0},y={x:0,y:0},[N,g,b,v]=io({sourceX:e.x,sourceY:e.y,targetX:n.x,targetY:n.y});if(s[d]*a[d]===-1){p=o.x??N,m=o.y??g;const C=[{x:p,y:c.y},{x:p,y:l.y}],I=[{x:c.x,y:m},{x:l.x,y:m}];s[d]===f?h=d==="x"?C:I:h=d==="x"?I:C}else{const C=[{x:c.x,y:l.y}],I=[{x:l.x,y:c.y}];if(d==="x"?h=s.x===f?I:C:h=s.y===f?C:I,t===r){const A=Math.abs(e[d]-n[d]);if(A<=i){const w=Math.min(i-1,i-A);s[d]===f?x[d]=(c[d]>e[d]?-1:1)*w:y[d]=(l[d]>n[d]?-1:1)*w}}if(t!==r){const A=d==="x"?"y":"x",w=s[d]===a[A],S=c[A]>l[A],E=c[A]<l[A];(s[d]===1&&(!w&&S||w&&E)||s[d]!==1&&(!w&&E||w&&S))&&(h=d==="x"?C:I)}const T={x:c.x+x.x,y:c.y+x.y},z={x:l.x+y.x,y:l.y+y.y},P=Math.max(Math.abs(T.x-h[0].x),Math.abs(z.x-h[0].x)),D=Math.max(Math.abs(T.y-h[0].y),Math.abs(z.y-h[0].y));P>=D?(p=(T.x+z.x)/2,m=h[0].y):(p=h[0].x,m=(T.y+z.y)/2)}return[[e,{x:c.x+x.x,y:c.y+x.y},...h,{x:l.x+y.x,y:l.y+y.y},n],p,m,b,v]}function pa(e,t,n,r){const o=Math.min(Hn(e,t)/2,Hn(t,n)/2,r),{x:i,y:s}=t;if(e.x===i&&i===n.x||e.y===s&&s===n.y)return`L${i} ${s}`;if(e.y===s){const l=e.x<n.x?-1:1,u=e.y<n.y?1:-1;return`L ${i+o*l},${s}Q ${i},${s} ${i},${s+o*u}`}const a=e.x<n.x?1:-1,c=e.y<n.y?-1:1;return`L ${i},${s+o*c}Q ${i},${s} ${i+o*a},${s}`}function en({sourceX:e,sourceY:t,sourcePosition:n=W.Bottom,targetX:r,targetY:o,targetPosition:i=W.Top,borderRadius:s=5,centerX:a,centerY:c,offset:l=20}){const[u,d,f,h,p]=ga({source:{x:e,y:t},sourcePosition:n,target:{x:r,y:o},targetPosition:i,center:{x:a,y:c},offset:l});return[u.reduce((x,y,N)=>{let g="";return N>0&&N<u.length-1?g=pa(u[N-1],y,u[N+1],s):g=`${N===0?"M":"L"}${y.x} ${y.y}`,x+=g,x},""),d,f,h,p]}function Vn(e){var t;return e&&!!(e.internals.handleBounds||(t=e.handles)!=null&&t.length)&&!!(e.measured.width||e.width||e.initialWidth)}function ma(e){var d;const{sourceNode:t,targetNode:n}=e;if(!Vn(t)||!Vn(n))return null;const r=t.internals.handleBounds||Bn(t.handles),o=n.internals.handleBounds||Bn(n.handles),i=Fn((r==null?void 0:r.source)??[],e.sourceHandle),s=Fn(e.connectionMode===Oe.Strict?(o==null?void 0:o.target)??[]:((o==null?void 0:o.target)??[]).concat((o==null?void 0:o.source)??[]),e.targetHandle);if(!i||!s)return(d=e.onError)==null||d.call(e,"008",ge.error008(i?"target":"source",{id:e.id,sourceHandle:e.sourceHandle,targetHandle:e.targetHandle})),null;const a=(i==null?void 0:i.position)||W.Bottom,c=(s==null?void 0:s.position)||W.Top,l=Ue(t,i,a),u=Ue(n,s,c);return{sourceX:l.x,sourceY:l.y,targetX:u.x,targetY:u.y,sourcePosition:a,targetPosition:c}}function Bn(e){if(!e)return null;const t=[],n=[];for(const r of e)r.width=r.width??1,r.height=r.height??1,r.type==="source"?t.push(r):r.type==="target"&&n.push(r);return{source:t,target:n}}function Ue(e,t,n=W.Left,r=!1){const o=((t==null?void 0:t.x)??0)+e.internals.positionAbsolute.x,i=((t==null?void 0:t.y)??0)+e.internals.positionAbsolute.y,{width:s,height:a}=t??ye(e);if(r)return{x:o+s/2,y:i+a/2};switch((t==null?void 0:t.position)??n){case W.Top:return{x:o+s/2,y:i};case W.Right:return{x:o+s,y:i+a/2};case W.Bottom:return{x:o+s/2,y:i+a};case W.Left:return{x:o,y:i+a/2}}}function Fn(e,t){return e&&(t?e.find(n=>n.id===t):e[0])||null}function tn(e,t){return e?typeof e=="string"?e:`${t?`${t}__`:""}${Object.keys(e).sort().map(r=>`${r}=${e[r]}`).join("&")}`:""}function ya(e,{id:t,defaultColor:n,defaultMarkerStart:r,defaultMarkerEnd:o}){const i=new Set;return e.reduce((s,a)=>([a.markerStart||r,a.markerEnd||o].forEach(c=>{if(c&&typeof c=="object"){const l=tn(c,t);i.has(l)||(s.push({id:l,color:c.color||n,...c}),i.add(l))}}),s),[]).sort((s,a)=>s.id.localeCompare(a.id))}const hn={nodeOrigin:[0,0],nodeExtent:We,elevateNodesOnSelect:!0,defaults:{}},wa={...hn,checkEquality:!0};function gn(e,t){const n={...e};for(const r in t)t[r]!==void 0&&(n[r]=t[r]);return n}function xa(e,t,n){const r=gn(hn,n);for(const o of e.values())if(o.parentId)pn(o,e,t,r);else{const i=Ze(o,r.nodeOrigin),s=Ae(o.extent)?o.extent:r.nodeExtent,a=Se(i,s,ye(o));o.internals.positionAbsolute=a}}function nn(e,t,n,r){var c,l;const o=gn(wa,r);let i=e.length>0;const s=new Map(t),a=o!=null&&o.elevateNodesOnSelect?1e3:0;t.clear(),n.clear();for(const u of e){let d=s.get(u.id);if(o.checkEquality&&u===(d==null?void 0:d.internals.userNode))t.set(u.id,d);else{const f=Ze(u,o.nodeOrigin),h=Ae(u.extent)?u.extent:o.nodeExtent,p=Se(f,h,ye(u));d={...o.defaults,...u,measured:{width:(c=u.measured)==null?void 0:c.width,height:(l=u.measured)==null?void 0:l.height},internals:{positionAbsolute:p,handleBounds:u.measured?d==null?void 0:d.internals.handleBounds:void 0,z:ao(u,a),userNode:u}},t.set(u.id,d)}(d.measured===void 0||d.measured.width===void 0||d.measured.height===void 0)&&!d.hidden&&(i=!1),u.parentId&&pn(d,t,n,r)}return i}function ba(e,t){if(!e.parentId)return;const n=t.get(e.parentId);n?n.set(e.id,e):t.set(e.parentId,new Map([[e.id,e]]))}function pn(e,t,n,r){const{elevateNodesOnSelect:o,nodeOrigin:i,nodeExtent:s}=gn(hn,r),a=e.parentId,c=t.get(a);if(!c){console.warn(`Parent node ${a} not found. Please make sure that parent nodes are in front of their child nodes in the nodes array.`);return}ba(e,n);const l=o?1e3:0,{x:u,y:d,z:f}=va(e,c,i,s,l),{positionAbsolute:h}=e.internals,p=u!==h.x||d!==h.y;(p||f!==e.internals.z)&&t.set(e.id,{...e,internals:{...e.internals,positionAbsolute:p?{x:u,y:d}:h,z:f}})}function ao(e,t){return(de(e.zIndex)?e.zIndex:0)+(e.selected?t:0)}function va(e,t,n,r,o){const{x:i,y:s}=t.internals.positionAbsolute,a=ye(e),c=Ze(e,n),l=Ae(e.extent)?Se(c,e.extent,a):c;let u=Se({x:i+l.x,y:s+l.y},r,a);e.extent==="parent"&&(u=Ur(u,a,t));const d=ao(e,o),f=t.internals.z??0;return{x:u.x,y:u.y,z:f>=d?f+1:d}}function mn(e,t,n,r=[0,0]){var s;const o=[],i=new Map;for(const a of e){const c=t.get(a.parentId);if(!c)continue;const l=((s=i.get(a.parentId))==null?void 0:s.expandedRect)??Te(c),u=Zr(l,a.rect);i.set(a.parentId,{expandedRect:u,parent:c})}return i.size>0&&i.forEach(({expandedRect:a,parent:c},l)=>{var g;const u=c.internals.positionAbsolute,d=ye(c),f=c.origin??r,h=a.x<u.x?Math.round(Math.abs(u.x-a.x)):0,p=a.y<u.y?Math.round(Math.abs(u.y-a.y)):0,m=Math.max(d.width,Math.round(a.width)),x=Math.max(d.height,Math.round(a.height)),y=(m-d.width)*f[0],N=(x-d.height)*f[1];(h>0||p>0||y||N)&&(o.push({id:l,type:"position",position:{x:c.position.x-h+y,y:c.position.y-p+N}}),(g=n.get(l))==null||g.forEach(b=>{e.some(v=>v.id===b.id)||o.push({id:b.id,type:"position",position:{x:b.position.x+h,y:b.position.y+p}})})),(d.width<a.width||d.height<a.height||h||p)&&o.push({id:l,type:"dimensions",setAttributes:!0,dimensions:{width:m+(h?f[0]*h-y:0),height:x+(p?f[1]*p-N:0)}})}),o}function Ea(e,t,n,r,o,i){const s=r==null?void 0:r.querySelector(".xyflow__viewport");let a=!1;if(!s)return{changes:[],updatedInternals:a};const c=[],l=window.getComputedStyle(s),{m22:u}=new window.DOMMatrixReadOnly(l.transform),d=[];for(const f of e.values()){const h=t.get(f.id);if(!h)continue;if(h.hidden){t.set(h.id,{...h,internals:{...h.internals,handleBounds:void 0}}),a=!0;continue}const p=fn(f.nodeElement),m=h.measured.width!==p.width||h.measured.height!==p.height;if(!!(p.width&&p.height&&(m||!h.internals.handleBounds||f.force))){const y=f.nodeElement.getBoundingClientRect(),N=Ae(h.extent)?h.extent:i;let{positionAbsolute:g}=h.internals;h.parentId&&h.extent==="parent"?g=Ur(g,p,t.get(h.parentId)):N&&(g=Se(g,N,p));const b={...h,measured:p,internals:{...h.internals,positionAbsolute:g,handleBounds:{source:Dn("source",f.nodeElement,y,u,h.id),target:Dn("target",f.nodeElement,y,u,h.id)}}};t.set(h.id,b),h.parentId&&pn(b,t,n,{nodeOrigin:o}),a=!0,m&&(c.push({id:h.id,type:"dimensions",dimensions:p}),h.expandParent&&h.parentId&&d.push({id:h.id,parentId:h.parentId,rect:Te(b,o)}))}}if(d.length>0){const f=mn(d,t,n,o);c.push(...f)}return{changes:c,updatedInternals:a}}async function Na({delta:e,panZoom:t,transform:n,translateExtent:r,width:o,height:i}){if(!t||!e.x&&!e.y)return Promise.resolve(!1);const s=await t.setViewportConstrained({x:n[0]+e.x,y:n[1]+e.y,zoom:n[2]},[[0,0],[o,i]],r),a=!!s&&(s.x!==n[0]||s.y!==n[1]||s.k!==n[2]);return Promise.resolve(a)}function Yn(e,t,n,r,o,i){let s=o;const a=r.get(s)||new Map;r.set(s,a.set(n,t)),s=`${o}-${e}`;const c=r.get(s)||new Map;if(r.set(s,c.set(n,t)),i){s=`${o}-${e}-${i}`;const l=r.get(s)||new Map;r.set(s,l.set(n,t))}}function co(e,t,n){e.clear(),t.clear();for(const r of n){const{source:o,target:i,sourceHandle:s=null,targetHandle:a=null}=r,c={edgeId:r.id,source:o,target:i,sourceHandle:s,targetHandle:a},l=`${o}-${s}--${i}-${a}`,u=`${i}-${a}--${o}-${s}`;Yn("source",c,u,e,o,s),Yn("target",c,l,e,i,a),t.set(r.id,r)}}function lo(e,t){if(!e.parentId)return!1;const n=t.get(e.parentId);return n?n.selected?!0:lo(n,t):!1}function Gn(e,t,n){var o;let r=e;do{if((o=r==null?void 0:r.matches)!=null&&o.call(r,t))return!0;if(r===n)return!1;r=r==null?void 0:r.parentElement}while(r);return!1}function _a(e,t,n,r){const o=new Map;for(const[i,s]of e)if((s.selected||s.id===r)&&(!s.parentId||!lo(s,e))&&(s.draggable||t&&typeof s.draggable>"u")){const a=e.get(i);a&&o.set(i,{id:i,position:a.position||{x:0,y:0},distance:{x:n.x-a.internals.positionAbsolute.x,y:n.y-a.internals.positionAbsolute.y},extent:a.extent,parentId:a.parentId,origin:a.origin,expandParent:a.expandParent,internals:{positionAbsolute:a.internals.positionAbsolute||{x:0,y:0}},measured:{width:a.measured.width??0,height:a.measured.height??0}})}return o}function Ht({nodeId:e,dragItems:t,nodeLookup:n,dragging:r=!0}){var s,a,c;const o=[];for(const[l,u]of t){const d=(s=n.get(l))==null?void 0:s.internals.userNode;d&&o.push({...d,position:u.position,dragging:r})}if(!e)return[o[0],o];const i=(a=n.get(e))==null?void 0:a.internals.userNode;return[i?{...i,position:((c=t.get(e))==null?void 0:c.position)||i.position,dragging:r}:o[0],o]}function Sa({onNodeMouseDown:e,getStoreItems:t,onDragStart:n,onDrag:r,onDragStop:o}){let i={x:null,y:null},s=0,a=new Map,c=!1,l={x:0,y:0},u=null,d=!1,f=null,h=!1,p=!1;function m({noDragClassName:y,handleSelector:N,domNode:g,isSelectable:b,nodeId:v,nodeClickDistance:M=0}){f=ce(g);function C({x:P,y:D},A){const{nodeLookup:w,nodeExtent:S,snapGrid:E,snapToGrid:_,nodeOrigin:O,onNodeDrag:k,onSelectionDrag:j,onError:R,updateNodePositions:H}=t();i={x:P,y:D};let F=!1,V={x:0,y:0,x2:0,y2:0};if(a.size>1&&S){const G=Qe(a);V=Jt(G)}for(const[G,X]of a){if(!w.has(G))continue;let Y={x:P-X.distance.x,y:D-X.distance.y};_&&(Y=Nt(Y,E));let B=[[S[0][0],S[0][1]],[S[1][0],S[1][1]]];if(a.size>1&&S&&!X.extent){const{positionAbsolute:Q}=X.internals,U=Q.x-V.x+S[0][0],Z=Q.x+X.measured.width-V.x2+S[1][0],K=Q.y-V.y+S[0][1],te=Q.y+X.measured.height-V.y2+S[1][1];B=[[U,K],[Z,te]]}const{position:q,positionAbsolute:ee}=qr({nodeId:G,nextPosition:Y,nodeLookup:w,nodeExtent:B,nodeOrigin:O,onError:R});F=F||X.position.x!==q.x||X.position.y!==q.y,X.position=q,X.internals.positionAbsolute=ee}if(p=p||F,!!F&&(H(a,!0),A&&(r||k||!v&&j))){const[G,X]=Ht({nodeId:v,dragItems:a,nodeLookup:w});r==null||r(A,a,G,X),k==null||k(A,G,X),v||j==null||j(A,X)}}async function I(){if(!u)return;const{transform:P,panBy:D,autoPanSpeed:A,autoPanOnNodeDrag:w}=t();if(!w){c=!1,cancelAnimationFrame(s);return}const[S,E]=Kr(l,u,A);(S!==0||E!==0)&&(i.x=(i.x??0)-S/P[2],i.y=(i.y??0)-E/P[2],await D({x:S,y:E})&&C(i,null)),s=requestAnimationFrame(I)}function T(P){var F;const{nodeLookup:D,multiSelectionActive:A,nodesDraggable:w,transform:S,snapGrid:E,snapToGrid:_,selectNodesOnDrag:O,onNodeDragStart:k,onSelectionDragStart:j,unselectNodesAndEdges:R}=t();d=!0,(!O||!b)&&!A&&v&&((F=D.get(v))!=null&&F.selected||R()),b&&O&&v&&(e==null||e(v));const H=Ye(P.sourceEvent,{transform:S,snapGrid:E,snapToGrid:_,containerBounds:u});if(i=H,a=_a(D,w,H,v),a.size>0&&(n||k||!v&&j)){const[V,G]=Ht({nodeId:v,dragItems:a,nodeLookup:D});n==null||n(P.sourceEvent,a,V,G),k==null||k(P.sourceEvent,V,G),v||j==null||j(P.sourceEvent,G)}}const z=Vr().clickDistance(M).on("start",P=>{const{domNode:D,nodeDragThreshold:A,transform:w,snapGrid:S,snapToGrid:E}=t();u=(D==null?void 0:D.getBoundingClientRect())||null,h=!1,p=!1,A===0&&T(P),i=Ye(P.sourceEvent,{transform:w,snapGrid:S,snapToGrid:E,containerBounds:u}),l=he(P.sourceEvent,u)}).on("drag",P=>{const{autoPanOnNodeDrag:D,transform:A,snapGrid:w,snapToGrid:S,nodeDragThreshold:E,nodeLookup:_}=t(),O=Ye(P.sourceEvent,{transform:A,snapGrid:w,snapToGrid:S,containerBounds:u});if((P.sourceEvent.type==="touchmove"&&P.sourceEvent.touches.length>1||v&&!_.has(v))&&(h=!0),!h){if(!c&&D&&d&&(c=!0,I()),!d){const k=O.xSnapped-(i.x??0),j=O.ySnapped-(i.y??0);Math.sqrt(k*k+j*j)>E&&T(P)}(i.x!==O.xSnapped||i.y!==O.ySnapped)&&a&&d&&(l=he(P.sourceEvent,u),C(O,P.sourceEvent))}}).on("end",P=>{if(!(!d||h)&&(c=!1,d=!1,cancelAnimationFrame(s),a.size>0)){const{nodeLookup:D,updateNodePositions:A,onNodeDragStop:w,onSelectionDragStop:S}=t();if(p&&(A(a,!1),p=!1),o||w||!v&&S){const[E,_]=Ht({nodeId:v,dragItems:a,nodeLookup:D,dragging:!1});o==null||o(P.sourceEvent,a,E,_),w==null||w(P.sourceEvent,E,_),v||S==null||S(P.sourceEvent,_)}}}).filter(P=>{const D=P.target;return!P.button&&(!y||!Gn(D,`.${y}`,g))&&(!N||Gn(D,N,g))});f.call(z)}function x(){f==null||f.on(".drag",null)}return{update:m,destroy:x}}function ka(e,t,n){const r=[],o={x:e.x-n,y:e.y-n,width:n*2,height:n*2};for(const i of t.values())qe(o,Te(i))>0&&r.push(i);return r}const Ca=250;function Ma(e,t,n,r){var a,c;let o=[],i=1/0;const s=ka(e,n,t+Ca);for(const l of s){const u=[...((a=l.internals.handleBounds)==null?void 0:a.source)??[],...((c=l.internals.handleBounds)==null?void 0:c.target)??[]];for(const d of u){if(r.nodeId===d.nodeId&&r.type===d.type&&r.id===d.id)continue;const{x:f,y:h}=Ue(l,d,d.position,!0),p=Math.sqrt(Math.pow(f-e.x,2)+Math.pow(h-e.y,2));p>t||(p<i?(o=[{...d,x:f,y:h}],i=p):p===i&&o.push({...d,x:f,y:h}))}}if(!o.length)return null;if(o.length>1){const l=r.type==="source"?"target":"source";return o.find(u=>u.type===l)??o[0]}return o[0]}function uo(e,t,n,r,o,i=!1){var l,u,d;const s=r.get(e);if(!s)return null;const a=o==="strict"?(l=s.internals.handleBounds)==null?void 0:l[t]:[...((u=s.internals.handleBounds)==null?void 0:u.source)??[],...((d=s.internals.handleBounds)==null?void 0:d.target)??[]],c=(n?a==null?void 0:a.find(f=>f.id===n):a==null?void 0:a[0])??null;return c&&i?{...c,...Ue(s,c,c.position,!0)}:c}function fo(e,t){return e||(t!=null&&t.classList.contains("target")?"target":t!=null&&t.classList.contains("source")?"source":null)}function Ia(e,t){let n=null;return t?n=!0:e&&!t&&(n=!1),n}const ho=()=>!0;function $a(e,{connectionMode:t,connectionRadius:n,handleId:r,nodeId:o,edgeUpdaterType:i,isTarget:s,domNode:a,nodeLookup:c,lib:l,autoPanOnConnect:u,flowId:d,panBy:f,cancelConnection:h,onConnectStart:p,onConnect:m,onConnectEnd:x,isValidConnection:y=ho,onReconnectEnd:N,updateConnection:g,getTransform:b,getFromHandle:v,autoPanSpeed:M,dragThreshold:C=1}){const I=eo(e.target);let T=0,z;const{x:P,y:D}=he(e),A=I==null?void 0:I.elementFromPoint(P,D),w=fo(i,A),S=a==null?void 0:a.getBoundingClientRect();let E=!1;if(!S||!w)return;const _=uo(o,w,r,c,t);if(!_)return;let O=he(e,S),k=!1,j=null,R=!1,H=null;function F(){if(!u||!S)return;const[Q,U]=Kr(O,S,M);f({x:Q,y:U}),T=requestAnimationFrame(F)}const V={..._,nodeId:o,type:w,position:_.position},G=c.get(o);let Y={inProgress:!0,isValid:null,from:Ue(G,V,W.Left,!0),fromHandle:V,fromPosition:V.position,fromNode:G,to:O,toHandle:null,toPosition:On[V.position],toNode:null};function B(){E=!0,g(Y),p==null||p(e,{nodeId:o,handleId:r,handleType:w})}C===0&&B();function q(Q){if(!E){const{x:te,y:oe}=he(Q),pe=te-P,Ce=oe-D;if(!(pe*pe+Ce*Ce>C*C))return;B()}if(!v()||!V){ee(Q);return}const U=b();O=he(Q,S),z=Ma(Je(O,U,!1,[1,1]),n,c,V),k||(F(),k=!0);const Z=go(Q,{handle:z,connectionMode:t,fromNodeId:o,fromHandleId:r,fromType:s?"target":"source",isValidConnection:y,doc:I,lib:l,flowId:d,nodeLookup:c});H=Z.handleDomNode,j=Z.connection,R=Ia(!!z,Z.isValid);const K={...Y,isValid:R,to:Z.toHandle&&R?pt({x:Z.toHandle.x,y:Z.toHandle.y},U):O,toHandle:Z.toHandle,toPosition:R&&Z.toHandle?Z.toHandle.position:On[V.position],toNode:Z.toHandle?c.get(Z.toHandle.nodeId):null};R&&z&&Y.toHandle&&K.toHandle&&Y.toHandle.type===K.toHandle.type&&Y.toHandle.nodeId===K.toHandle.nodeId&&Y.toHandle.id===K.toHandle.id&&Y.to.x===K.to.x&&Y.to.y===K.to.y||(g(K),Y=K)}function ee(Q){if(E){(z||H)&&j&&R&&(m==null||m(j));const{inProgress:U,...Z}=Y,K={...Z,toPosition:Y.toHandle?Y.toPosition:null};x==null||x(Q,K),i&&(N==null||N(Q,K))}h(),cancelAnimationFrame(T),k=!1,R=!1,j=null,H=null,I.removeEventListener("mousemove",q),I.removeEventListener("mouseup",ee),I.removeEventListener("touchmove",q),I.removeEventListener("touchend",ee)}I.addEventListener("mousemove",q),I.addEventListener("mouseup",ee),I.addEventListener("touchmove",q),I.addEventListener("touchend",ee)}function go(e,{handle:t,connectionMode:n,fromNodeId:r,fromHandleId:o,fromType:i,doc:s,lib:a,flowId:c,isValidConnection:l=ho,nodeLookup:u}){const d=i==="target",f=t?s.querySelector(`.${a}-flow__handle[data-id="${c}-${t==null?void 0:t.nodeId}-${t==null?void 0:t.id}-${t==null?void 0:t.type}"]`):null,{x:h,y:p}=he(e),m=s.elementFromPoint(h,p),x=m!=null&&m.classList.contains(`${a}-flow__handle`)?m:f,y={handleDomNode:x,isValid:!1,connection:null,toHandle:null};if(x){const N=fo(void 0,x),g=x.getAttribute("data-nodeid"),b=x.getAttribute("data-handleid"),v=x.classList.contains("connectable"),M=x.classList.contains("connectableend");if(!g||!N)return y;const C={source:d?g:r,sourceHandle:d?b:o,target:d?r:g,targetHandle:d?o:b};y.connection=C;const T=v&&M&&(n===Oe.Strict?d&&N==="source"||!d&&N==="target":g!==r||b!==o);y.isValid=T&&l(C),y.toHandle=uo(g,N,b,u,n,!0)}return y}const rn={onPointerDown:$a,isValid:go};function La({domNode:e,panZoom:t,getTransform:n,getViewScale:r}){const o=ce(e);function i({translateExtent:a,width:c,height:l,zoomStep:u=10,pannable:d=!0,zoomable:f=!0,inversePan:h=!1}){const p=g=>{const b=n();if(g.sourceEvent.type!=="wheel"||!t)return;const v=-g.sourceEvent.deltaY*(g.sourceEvent.deltaMode===1?.05:g.sourceEvent.deltaMode?1:.002)*u,M=b[2]*Math.pow(2,v);t.scaleTo(M)};let m=[0,0];const x=g=>{(g.sourceEvent.type==="mousedown"||g.sourceEvent.type==="touchstart")&&(m=[g.sourceEvent.clientX??g.sourceEvent.touches[0].clientX,g.sourceEvent.clientY??g.sourceEvent.touches[0].clientY])},y=g=>{const b=n();if(g.sourceEvent.type!=="mousemove"&&g.sourceEvent.type!=="touchmove"||!t)return;const v=[g.sourceEvent.clientX??g.sourceEvent.touches[0].clientX,g.sourceEvent.clientY??g.sourceEvent.touches[0].clientY],M=[v[0]-m[0],v[1]-m[1]];m=v;const C=r()*Math.max(b[2],Math.log(b[2]))*(h?-1:1),I={x:b[0]-M[0]*C,y:b[1]-M[1]*C},T=[[0,0],[c,l]];t.setViewportConstrained({x:I.x,y:I.y,zoom:b[2]},T,a)},N=Br().on("start",x).on("zoom",d?y:null).on("zoom.wheel",f?p:null);o.call(N,{})}function s(){o.on("zoom",null)}return{update:i,destroy:s,pointer:ue}}const Pa=(e,t)=>e.x!==t.x||e.y!==t.y||e.zoom!==t.k,_t=e=>({x:e.x,y:e.y,zoom:e.k}),Vt=({x:e,y:t,zoom:n})=>cn.translate(e,t).scale(n),$e=(e,t)=>e.target.closest(`.${t}`),po=(e,t)=>t===2&&Array.isArray(e)&&e.includes(2),Oa=e=>((e*=2)<=1?e*e*e:(e-=2)*e*e+2)/2,Bt=(e,t=0,n=Oa,r=()=>{})=>{const o=typeof t=="number"&&t>0;return o||r(),o?e.transition().duration(t).ease(n).on("end",r):e},mo=e=>{const t=e.ctrlKey&&mt()?10:1;return-e.deltaY*(e.deltaMode===1?.05:e.deltaMode?1:.002)*t};function ja({zoomPanValues:e,noWheelClassName:t,d3Selection:n,d3Zoom:r,panOnScrollMode:o,panOnScrollSpeed:i,zoomOnPinch:s,onPanZoomStart:a,onPanZoom:c,onPanZoomEnd:l}){return u=>{if($e(u,t))return!1;u.preventDefault(),u.stopImmediatePropagation();const d=n.property("__zoom").k||1;if(u.ctrlKey&&s){const x=ue(u),y=mo(u),N=d*Math.pow(2,y);r.scaleTo(n,N,x,u);return}const f=u.deltaMode===1?20:1;let h=o===_e.Vertical?0:u.deltaX*f,p=o===_e.Horizontal?0:u.deltaY*f;!mt()&&u.shiftKey&&o!==_e.Vertical&&(h=u.deltaY*f,p=0),r.translateBy(n,-(h/d)*i,-(p/d)*i,{internal:!0});const m=_t(n.property("__zoom"));clearTimeout(e.panScrollTimeout),e.isPanScrolling||(e.isPanScrolling=!0,a==null||a(u,m)),e.isPanScrolling&&(c==null||c(u,m),e.panScrollTimeout=setTimeout(()=>{l==null||l(u,m),e.isPanScrolling=!1},150))}}function Ta({noWheelClassName:e,preventScrolling:t,d3ZoomHandler:n}){return function(r,o){const i=r.type==="wheel",s=!t&&i&&!r.ctrlKey,a=$e(r,e);if(r.ctrlKey&&i&&a&&r.preventDefault(),s||a)return null;r.preventDefault(),n.call(this,r,o)}}function Aa({zoomPanValues:e,onDraggingChange:t,onPanZoomStart:n}){return r=>{var i,s,a;if((i=r.sourceEvent)!=null&&i.internal)return;const o=_t(r.transform);e.mouseButton=((s=r.sourceEvent)==null?void 0:s.button)||0,e.isZoomingOrPanning=!0,e.prevViewport=o,((a=r.sourceEvent)==null?void 0:a.type)==="mousedown"&&t(!0),n&&(n==null||n(r.sourceEvent,o))}}function Da({zoomPanValues:e,panOnDrag:t,onPaneContextMenu:n,onTransformChange:r,onPanZoom:o}){return i=>{var s,a;e.usedRightMouseButton=!!(n&&po(t,e.mouseButton??0)),(s=i.sourceEvent)!=null&&s.sync||r([i.transform.x,i.transform.y,i.transform.k]),o&&!((a=i.sourceEvent)!=null&&a.internal)&&(o==null||o(i.sourceEvent,_t(i.transform)))}}function Ra({zoomPanValues:e,panOnDrag:t,panOnScroll:n,onDraggingChange:r,onPanZoomEnd:o,onPaneContextMenu:i}){return s=>{var a;if(!((a=s.sourceEvent)!=null&&a.internal)&&(e.isZoomingOrPanning=!1,i&&po(t,e.mouseButton??0)&&!e.usedRightMouseButton&&s.sourceEvent&&i(s.sourceEvent),e.usedRightMouseButton=!1,r(!1),o&&Pa(e.prevViewport,s.transform))){const c=_t(s.transform);e.prevViewport=c,clearTimeout(e.timerId),e.timerId=setTimeout(()=>{o==null||o(s.sourceEvent,c)},n?150:0)}}}function za({zoomActivationKeyPressed:e,zoomOnScroll:t,zoomOnPinch:n,panOnDrag:r,panOnScroll:o,zoomOnDoubleClick:i,userSelectionActive:s,noWheelClassName:a,noPanClassName:c,lib:l}){return u=>{var p;const d=e||t,f=n&&u.ctrlKey;if(u.button===1&&u.type==="mousedown"&&($e(u,`${l}-flow__node`)||$e(u,`${l}-flow__edge`)))return!0;if(!r&&!d&&!o&&!i&&!n||s||$e(u,a)&&u.type==="wheel"||$e(u,c)&&(u.type!=="wheel"||o&&u.type==="wheel"&&!e)||!n&&u.ctrlKey&&u.type==="wheel")return!1;if(!n&&u.type==="touchstart"&&((p=u.touches)==null?void 0:p.length)>1)return u.preventDefault(),!1;if(!d&&!o&&!f&&u.type==="wheel"||!r&&(u.type==="mousedown"||u.type==="touchstart")||Array.isArray(r)&&!r.includes(u.button)&&u.type==="mousedown")return!1;const h=Array.isArray(r)&&r.includes(u.button)||!u.button||u.button<=1;return(!u.ctrlKey||u.type==="wheel")&&h}}function Ha({domNode:e,minZoom:t,maxZoom:n,paneClickDistance:r,translateExtent:o,viewport:i,onPanZoom:s,onPanZoomStart:a,onPanZoomEnd:c,onDraggingChange:l}){const u={isZoomingOrPanning:!1,usedRightMouseButton:!1,prevViewport:{x:0,y:0,zoom:0},mouseButton:0,timerId:void 0,panScrollTimeout:void 0,isPanScrolling:!1},d=e.getBoundingClientRect(),f=Br().clickDistance(!de(r)||r<0?0:r).scaleExtent([t,n]).translateExtent(o),h=ce(e).call(f);g({x:i.x,y:i.y,zoom:je(i.zoom,t,n)},[[0,0],[d.width,d.height]],o);const p=h.on("wheel.zoom"),m=h.on("dblclick.zoom");f.wheelDelta(mo);function x(D,A){return h?new Promise(w=>{f==null||f.interpolate((A==null?void 0:A.interpolate)==="linear"?Dt:ft).transform(Bt(h,A==null?void 0:A.duration,A==null?void 0:A.ease,()=>w(!0)),D)}):Promise.resolve(!1)}function y({noWheelClassName:D,noPanClassName:A,onPaneContextMenu:w,userSelectionActive:S,panOnScroll:E,panOnDrag:_,panOnScrollMode:O,panOnScrollSpeed:k,preventScrolling:j,zoomOnPinch:R,zoomOnScroll:H,zoomOnDoubleClick:F,zoomActivationKeyPressed:V,lib:G,onTransformChange:X}){S&&!u.isZoomingOrPanning&&N();const B=E&&!V&&!S?ja({zoomPanValues:u,noWheelClassName:D,d3Selection:h,d3Zoom:f,panOnScrollMode:O,panOnScrollSpeed:k,zoomOnPinch:R,onPanZoomStart:a,onPanZoom:s,onPanZoomEnd:c}):Ta({noWheelClassName:D,preventScrolling:j,d3ZoomHandler:p});if(h.on("wheel.zoom",B,{passive:!1}),!S){const ee=Aa({zoomPanValues:u,onDraggingChange:l,onPanZoomStart:a});f.on("start",ee);const Q=Da({zoomPanValues:u,panOnDrag:_,onPaneContextMenu:!!w,onPanZoom:s,onTransformChange:X});f.on("zoom",Q);const U=Ra({zoomPanValues:u,panOnDrag:_,panOnScroll:E,onPaneContextMenu:w,onPanZoomEnd:c,onDraggingChange:l});f.on("end",U)}const q=za({zoomActivationKeyPressed:V,panOnDrag:_,zoomOnScroll:H,panOnScroll:E,zoomOnDoubleClick:F,zoomOnPinch:R,userSelectionActive:S,noPanClassName:A,noWheelClassName:D,lib:G});f.filter(q),F?h.on("dblclick.zoom",m):h.on("dblclick.zoom",null)}function N(){f.on("zoom",null)}async function g(D,A,w){const S=Vt(D),E=f==null?void 0:f.constrain()(S,A,w);return E&&await x(E),new Promise(_=>_(E))}async function b(D,A){const w=Vt(D);return await x(w,A),new Promise(S=>S(w))}function v(D){if(h){const A=Vt(D),w=h.property("__zoom");(w.k!==D.zoom||w.x!==D.x||w.y!==D.y)&&(f==null||f.transform(h,A,null,{sync:!0}))}}function M(){const D=h?js(h.node()):{x:0,y:0,k:1};return{x:D.x,y:D.y,zoom:D.k}}function C(D,A){return h?new Promise(w=>{f==null||f.interpolate((A==null?void 0:A.interpolate)==="linear"?Dt:ft).scaleTo(Bt(h,A==null?void 0:A.duration,A==null?void 0:A.ease,()=>w(!0)),D)}):Promise.resolve(!1)}function I(D,A){return h?new Promise(w=>{f==null||f.interpolate((A==null?void 0:A.interpolate)==="linear"?Dt:ft).scaleBy(Bt(h,A==null?void 0:A.duration,A==null?void 0:A.ease,()=>w(!0)),D)}):Promise.resolve(!1)}function T(D){f==null||f.scaleExtent(D)}function z(D){f==null||f.translateExtent(D)}function P(D){const A=!de(D)||D<0?0:D;f==null||f.clickDistance(A)}return{update:y,destroy:N,setViewport:b,setViewportConstrained:g,getViewport:M,scaleTo:C,scaleBy:I,setScaleExtent:T,setTranslateExtent:z,syncViewport:v,setClickDistance:P}}var De;(function(e){e.Line="line",e.Handle="handle"})(De||(De={}));function Va({width:e,prevWidth:t,height:n,prevHeight:r,affectsX:o,affectsY:i}){const s=e-t,a=n-r,c=[s>0?1:s<0?-1:0,a>0?1:a<0?-1:0];return s&&o&&(c[0]=c[0]*-1),a&&i&&(c[1]=c[1]*-1),c}function Ba(e){const t=e.includes("right")||e.includes("left"),n=e.includes("bottom")||e.includes("top"),r=e.includes("left"),o=e.includes("top");return{isHorizontal:t,isVertical:n,affectsX:r,affectsY:o}}function we(e,t){return Math.max(0,t-e)}function xe(e,t){return Math.max(0,e-t)}function ct(e,t,n){return Math.max(0,t-e,e-n)}function Wn(e,t){return e?!t:t}function Fa(e,t,n,r,o,i,s,a){let{affectsX:c,affectsY:l}=t;const{isHorizontal:u,isVertical:d}=t,f=u&&d,{xSnapped:h,ySnapped:p}=n,{minWidth:m,maxWidth:x,minHeight:y,maxHeight:N}=r,{x:g,y:b,width:v,height:M,aspectRatio:C}=e;let I=Math.floor(u?h-e.pointerX:0),T=Math.floor(d?p-e.pointerY:0);const z=v+(c?-I:I),P=M+(l?-T:T),D=-i[0]*v,A=-i[1]*M;let w=ct(z,m,x),S=ct(P,y,N);if(s){let O=0,k=0;c&&I<0?O=we(g+I+D,s[0][0]):!c&&I>0&&(O=xe(g+z+D,s[1][0])),l&&T<0?k=we(b+T+A,s[0][1]):!l&&T>0&&(k=xe(b+P+A,s[1][1])),w=Math.max(w,O),S=Math.max(S,k)}if(a){let O=0,k=0;c&&I>0?O=xe(g+I,a[0][0]):!c&&I<0&&(O=we(g+z,a[1][0])),l&&T>0?k=xe(b+T,a[0][1]):!l&&T<0&&(k=we(b+P,a[1][1])),w=Math.max(w,O),S=Math.max(S,k)}if(o){if(u){const O=ct(z/C,y,N)*C;if(w=Math.max(w,O),s){let k=0;!c&&!l||c&&!l&&f?k=xe(b+A+z/C,s[1][1])*C:k=we(b+A+(c?I:-I)/C,s[0][1])*C,w=Math.max(w,k)}if(a){let k=0;!c&&!l||c&&!l&&f?k=we(b+z/C,a[1][1])*C:k=xe(b+(c?I:-I)/C,a[0][1])*C,w=Math.max(w,k)}}if(d){const O=ct(P*C,m,x)/C;if(S=Math.max(S,O),s){let k=0;!c&&!l||l&&!c&&f?k=xe(g+P*C+D,s[1][0])/C:k=we(g+(l?T:-T)*C+D,s[0][0])/C,S=Math.max(S,k)}if(a){let k=0;!c&&!l||l&&!c&&f?k=we(g+P*C,a[1][0])/C:k=xe(g+(l?T:-T)*C,a[0][0])/C,S=Math.max(S,k)}}}T=T+(T<0?S:-S),I=I+(I<0?w:-w),o&&(f?z>P*C?T=(Wn(c,l)?-I:I)/C:I=(Wn(c,l)?-T:T)*C:u?(T=I/C,l=c):(I=T*C,c=l));const E=c?g+I:g,_=l?b+T:b;return{width:v+(c?-I:I),height:M+(l?-T:T),x:i[0]*I*(c?-1:1)+E,y:i[1]*T*(l?-1:1)+_}}const yo={width:0,height:0,x:0,y:0},Ya={...yo,pointerX:0,pointerY:0,aspectRatio:1};function Ga(e){return[[0,0],[e.measured.width,e.measured.height]]}function Wa(e,t,n){const r=t.position.x+e.position.x,o=t.position.y+e.position.y,i=e.measured.width??0,s=e.measured.height??0,a=n[0]*i,c=n[1]*s;return[[r-a,o-c],[r+i-a,o+s-c]]}function Xa({domNode:e,nodeId:t,getStoreItems:n,onChange:r,onEnd:o}){const i=ce(e);function s({controlPosition:c,boundaries:l,keepAspectRatio:u,resizeDirection:d,onResizeStart:f,onResize:h,onResizeEnd:p,shouldResize:m}){let x={...yo},y={...Ya};const N=Ba(c);let g,b=null,v=[],M,C,I;const T=Vr().on("start",z=>{const{nodeLookup:P,transform:D,snapGrid:A,snapToGrid:w,nodeOrigin:S,paneDomNode:E}=n();if(g=P.get(t),!g)return;b=(E==null?void 0:E.getBoundingClientRect())??null;const{xSnapped:_,ySnapped:O}=Ye(z.sourceEvent,{transform:D,snapGrid:A,snapToGrid:w,containerBounds:b});x={width:g.measured.width??0,height:g.measured.height??0,x:g.position.x??0,y:g.position.y??0},y={...x,pointerX:_,pointerY:O,aspectRatio:x.width/x.height},M=void 0,g.parentId&&(g.extent==="parent"||g.expandParent)&&(M=P.get(g.parentId),C=M&&g.extent==="parent"?Ga(M):void 0),v=[],I=void 0;for(const[k,j]of P)if(j.parentId===t&&(v.push({id:k,position:{...j.position},extent:j.extent}),j.extent==="parent"||j.expandParent)){const R=Wa(j,g,j.origin??S);I?I=[[Math.min(R[0][0],I[0][0]),Math.min(R[0][1],I[0][1])],[Math.max(R[1][0],I[1][0]),Math.max(R[1][1],I[1][1])]]:I=R}f==null||f(z,{...x})}).on("drag",z=>{const{transform:P,snapGrid:D,snapToGrid:A,nodeOrigin:w}=n(),S=Ye(z.sourceEvent,{transform:P,snapGrid:D,snapToGrid:A,containerBounds:b}),E=[];if(!g)return;const{x:_,y:O,width:k,height:j}=x,R={},H=g.origin??w,{width:F,height:V,x:G,y:X}=Fa(y,N,S,l,u,H,C,I),Y=F!==k,B=V!==j,q=G!==_&&Y,ee=X!==O&&B;if(!q&&!ee&&!Y&&!B)return;if((q||ee||H[0]===1||H[1]===1)&&(R.x=q?G:x.x,R.y=ee?X:x.y,x.x=R.x,x.y=R.y,v.length>0)){const K=G-_,te=X-O;for(const oe of v)oe.position={x:oe.position.x-K+H[0]*(F-k),y:oe.position.y-te+H[1]*(V-j)},E.push(oe)}if((Y||B)&&(R.width=Y&&(!d||d==="horizontal")?F:x.width,R.height=B&&(!d||d==="vertical")?V:x.height,x.width=R.width,x.height=R.height),M&&g.expandParent){const K=H[0]*(R.width??0);R.x&&R.x<K&&(x.x=K,y.x=y.x-(R.x-K));const te=H[1]*(R.height??0);R.y&&R.y<te&&(x.y=te,y.y=y.y-(R.y-te))}const Q=Va({width:x.width,prevWidth:k,height:x.height,prevHeight:j,affectsX:N.affectsX,affectsY:N.affectsY}),U={...x,direction:Q};(m==null?void 0:m(z,U))!==!1&&(h==null||h(z,U),r(R,E))}).on("end",z=>{p==null||p(z,{...x}),o==null||o({...x})});i.call(T)}function a(){i.on(".drag",null)}return{update:s,destroy:a}}var wo={exports:{}},xo={},bo={exports:{}},vo={};/**
 * @license React
 * use-sync-external-store-shim.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Re=L;function qa(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var Ua=typeof Object.is=="function"?Object.is:qa,Ka=Re.useState,Za=Re.useEffect,Qa=Re.useLayoutEffect,Ja=Re.useDebugValue;function ec(e,t){var n=t(),r=Ka({inst:{value:n,getSnapshot:t}}),o=r[0].inst,i=r[1];return Qa(function(){o.value=n,o.getSnapshot=t,Ft(o)&&i({inst:o})},[e,n,t]),Za(function(){return Ft(o)&&i({inst:o}),e(function(){Ft(o)&&i({inst:o})})},[e]),Ja(n),n}function Ft(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!Ua(e,n)}catch{return!0}}function tc(e,t){return t()}var nc=typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"?tc:ec;vo.useSyncExternalStore=Re.useSyncExternalStore!==void 0?Re.useSyncExternalStore:nc;bo.exports=vo;var rc=bo.exports;/**
 * @license React
 * use-sync-external-store-shim/with-selector.production.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var St=L,oc=rc;function ic(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var sc=typeof Object.is=="function"?Object.is:ic,ac=oc.useSyncExternalStore,cc=St.useRef,lc=St.useEffect,uc=St.useMemo,dc=St.useDebugValue;xo.useSyncExternalStoreWithSelector=function(e,t,n,r,o){var i=cc(null);if(i.current===null){var s={hasValue:!1,value:null};i.current=s}else s=i.current;i=uc(function(){function c(h){if(!l){if(l=!0,u=h,h=r(h),o!==void 0&&s.hasValue){var p=s.value;if(o(p,h))return d=p}return d=h}if(p=d,sc(u,h))return p;var m=r(h);return o!==void 0&&o(p,m)?(u=h,p):(u=h,d=m)}var l=!1,u,d,f=n===void 0?null:n;return[function(){return c(t())},f===null?void 0:function(){return c(f())}]},[t,n,r,o]);var a=ac(e,i[0],i[1]);return lc(function(){s.hasValue=!0,s.value=a},[a]),dc(a),a};wo.exports=xo;var fc=wo.exports;const hc=Dr(fc),gc={},Xn=e=>{let t;const n=new Set,r=(u,d)=>{const f=typeof u=="function"?u(t):u;if(!Object.is(f,t)){const h=t;t=d??(typeof f!="object"||f===null)?f:Object.assign({},t,f),n.forEach(p=>p(t,h))}},o=()=>t,c={setState:r,getState:o,getInitialState:()=>l,subscribe:u=>(n.add(u),()=>n.delete(u)),destroy:()=>{(gc?"production":void 0)!=="production"&&console.warn("[DEPRECATED] The `destroy` method will be unsupported in a future version. Instead use unsubscribe function returned by subscribe. Everything will be garbage-collected if store is garbage-collected."),n.clear()}},l=t=e(r,o,c);return c},pc=e=>e?Xn(e):Xn,{useDebugValue:mc}=Os,{useSyncExternalStoreWithSelector:yc}=hc,wc=e=>e;function Eo(e,t=wc,n){const r=yc(e.subscribe,e.getState,e.getServerState||e.getInitialState,t,n);return mc(r),r}const qn=(e,t)=>{const n=pc(e),r=(o,i=t)=>Eo(n,o,i);return Object.assign(r,n),r},xc=(e,t)=>e?qn(e,t):qn;function re(e,t){if(Object.is(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;if(e instanceof Map&&t instanceof Map){if(e.size!==t.size)return!1;for(const[r,o]of e)if(!Object.is(o,t.get(r)))return!1;return!0}if(e instanceof Set&&t instanceof Set){if(e.size!==t.size)return!1;for(const r of e)if(!t.has(r))return!1;return!0}const n=Object.keys(e);if(n.length!==Object.keys(t).length)return!1;for(const r of n)if(!Object.prototype.hasOwnProperty.call(t,r)||!Object.is(e[r],t[r]))return!1;return!0}const kt=L.createContext(null),bc=kt.Provider,No=ge.error001();function J(e,t){const n=L.useContext(kt);if(n===null)throw new Error(No);return Eo(n,e,t)}function ne(){const e=L.useContext(kt);if(e===null)throw new Error(No);return L.useMemo(()=>({getState:e.getState,setState:e.setState,subscribe:e.subscribe}),[e])}const Un={display:"none"},vc={position:"absolute",width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0px, 0px, 0px, 0px)",clipPath:"inset(100%)"},_o="react-flow__node-desc",So="react-flow__edge-desc",Ec="react-flow__aria-live",Nc=e=>e.ariaLiveMessage,_c=e=>e.ariaLabelConfig;function Sc({rfId:e}){const t=J(Nc);return $.jsx("div",{id:`${Ec}-${e}`,"aria-live":"assertive","aria-atomic":"true",style:vc,children:t})}function kc({rfId:e,disableKeyboardA11y:t}){const n=J(_c);return $.jsxs($.Fragment,{children:[$.jsx("div",{id:`${_o}-${e}`,style:Un,children:t?n["node.a11yDescription.default"]:n["node.a11yDescription.keyboardDisabled"]}),$.jsx("div",{id:`${So}-${e}`,style:Un,children:n["edge.a11yDescription.default"]}),!t&&$.jsx(Sc,{rfId:e})]})}const Ct=L.forwardRef(({position:e="top-left",children:t,className:n,style:r,...o},i)=>{const s=`${e}`.split("-");return $.jsx("div",{className:ae(["react-flow__panel",n,...s]),style:r,ref:i,...o,children:t})});Ct.displayName="Panel";function Cc({proOptions:e,position:t="bottom-right"}){return e!=null&&e.hideAttribution?null:$.jsx(Ct,{position:t,className:"react-flow__attribution","data-message":"Please only hide this attribution when you are subscribed to React Flow Pro: https://pro.reactflow.dev",children:$.jsx("a",{href:"https://reactflow.dev",target:"_blank",rel:"noopener noreferrer","aria-label":"React Flow attribution",children:"React Flow"})})}const Mc=e=>{const t=[],n=[];for(const[,r]of e.nodeLookup)r.selected&&t.push(r.internals.userNode);for(const[,r]of e.edgeLookup)r.selected&&n.push(r);return{selectedNodes:t,selectedEdges:n}},lt=e=>e.id;function Ic(e,t){return re(e.selectedNodes.map(lt),t.selectedNodes.map(lt))&&re(e.selectedEdges.map(lt),t.selectedEdges.map(lt))}function $c({onSelectionChange:e}){const t=ne(),{selectedNodes:n,selectedEdges:r}=J(Mc,Ic);return L.useEffect(()=>{const o={nodes:n,edges:r};e==null||e(o),t.getState().onSelectionChangeHandlers.forEach(i=>i(o))},[n,r,e]),null}const Lc=e=>!!e.onSelectionChangeHandlers;function Pc({onSelectionChange:e}){const t=J(Lc);return e||t?$.jsx($c,{onSelectionChange:e}):null}const ko=[0,0],Oc={x:0,y:0,zoom:1},jc=["nodes","edges","defaultNodes","defaultEdges","onConnect","onConnectStart","onConnectEnd","onClickConnectStart","onClickConnectEnd","nodesDraggable","autoPanOnNodeFocus","nodesConnectable","nodesFocusable","edgesFocusable","edgesReconnectable","elevateNodesOnSelect","elevateEdgesOnSelect","minZoom","maxZoom","nodeExtent","onNodesChange","onEdgesChange","elementsSelectable","connectionMode","snapGrid","snapToGrid","translateExtent","connectOnClick","defaultEdgeOptions","fitView","fitViewOptions","onNodesDelete","onEdgesDelete","onDelete","onNodeDrag","onNodeDragStart","onNodeDragStop","onSelectionDrag","onSelectionDragStart","onSelectionDragStop","onMoveStart","onMove","onMoveEnd","noPanClassName","nodeOrigin","autoPanOnConnect","autoPanOnNodeDrag","onError","connectionRadius","isValidConnection","selectNodesOnDrag","nodeDragThreshold","connectionDragThreshold","onBeforeDelete","debug","autoPanSpeed","paneClickDistance","ariaLabelConfig"],Kn=[...jc,"rfId"],Tc=e=>({setNodes:e.setNodes,setEdges:e.setEdges,setMinZoom:e.setMinZoom,setMaxZoom:e.setMaxZoom,setTranslateExtent:e.setTranslateExtent,setNodeExtent:e.setNodeExtent,reset:e.reset,setDefaultNodesAndEdges:e.setDefaultNodesAndEdges,setPaneClickDistance:e.setPaneClickDistance}),Zn={translateExtent:We,nodeOrigin:ko,minZoom:.5,maxZoom:2,elementsSelectable:!0,noPanClassName:"nopan",rfId:"1",paneClickDistance:0};function Ac(e){const{setNodes:t,setEdges:n,setMinZoom:r,setMaxZoom:o,setTranslateExtent:i,setNodeExtent:s,reset:a,setDefaultNodesAndEdges:c,setPaneClickDistance:l}=J(Tc,re),u=ne();L.useEffect(()=>(c(e.defaultNodes,e.defaultEdges),()=>{d.current=Zn,a()}),[]);const d=L.useRef(Zn);return L.useEffect(()=>{for(const f of Kn){const h=e[f],p=d.current[f];h!==p&&(typeof e[f]>"u"||(f==="nodes"?t(h):f==="edges"?n(h):f==="minZoom"?r(h):f==="maxZoom"?o(h):f==="translateExtent"?i(h):f==="nodeExtent"?s(h):f==="paneClickDistance"?l(h):f==="ariaLabelConfig"?u.setState({ariaLabelConfig:sa(h)}):f==="fitView"?u.setState({fitViewQueued:h}):f==="fitViewOptions"?u.setState({fitViewOptions:h}):u.setState({[f]:h})))}d.current=e},Kn.map(f=>e[f])),null}function Qn(){return typeof window>"u"||!window.matchMedia?null:window.matchMedia("(prefers-color-scheme: dark)")}function Dc(e){var r;const[t,n]=L.useState(e==="system"?null:e);return L.useEffect(()=>{if(e!=="system"){n(e);return}const o=Qn(),i=()=>n(o!=null&&o.matches?"dark":"light");return i(),o==null||o.addEventListener("change",i),()=>{o==null||o.removeEventListener("change",i)}},[e]),t!==null?t:(r=Qn())!=null&&r.matches?"dark":"light"}const Jn=typeof document<"u"?document:null;function Ke(e=null,t={target:Jn,actInsideInputWithModifier:!0}){const[n,r]=L.useState(!1),o=L.useRef(!1),i=L.useRef(new Set([])),[s,a]=L.useMemo(()=>{if(e!==null){const l=(Array.isArray(e)?e:[e]).filter(d=>typeof d=="string").map(d=>d.replace("+",`
`).replace(`

`,`
+`).split(`
`)),u=l.reduce((d,f)=>d.concat(...f),[]);return[l,u]}return[[],[]]},[e]);return L.useEffect(()=>{const c=(t==null?void 0:t.target)??Jn,l=(t==null?void 0:t.actInsideInputWithModifier)??!0;if(e!==null){const u=h=>{var x,y;if(o.current=h.ctrlKey||h.metaKey||h.shiftKey||h.altKey,(!o.current||o.current&&!l)&&to(h))return!1;const m=tr(h.code,a);if(i.current.add(h[m]),er(s,i.current,!1)){const N=((y=(x=h.composedPath)==null?void 0:x.call(h))==null?void 0:y[0])||h.target,g=(N==null?void 0:N.nodeName)==="BUTTON"||(N==null?void 0:N.nodeName)==="A";t.preventDefault!==!1&&(o.current||!g)&&h.preventDefault(),r(!0)}},d=h=>{const p=tr(h.code,a);er(s,i.current,!0)?(r(!1),i.current.clear()):i.current.delete(h[p]),h.key==="Meta"&&i.current.clear(),o.current=!1},f=()=>{i.current.clear(),r(!1)};return c==null||c.addEventListener("keydown",u),c==null||c.addEventListener("keyup",d),window.addEventListener("blur",f),window.addEventListener("contextmenu",f),()=>{c==null||c.removeEventListener("keydown",u),c==null||c.removeEventListener("keyup",d),window.removeEventListener("blur",f),window.removeEventListener("contextmenu",f)}}},[e,r]),n}function er(e,t,n){return e.filter(r=>n||r.length===t.size).some(r=>r.every(o=>t.has(o)))}function tr(e,t){return t.includes(e)?"code":"key"}const Rc=()=>{const e=ne();return L.useMemo(()=>({zoomIn:t=>{const{panZoom:n}=e.getState();return n?n.scaleBy(1.2,{duration:t==null?void 0:t.duration}):Promise.resolve(!1)},zoomOut:t=>{const{panZoom:n}=e.getState();return n?n.scaleBy(1/1.2,{duration:t==null?void 0:t.duration}):Promise.resolve(!1)},zoomTo:(t,n)=>{const{panZoom:r}=e.getState();return r?r.scaleTo(t,{duration:n==null?void 0:n.duration}):Promise.resolve(!1)},getZoom:()=>e.getState().transform[2],setViewport:async(t,n)=>{const{transform:[r,o,i],panZoom:s}=e.getState();return s?(await s.setViewport({x:t.x??r,y:t.y??o,zoom:t.zoom??i},n),Promise.resolve(!0)):Promise.resolve(!1)},getViewport:()=>{const[t,n,r]=e.getState().transform;return{x:t,y:n,zoom:r}},setCenter:async(t,n,r)=>e.getState().setCenter(t,n,r),fitBounds:async(t,n)=>{const{width:r,height:o,minZoom:i,maxZoom:s,panZoom:a}=e.getState(),c=dn(t,r,o,i,s,(n==null?void 0:n.padding)??.1);return a?(await a.setViewport(c,{duration:n==null?void 0:n.duration,ease:n==null?void 0:n.ease,interpolate:n==null?void 0:n.interpolate}),Promise.resolve(!0)):Promise.resolve(!1)},screenToFlowPosition:(t,n={})=>{const{transform:r,snapGrid:o,snapToGrid:i,domNode:s}=e.getState();if(!s)return t;const{x:a,y:c}=s.getBoundingClientRect(),l={x:t.x-a,y:t.y-c},u=n.snapGrid??o,d=n.snapToGrid??i;return Je(l,r,d,u)},flowToScreenPosition:t=>{const{transform:n,domNode:r}=e.getState();if(!r)return t;const{x:o,y:i}=r.getBoundingClientRect(),s=pt(t,n);return{x:s.x+o,y:s.y+i}}}),[])};function Co(e,t){const n=[],r=new Map,o=[];for(const i of e)if(i.type==="add"){o.push(i);continue}else if(i.type==="remove"||i.type==="replace")r.set(i.id,[i]);else{const s=r.get(i.id);s?s.push(i):r.set(i.id,[i])}for(const i of t){const s=r.get(i.id);if(!s){n.push(i);continue}if(s[0].type==="remove")continue;if(s[0].type==="replace"){n.push({...s[0].item});continue}const a={...i};for(const c of s)zc(c,a);n.push(a)}return o.length&&o.forEach(i=>{i.index!==void 0?n.splice(i.index,0,{...i.item}):n.push({...i.item})}),n}function zc(e,t){switch(e.type){case"select":{t.selected=e.selected;break}case"position":{typeof e.position<"u"&&(t.position=e.position),typeof e.dragging<"u"&&(t.dragging=e.dragging);break}case"dimensions":{typeof e.dimensions<"u"&&(t.measured??(t.measured={}),t.measured.width=e.dimensions.width,t.measured.height=e.dimensions.height,e.setAttributes&&((e.setAttributes===!0||e.setAttributes==="width")&&(t.width=e.dimensions.width),(e.setAttributes===!0||e.setAttributes==="height")&&(t.height=e.dimensions.height))),typeof e.resizing=="boolean"&&(t.resizing=e.resizing);break}}}function Mo(e,t){return Co(e,t)}function Io(e,t){return Co(e,t)}function Ne(e,t){return{id:e,type:"select",selected:t}}function Le(e,t=new Set,n=!1){const r=[];for(const[o,i]of e){const s=t.has(o);!(i.selected===void 0&&!s)&&i.selected!==s&&(n&&(i.selected=s),r.push(Ne(i.id,s)))}return r}function nr({items:e=[],lookup:t}){var o;const n=[],r=new Map(e.map(i=>[i.id,i]));for(const[i,s]of e.entries()){const a=t.get(s.id),c=((o=a==null?void 0:a.internals)==null?void 0:o.userNode)??a;c!==void 0&&c!==s&&n.push({id:s.id,item:s,type:"replace"}),c===void 0&&n.push({item:s,type:"add",index:i})}for(const[i]of t)r.get(i)===void 0&&n.push({id:i,type:"remove"});return n}function rr(e){return{id:e.id,type:"remove"}}const or=e=>Ks(e),Hc=e=>Xr(e);function $o(e){return L.forwardRef(e)}const Vc=typeof window<"u"?L.useLayoutEffect:L.useEffect;function ir(e){const[t,n]=L.useState(BigInt(0)),[r]=L.useState(()=>Bc(()=>n(o=>o+BigInt(1))));return Vc(()=>{const o=r.get();o.length&&(e(o),r.reset())},[t]),r}function Bc(e){let t=[];return{get:()=>t,reset:()=>{t=[]},push:n=>{t.push(n),e()}}}const Lo=L.createContext(null);function Fc({children:e}){const t=ne(),n=L.useCallback(a=>{const{nodes:c=[],setNodes:l,hasDefaultNodes:u,onNodesChange:d,nodeLookup:f,fitViewQueued:h}=t.getState();let p=c;for(const x of a)p=typeof x=="function"?x(p):x;const m=nr({items:p,lookup:f});u&&l(p),m.length>0?d==null||d(m):h&&window.requestAnimationFrame(()=>{const{fitViewQueued:x,nodes:y,setNodes:N}=t.getState();x&&N(y)})},[]),r=ir(n),o=L.useCallback(a=>{const{edges:c=[],setEdges:l,hasDefaultEdges:u,onEdgesChange:d,edgeLookup:f}=t.getState();let h=c;for(const p of a)h=typeof p=="function"?p(h):p;u?l(h):d&&d(nr({items:h,lookup:f}))},[]),i=ir(o),s=L.useMemo(()=>({nodeQueue:r,edgeQueue:i}),[]);return $.jsx(Lo.Provider,{value:s,children:e})}function Yc(){const e=L.useContext(Lo);if(!e)throw new Error("useBatchContext must be used within a BatchProvider");return e}const Gc=e=>!!e.panZoom;function yn(){const e=Rc(),t=ne(),n=Yc(),r=J(Gc),o=L.useMemo(()=>{const i=d=>t.getState().nodeLookup.get(d),s=d=>{n.nodeQueue.push(d)},a=d=>{n.edgeQueue.push(d)},c=d=>{var y,N;const{nodeLookup:f,nodeOrigin:h}=t.getState(),p=or(d)?d:f.get(d.id),m=p.parentId?Jr(p.position,p.measured,p.parentId,f,h):p.position,x={...p,position:m,width:((y=p.measured)==null?void 0:y.width)??p.width,height:((N=p.measured)==null?void 0:N.height)??p.height};return Te(x)},l=(d,f,h={replace:!1})=>{s(p=>p.map(m=>{if(m.id===d){const x=typeof f=="function"?f(m):f;return h.replace&&or(x)?x:{...m,...x}}return m}))},u=(d,f,h={replace:!1})=>{a(p=>p.map(m=>{if(m.id===d){const x=typeof f=="function"?f(m):f;return h.replace&&Hc(x)?x:{...m,...x}}return m}))};return{getNodes:()=>t.getState().nodes.map(d=>({...d})),getNode:d=>{var f;return(f=i(d))==null?void 0:f.internals.userNode},getInternalNode:i,getEdges:()=>{const{edges:d=[]}=t.getState();return d.map(f=>({...f}))},getEdge:d=>t.getState().edgeLookup.get(d),setNodes:s,setEdges:a,addNodes:d=>{const f=Array.isArray(d)?d:[d];n.nodeQueue.push(h=>[...h,...f])},addEdges:d=>{const f=Array.isArray(d)?d:[d];n.edgeQueue.push(h=>[...h,...f])},toObject:()=>{const{nodes:d=[],edges:f=[],transform:h}=t.getState(),[p,m,x]=h;return{nodes:d.map(y=>({...y})),edges:f.map(y=>({...y})),viewport:{x:p,y:m,zoom:x}}},deleteElements:async({nodes:d=[],edges:f=[]})=>{const{nodes:h,edges:p,onNodesDelete:m,onEdgesDelete:x,triggerNodeChanges:y,triggerEdgeChanges:N,onDelete:g,onBeforeDelete:b}=t.getState(),{nodes:v,edges:M}=await ta({nodesToRemove:d,edgesToRemove:f,nodes:h,edges:p,onBeforeDelete:b}),C=M.length>0,I=v.length>0;if(C){const T=M.map(rr);x==null||x(M),N(T)}if(I){const T=v.map(rr);m==null||m(v),y(T)}return(I||C)&&(g==null||g({nodes:v,edges:M})),{deletedNodes:v,deletedEdges:M}},getIntersectingNodes:(d,f=!0,h)=>{const p=Tn(d),m=p?d:c(d),x=h!==void 0;return m?(h||t.getState().nodes).filter(y=>{const N=t.getState().nodeLookup.get(y.id);if(N&&!p&&(y.id===d.id||!N.internals.positionAbsolute))return!1;const g=Te(x?y:N),b=qe(g,m);return f&&b>0||b>=m.width*m.height}):[]},isNodeIntersecting:(d,f,h=!0)=>{const m=Tn(d)?d:c(d);if(!m)return!1;const x=qe(m,f);return h&&x>0||x>=m.width*m.height},updateNode:l,updateNodeData:(d,f,h={replace:!1})=>{l(d,p=>{const m=typeof f=="function"?f(p):f;return h.replace?{...p,data:m}:{...p,data:{...p.data,...m}}},h)},updateEdge:u,updateEdgeData:(d,f,h={replace:!1})=>{u(d,p=>{const m=typeof f=="function"?f(p):f;return h.replace?{...p,data:m}:{...p,data:{...p.data,...m}}},h)},getNodesBounds:d=>{const{nodeLookup:f,nodeOrigin:h}=t.getState();return Zs(d,{nodeLookup:f,nodeOrigin:h})},getHandleConnections:({type:d,id:f,nodeId:h})=>{var p;return Array.from(((p=t.getState().connectionLookup.get(`${h}-${d}${f?`-${f}`:""}`))==null?void 0:p.values())??[])},getNodeConnections:({type:d,handleId:f,nodeId:h})=>{var p;return Array.from(((p=t.getState().connectionLookup.get(`${h}${d?f?`-${d}-${f}`:`-${d}`:""}`))==null?void 0:p.values())??[])},fitView:async d=>{const f=t.getState().fitViewResolver??ia();return t.setState({fitViewQueued:!0,fitViewOptions:d,fitViewResolver:f}),n.nodeQueue.push(h=>[...h]),f.promise}}},[]);return L.useMemo(()=>({...o,...e,viewportInitialized:r}),[r])}const sr=e=>e.selected,Wc=typeof window<"u"?window:void 0;function Xc({deleteKeyCode:e,multiSelectionKeyCode:t}){const n=ne(),{deleteElements:r}=yn(),o=Ke(e,{actInsideInputWithModifier:!1}),i=Ke(t,{target:Wc});L.useEffect(()=>{if(o){const{edges:s,nodes:a}=n.getState();r({nodes:a.filter(sr),edges:s.filter(sr)}),n.setState({nodesSelectionActive:!1})}},[o]),L.useEffect(()=>{n.setState({multiSelectionActive:i})},[i])}function qc(e){const t=ne();L.useEffect(()=>{const n=()=>{var o,i;if(!e.current)return!1;const r=fn(e.current);(r.height===0||r.width===0)&&((i=(o=t.getState()).onError)==null||i.call(o,"004",ge.error004())),t.setState({width:r.width||500,height:r.height||500})};if(e.current){n(),window.addEventListener("resize",n);const r=new ResizeObserver(()=>n());return r.observe(e.current),()=>{window.removeEventListener("resize",n),r&&e.current&&r.unobserve(e.current)}}},[])}const Mt={position:"absolute",width:"100%",height:"100%",top:0,left:0},Uc=e=>({userSelectionActive:e.userSelectionActive,lib:e.lib});function Kc({onPaneContextMenu:e,zoomOnScroll:t=!0,zoomOnPinch:n=!0,panOnScroll:r=!1,panOnScrollSpeed:o=.5,panOnScrollMode:i=_e.Free,zoomOnDoubleClick:s=!0,panOnDrag:a=!0,defaultViewport:c,translateExtent:l,minZoom:u,maxZoom:d,zoomActivationKeyCode:f,preventScrolling:h=!0,children:p,noWheelClassName:m,noPanClassName:x,onViewportChange:y,isControlledViewport:N,paneClickDistance:g}){const b=ne(),v=L.useRef(null),{userSelectionActive:M,lib:C}=J(Uc,re),I=Ke(f),T=L.useRef();qc(v);const z=L.useCallback(P=>{y==null||y({x:P[0],y:P[1],zoom:P[2]}),N||b.setState({transform:P})},[y,N]);return L.useEffect(()=>{if(v.current){T.current=Ha({domNode:v.current,minZoom:u,maxZoom:d,translateExtent:l,viewport:c,paneClickDistance:g,onDraggingChange:w=>b.setState({paneDragging:w}),onPanZoomStart:(w,S)=>{const{onViewportChangeStart:E,onMoveStart:_}=b.getState();_==null||_(w,S),E==null||E(S)},onPanZoom:(w,S)=>{const{onViewportChange:E,onMove:_}=b.getState();_==null||_(w,S),E==null||E(S)},onPanZoomEnd:(w,S)=>{const{onViewportChangeEnd:E,onMoveEnd:_}=b.getState();_==null||_(w,S),E==null||E(S)}});const{x:P,y:D,zoom:A}=T.current.getViewport();return b.setState({panZoom:T.current,transform:[P,D,A],domNode:v.current.closest(".react-flow")}),()=>{var w;(w=T.current)==null||w.destroy()}}},[]),L.useEffect(()=>{var P;(P=T.current)==null||P.update({onPaneContextMenu:e,zoomOnScroll:t,zoomOnPinch:n,panOnScroll:r,panOnScrollSpeed:o,panOnScrollMode:i,zoomOnDoubleClick:s,panOnDrag:a,zoomActivationKeyPressed:I,preventScrolling:h,noPanClassName:x,userSelectionActive:M,noWheelClassName:m,lib:C,onTransformChange:z})},[e,t,n,r,o,i,s,a,I,h,x,M,m,C,z]),$.jsx("div",{className:"react-flow__renderer",ref:v,style:Mt,children:p})}const Zc=e=>({userSelectionActive:e.userSelectionActive,userSelectionRect:e.userSelectionRect});function Qc(){const{userSelectionActive:e,userSelectionRect:t}=J(Zc,re);return e&&t?$.jsx("div",{className:"react-flow__selection react-flow__container",style:{width:t.width,height:t.height,transform:`translate(${t.x}px, ${t.y}px)`}}):null}const Yt=(e,t)=>n=>{n.target===t.current&&(e==null||e(n))},Jc=e=>({userSelectionActive:e.userSelectionActive,elementsSelectable:e.elementsSelectable,connectionInProgress:e.connection.inProgress,dragging:e.paneDragging});function el({isSelecting:e,selectionKeyPressed:t,selectionMode:n=Xe.Full,panOnDrag:r,selectionOnDrag:o,onSelectionStart:i,onSelectionEnd:s,onPaneClick:a,onPaneContextMenu:c,onPaneScroll:l,onPaneMouseEnter:u,onPaneMouseMove:d,onPaneMouseLeave:f,children:h}){const p=ne(),{userSelectionActive:m,elementsSelectable:x,dragging:y,connectionInProgress:N}=J(Jc,re),g=x&&(e||m),b=L.useRef(null),v=L.useRef(),M=L.useRef(new Set),C=L.useRef(new Set),I=L.useRef(!1),T=L.useRef(!1),z=_=>{if(I.current||N){I.current=!1;return}a==null||a(_),p.getState().resetSelectedElements(),p.setState({nodesSelectionActive:!1})},P=_=>{if(Array.isArray(r)&&(r!=null&&r.includes(2))){_.preventDefault();return}c==null||c(_)},D=l?_=>l(_):void 0,A=_=>{var H,F;const{resetSelectedElements:O,domNode:k}=p.getState();if(v.current=k==null?void 0:k.getBoundingClientRect(),!x||!e||_.button!==0||_.target!==b.current||!v.current)return;(F=(H=_.target)==null?void 0:H.setPointerCapture)==null||F.call(H,_.pointerId),T.current=!0,I.current=!1;const{x:j,y:R}=he(_.nativeEvent,v.current);O(),p.setState({userSelectionRect:{width:0,height:0,startX:j,startY:R,x:j,y:R}}),i==null||i(_)},w=_=>{const{userSelectionRect:O,transform:k,nodeLookup:j,edgeLookup:R,connectionLookup:H,triggerNodeChanges:F,triggerEdgeChanges:V,defaultEdgeOptions:G}=p.getState();if(!v.current||!O)return;I.current=!0;const{x:X,y:Y}=he(_.nativeEvent,v.current),{startX:B,startY:q}=O,ee={startX:B,startY:q,x:X<B?X:B,y:Y<q?Y:q,width:Math.abs(X-B),height:Math.abs(Y-q)},Q=M.current,U=C.current;M.current=new Set(un(j,ee,k,n===Xe.Partial,!0).map(K=>K.id)),C.current=new Set;const Z=(G==null?void 0:G.selectable)??!0;for(const K of M.current){const te=H.get(K);if(te)for(const{edgeId:oe}of te.values()){const pe=R.get(oe);pe&&(pe.selectable??Z)&&C.current.add(oe)}}if(!An(Q,M.current)){const K=Le(j,M.current,!0);F(K)}if(!An(U,C.current)){const K=Le(R,C.current);V(K)}p.setState({userSelectionRect:ee,userSelectionActive:!0,nodesSelectionActive:!1})},S=_=>{var k,j;if(_.button!==0||!T.current)return;(j=(k=_.target)==null?void 0:k.releasePointerCapture)==null||j.call(k,_.pointerId);const{userSelectionRect:O}=p.getState();!m&&O&&_.target===b.current&&(z==null||z(_)),p.setState({userSelectionActive:!1,userSelectionRect:null,nodesSelectionActive:M.current.size>0}),s==null||s(_),(t||o)&&(I.current=!1),T.current=!1},E=r===!0||Array.isArray(r)&&r.includes(0);return $.jsxs("div",{className:ae(["react-flow__pane",{draggable:E,dragging:y,selection:e}]),onClick:g?void 0:Yt(z,b),onContextMenu:Yt(P,b),onWheel:Yt(D,b),onPointerEnter:g?void 0:u,onPointerDown:g?A:d,onPointerMove:g?w:d,onPointerUp:g?S:void 0,onPointerLeave:f,ref:b,style:Mt,children:[h,$.jsx(Qc,{})]})}function on({id:e,store:t,unselect:n=!1,nodeRef:r}){const{addSelectedNodes:o,unselectNodesAndEdges:i,multiSelectionActive:s,nodeLookup:a,onError:c}=t.getState(),l=a.get(e);if(!l){c==null||c("012",ge.error012(e));return}t.setState({nodesSelectionActive:!1}),l.selected?(n||l.selected&&s)&&(i({nodes:[l],edges:[]}),requestAnimationFrame(()=>{var u;return(u=r==null?void 0:r.current)==null?void 0:u.blur()})):o([e])}function Po({nodeRef:e,disabled:t=!1,noDragClassName:n,handleSelector:r,nodeId:o,isSelectable:i,nodeClickDistance:s}){const a=ne(),[c,l]=L.useState(!1),u=L.useRef();return L.useEffect(()=>{u.current=Sa({getStoreItems:()=>a.getState(),onNodeMouseDown:d=>{on({id:d,store:a,nodeRef:e})},onDragStart:()=>{l(!0)},onDragStop:()=>{l(!1)}})},[]),L.useEffect(()=>{var d,f;if(t)(d=u.current)==null||d.destroy();else if(e.current)return(f=u.current)==null||f.update({noDragClassName:n,handleSelector:r,domNode:e.current,isSelectable:i,nodeId:o,nodeClickDistance:s}),()=>{var h;(h=u.current)==null||h.destroy()}},[n,r,t,i,e,o]),c}const tl=e=>t=>t.selected&&(t.draggable||e&&typeof t.draggable>"u");function Oo(){const e=ne();return L.useCallback(n=>{const{nodeExtent:r,snapToGrid:o,snapGrid:i,nodesDraggable:s,onError:a,updateNodePositions:c,nodeLookup:l,nodeOrigin:u}=e.getState(),d=new Map,f=tl(s),h=o?i[0]:5,p=o?i[1]:5,m=n.direction.x*h*n.factor,x=n.direction.y*p*n.factor;for(const[,y]of l){if(!f(y))continue;let N={x:y.internals.positionAbsolute.x+m,y:y.internals.positionAbsolute.y+x};o&&(N=Nt(N,i));const{position:g,positionAbsolute:b}=qr({nodeId:y.id,nextPosition:N,nodeLookup:l,nodeExtent:r,nodeOrigin:u,onError:a});y.position=g,y.internals.positionAbsolute=b,d.set(y.id,y)}c(d)},[])}const wn=L.createContext(null),nl=wn.Provider;wn.Consumer;const jo=()=>L.useContext(wn),rl=e=>({connectOnClick:e.connectOnClick,noPanClassName:e.noPanClassName,rfId:e.rfId}),ol=(e,t,n)=>r=>{const{connectionClickStartHandle:o,connectionMode:i,connection:s}=r,{fromHandle:a,toHandle:c,isValid:l}=s,u=(c==null?void 0:c.nodeId)===e&&(c==null?void 0:c.id)===t&&(c==null?void 0:c.type)===n;return{connectingFrom:(a==null?void 0:a.nodeId)===e&&(a==null?void 0:a.id)===t&&(a==null?void 0:a.type)===n,connectingTo:u,clickConnecting:(o==null?void 0:o.nodeId)===e&&(o==null?void 0:o.id)===t&&(o==null?void 0:o.type)===n,isPossibleEndHandle:i===Oe.Strict?(a==null?void 0:a.type)!==n:e!==(a==null?void 0:a.nodeId)||t!==(a==null?void 0:a.id),connectionInProcess:!!a,clickConnectionInProcess:!!o,valid:u&&l}};function il({type:e="source",position:t=W.Top,isValidConnection:n,isConnectable:r=!0,isConnectableStart:o=!0,isConnectableEnd:i=!0,id:s,onConnect:a,children:c,className:l,onMouseDown:u,onTouchStart:d,...f},h){var S,E;const p=s||null,m=e==="target",x=ne(),y=jo(),{connectOnClick:N,noPanClassName:g,rfId:b}=J(rl,re),{connectingFrom:v,connectingTo:M,clickConnecting:C,isPossibleEndHandle:I,connectionInProcess:T,clickConnectionInProcess:z,valid:P}=J(ol(y,p,e),re);y||(E=(S=x.getState()).onError)==null||E.call(S,"010",ge.error010());const D=_=>{const{defaultEdgeOptions:O,onConnect:k,hasDefaultEdges:j}=x.getState(),R={...O,..._};if(j){const{edges:H,setEdges:F}=x.getState();F(fa(R,H))}k==null||k(R),a==null||a(R)},A=_=>{if(!y)return;const O=no(_.nativeEvent);if(o&&(O&&_.button===0||!O)){const k=x.getState();rn.onPointerDown(_.nativeEvent,{autoPanOnConnect:k.autoPanOnConnect,connectionMode:k.connectionMode,connectionRadius:k.connectionRadius,domNode:k.domNode,nodeLookup:k.nodeLookup,lib:k.lib,isTarget:m,handleId:p,nodeId:y,flowId:k.rfId,panBy:k.panBy,cancelConnection:k.cancelConnection,onConnectStart:k.onConnectStart,onConnectEnd:k.onConnectEnd,updateConnection:k.updateConnection,onConnect:D,isValidConnection:n||k.isValidConnection,getTransform:()=>x.getState().transform,getFromHandle:()=>x.getState().connection.fromHandle,autoPanSpeed:k.autoPanSpeed,dragThreshold:k.connectionDragThreshold})}O?u==null||u(_):d==null||d(_)},w=_=>{const{onClickConnectStart:O,onClickConnectEnd:k,connectionClickStartHandle:j,connectionMode:R,isValidConnection:H,lib:F,rfId:V,nodeLookup:G,connection:X}=x.getState();if(!y||!j&&!o)return;if(!j){O==null||O(_.nativeEvent,{nodeId:y,handleId:p,handleType:e}),x.setState({connectionClickStartHandle:{nodeId:y,type:e,id:p}});return}const Y=eo(_.target),B=n||H,{connection:q,isValid:ee}=rn.isValid(_.nativeEvent,{handle:{nodeId:y,id:p,type:e},connectionMode:R,fromNodeId:j.nodeId,fromHandleId:j.id||null,fromType:j.type,isValidConnection:B,flowId:V,doc:Y,lib:F,nodeLookup:G});ee&&q&&D(q);const Q=structuredClone(X);delete Q.inProgress,Q.toPosition=Q.toHandle?Q.toHandle.position:null,k==null||k(_,Q),x.setState({connectionClickStartHandle:null})};return $.jsx("div",{"data-handleid":p,"data-nodeid":y,"data-handlepos":t,"data-id":`${b}-${y}-${p}-${e}`,className:ae(["react-flow__handle",`react-flow__handle-${t}`,"nodrag",g,l,{source:!m,target:m,connectable:r,connectablestart:o,connectableend:i,clickconnecting:C,connectingfrom:v,connectingto:M,valid:P,connectionindicator:r&&(!T||I)&&(T||z?i:o)}]),onMouseDown:A,onTouchStart:A,onClick:N?w:void 0,ref:h,...f,children:c})}const yt=L.memo($o(il));function sl({data:e,isConnectable:t,sourcePosition:n=W.Bottom}){return $.jsxs($.Fragment,{children:[e==null?void 0:e.label,$.jsx(yt,{type:"source",position:n,isConnectable:t})]})}function al({data:e,isConnectable:t,targetPosition:n=W.Top,sourcePosition:r=W.Bottom}){return $.jsxs($.Fragment,{children:[$.jsx(yt,{type:"target",position:n,isConnectable:t}),e==null?void 0:e.label,$.jsx(yt,{type:"source",position:r,isConnectable:t})]})}function cl(){return null}function ll({data:e,isConnectable:t,targetPosition:n=W.Top}){return $.jsxs($.Fragment,{children:[$.jsx(yt,{type:"target",position:n,isConnectable:t}),e==null?void 0:e.label]})}const wt={ArrowUp:{x:0,y:-1},ArrowDown:{x:0,y:1},ArrowLeft:{x:-1,y:0},ArrowRight:{x:1,y:0}},ar={input:sl,default:al,output:ll,group:cl};function ul(e){var t,n,r,o;return e.internals.handleBounds===void 0?{width:e.width??e.initialWidth??((t=e.style)==null?void 0:t.width),height:e.height??e.initialHeight??((n=e.style)==null?void 0:n.height)}:{width:e.width??((r=e.style)==null?void 0:r.width),height:e.height??((o=e.style)==null?void 0:o.height)}}const dl=e=>{const{width:t,height:n,x:r,y:o}=Qe(e.nodeLookup,{filter:i=>!!i.selected});return{width:de(t)?t:null,height:de(n)?n:null,userSelectionActive:e.userSelectionActive,transformString:`translate(${e.transform[0]}px,${e.transform[1]}px) scale(${e.transform[2]}) translate(${r}px,${o}px)`}};function fl({onSelectionContextMenu:e,noPanClassName:t,disableKeyboardA11y:n}){const r=ne(),{width:o,height:i,transformString:s,userSelectionActive:a}=J(dl,re),c=Oo(),l=L.useRef(null);if(L.useEffect(()=>{var f;n||(f=l.current)==null||f.focus({preventScroll:!0})},[n]),Po({nodeRef:l}),a||!o||!i)return null;const u=e?f=>{const h=r.getState().nodes.filter(p=>p.selected);e(f,h)}:void 0,d=f=>{Object.prototype.hasOwnProperty.call(wt,f.key)&&(f.preventDefault(),c({direction:wt[f.key],factor:f.shiftKey?4:1}))};return $.jsx("div",{className:ae(["react-flow__nodesselection","react-flow__container",t]),style:{transform:s},children:$.jsx("div",{ref:l,className:"react-flow__nodesselection-rect",onContextMenu:u,tabIndex:n?void 0:-1,onKeyDown:n?void 0:d,style:{width:o,height:i}})})}const cr=typeof window<"u"?window:void 0,hl=e=>({nodesSelectionActive:e.nodesSelectionActive,userSelectionActive:e.userSelectionActive});function To({children:e,onPaneClick:t,onPaneMouseEnter:n,onPaneMouseMove:r,onPaneMouseLeave:o,onPaneContextMenu:i,onPaneScroll:s,paneClickDistance:a,deleteKeyCode:c,selectionKeyCode:l,selectionOnDrag:u,selectionMode:d,onSelectionStart:f,onSelectionEnd:h,multiSelectionKeyCode:p,panActivationKeyCode:m,zoomActivationKeyCode:x,elementsSelectable:y,zoomOnScroll:N,zoomOnPinch:g,panOnScroll:b,panOnScrollSpeed:v,panOnScrollMode:M,zoomOnDoubleClick:C,panOnDrag:I,defaultViewport:T,translateExtent:z,minZoom:P,maxZoom:D,preventScrolling:A,onSelectionContextMenu:w,noWheelClassName:S,noPanClassName:E,disableKeyboardA11y:_,onViewportChange:O,isControlledViewport:k}){const{nodesSelectionActive:j,userSelectionActive:R}=J(hl),H=Ke(l,{target:cr}),F=Ke(m,{target:cr}),V=F||I,G=F||b,X=u&&V!==!0,Y=H||R||X;return Xc({deleteKeyCode:c,multiSelectionKeyCode:p}),$.jsx(Kc,{onPaneContextMenu:i,elementsSelectable:y,zoomOnScroll:N,zoomOnPinch:g,panOnScroll:G,panOnScrollSpeed:v,panOnScrollMode:M,zoomOnDoubleClick:C,panOnDrag:!H&&V,defaultViewport:T,translateExtent:z,minZoom:P,maxZoom:D,zoomActivationKeyCode:x,preventScrolling:A,noWheelClassName:S,noPanClassName:E,onViewportChange:O,isControlledViewport:k,paneClickDistance:a,children:$.jsxs(el,{onSelectionStart:f,onSelectionEnd:h,onPaneClick:t,onPaneMouseEnter:n,onPaneMouseMove:r,onPaneMouseLeave:o,onPaneContextMenu:i,onPaneScroll:s,panOnDrag:V,isSelecting:!!Y,selectionMode:d,selectionKeyPressed:H,selectionOnDrag:X,children:[e,j&&$.jsx(fl,{onSelectionContextMenu:w,noPanClassName:E,disableKeyboardA11y:_})]})})}To.displayName="FlowRenderer";const gl=L.memo(To),pl=e=>t=>e?un(t.nodeLookup,{x:0,y:0,width:t.width,height:t.height},t.transform,!0).map(n=>n.id):Array.from(t.nodeLookup.keys());function ml(e){return J(L.useCallback(pl(e),[e]),re)}const yl=e=>e.updateNodeInternals;function wl(){const e=J(yl),[t]=L.useState(()=>typeof ResizeObserver>"u"?null:new ResizeObserver(n=>{const r=new Map;n.forEach(o=>{const i=o.target.getAttribute("data-id");r.set(i,{id:i,nodeElement:o.target,force:!0})}),e(r)}));return L.useEffect(()=>()=>{t==null||t.disconnect()},[t]),t}function xl({node:e,nodeType:t,hasDimensions:n,resizeObserver:r}){const o=ne(),i=L.useRef(null),s=L.useRef(null),a=L.useRef(e.sourcePosition),c=L.useRef(e.targetPosition),l=L.useRef(t),u=n&&!!e.internals.handleBounds;return L.useEffect(()=>{i.current&&!e.hidden&&(!u||s.current!==i.current)&&(s.current&&(r==null||r.unobserve(s.current)),r==null||r.observe(i.current),s.current=i.current)},[u,e.hidden]),L.useEffect(()=>()=>{s.current&&(r==null||r.unobserve(s.current),s.current=null)},[]),L.useEffect(()=>{if(i.current){const d=l.current!==t,f=a.current!==e.sourcePosition,h=c.current!==e.targetPosition;(d||f||h)&&(l.current=t,a.current=e.sourcePosition,c.current=e.targetPosition,o.getState().updateNodeInternals(new Map([[e.id,{id:e.id,nodeElement:i.current,force:!0}]])))}},[e.id,t,e.sourcePosition,e.targetPosition]),i}function bl({id:e,onClick:t,onMouseEnter:n,onMouseMove:r,onMouseLeave:o,onContextMenu:i,onDoubleClick:s,nodesDraggable:a,elementsSelectable:c,nodesConnectable:l,nodesFocusable:u,resizeObserver:d,noDragClassName:f,noPanClassName:h,disableKeyboardA11y:p,rfId:m,nodeTypes:x,nodeClickDistance:y,onError:N}){const{node:g,internals:b,isParent:v}=J(B=>{const q=B.nodeLookup.get(e),ee=B.parentLookup.has(e);return{node:q,internals:q.internals,isParent:ee}},re);let M=g.type||"default",C=(x==null?void 0:x[M])||ar[M];C===void 0&&(N==null||N("003",ge.error003(M)),M="default",C=ar.default);const I=!!(g.draggable||a&&typeof g.draggable>"u"),T=!!(g.selectable||c&&typeof g.selectable>"u"),z=!!(g.connectable||l&&typeof g.connectable>"u"),P=!!(g.focusable||u&&typeof g.focusable>"u"),D=ne(),A=Qr(g),w=xl({node:g,nodeType:M,hasDimensions:A,resizeObserver:d}),S=Po({nodeRef:w,disabled:g.hidden||!I,noDragClassName:f,handleSelector:g.dragHandle,nodeId:e,isSelectable:T,nodeClickDistance:y}),E=Oo();if(g.hidden)return null;const _=ye(g),O=ul(g),k=T||I||t||n||r||o,j=n?B=>n(B,{...b.userNode}):void 0,R=r?B=>r(B,{...b.userNode}):void 0,H=o?B=>o(B,{...b.userNode}):void 0,F=i?B=>i(B,{...b.userNode}):void 0,V=s?B=>s(B,{...b.userNode}):void 0,G=B=>{const{selectNodesOnDrag:q,nodeDragThreshold:ee}=D.getState();T&&(!q||!I||ee>0)&&on({id:e,store:D,nodeRef:w}),t&&t(B,{...b.userNode})},X=B=>{if(!(to(B.nativeEvent)||p)){if(Fr.includes(B.key)&&T){const q=B.key==="Escape";on({id:e,store:D,unselect:q,nodeRef:w})}else if(I&&g.selected&&Object.prototype.hasOwnProperty.call(wt,B.key)){B.preventDefault();const{ariaLabelConfig:q}=D.getState();D.setState({ariaLiveMessage:q["node.a11yDescription.ariaLiveMessage"]({direction:B.key.replace("Arrow","").toLowerCase(),x:~~b.positionAbsolute.x,y:~~b.positionAbsolute.y})}),E({direction:wt[B.key],factor:B.shiftKey?4:1})}}},Y=()=>{var K;if(p||!((K=w.current)!=null&&K.matches(":focus-visible")))return;const{transform:B,width:q,height:ee,autoPanOnNodeFocus:Q,setCenter:U}=D.getState();if(!Q)return;un(new Map([[e,g]]),{x:0,y:0,width:q,height:ee},B,!0).length>0||U(g.position.x+_.width/2,g.position.y+_.height/2,{zoom:B[2]})};return $.jsx("div",{className:ae(["react-flow__node",`react-flow__node-${M}`,{[h]:I},g.className,{selected:g.selected,selectable:T,parent:v,draggable:I,dragging:S}]),ref:w,style:{zIndex:b.z,transform:`translate(${b.positionAbsolute.x}px,${b.positionAbsolute.y}px)`,pointerEvents:k?"all":"none",visibility:A?"visible":"hidden",...g.style,...O},"data-id":e,"data-testid":`rf__node-${e}`,onMouseEnter:j,onMouseMove:R,onMouseLeave:H,onContextMenu:F,onClick:G,onDoubleClick:V,onKeyDown:P?X:void 0,tabIndex:P?0:void 0,onFocus:P?Y:void 0,role:g.ariaRole??(P?"group":void 0),"aria-roledescription":"node","aria-describedby":p?void 0:`${_o}-${m}`,"aria-label":g.ariaLabel,...g.domAttributes,children:$.jsx(nl,{value:e,children:$.jsx(C,{id:e,data:g.data,type:M,positionAbsoluteX:b.positionAbsolute.x,positionAbsoluteY:b.positionAbsolute.y,selected:g.selected??!1,selectable:T,draggable:I,deletable:g.deletable??!0,isConnectable:z,sourcePosition:g.sourcePosition,targetPosition:g.targetPosition,dragging:S,dragHandle:g.dragHandle,zIndex:b.z,parentId:g.parentId,..._})})})}const vl=e=>({nodesDraggable:e.nodesDraggable,nodesConnectable:e.nodesConnectable,nodesFocusable:e.nodesFocusable,elementsSelectable:e.elementsSelectable,onError:e.onError});function Ao(e){const{nodesDraggable:t,nodesConnectable:n,nodesFocusable:r,elementsSelectable:o,onError:i}=J(vl,re),s=ml(e.onlyRenderVisibleElements),a=wl();return $.jsx("div",{className:"react-flow__nodes",style:Mt,children:s.map(c=>$.jsx(bl,{id:c,nodeTypes:e.nodeTypes,nodeExtent:e.nodeExtent,onClick:e.onNodeClick,onMouseEnter:e.onNodeMouseEnter,onMouseMove:e.onNodeMouseMove,onMouseLeave:e.onNodeMouseLeave,onContextMenu:e.onNodeContextMenu,onDoubleClick:e.onNodeDoubleClick,noDragClassName:e.noDragClassName,noPanClassName:e.noPanClassName,rfId:e.rfId,disableKeyboardA11y:e.disableKeyboardA11y,resizeObserver:a,nodesDraggable:t,nodesConnectable:n,nodesFocusable:r,elementsSelectable:o,nodeClickDistance:e.nodeClickDistance,onError:i},c))})}Ao.displayName="NodeRenderer";const El=L.memo(Ao);function Nl(e){return J(L.useCallback(n=>{if(!e)return n.edges.map(o=>o.id);const r=[];if(n.width&&n.height)for(const o of n.edges){const i=n.nodeLookup.get(o.source),s=n.nodeLookup.get(o.target);i&&s&&la({sourceNode:i,targetNode:s,width:n.width,height:n.height,transform:n.transform})&&r.push(o.id)}return r},[e]),re)}const _l=({color:e="none",strokeWidth:t=1})=>$.jsx("polyline",{style:{stroke:e,strokeWidth:t},strokeLinecap:"round",strokeLinejoin:"round",fill:"none",points:"-5,-4 0,0 -5,4"}),Sl=({color:e="none",strokeWidth:t=1})=>$.jsx("polyline",{style:{stroke:e,fill:e,strokeWidth:t},strokeLinecap:"round",strokeLinejoin:"round",points:"-5,-4 0,0 -5,4 -5,-4"}),lr={[ht.Arrow]:_l,[ht.ArrowClosed]:Sl};function kl(e){const t=ne();return L.useMemo(()=>{var o,i;return Object.prototype.hasOwnProperty.call(lr,e)?lr[e]:((i=(o=t.getState()).onError)==null||i.call(o,"009",ge.error009(e)),null)},[e])}const Cl=({id:e,type:t,color:n,width:r=12.5,height:o=12.5,markerUnits:i="strokeWidth",strokeWidth:s,orient:a="auto-start-reverse"})=>{const c=kl(t);return c?$.jsx("marker",{className:"react-flow__arrowhead",id:e,markerWidth:`${r}`,markerHeight:`${o}`,viewBox:"-10 -10 20 20",markerUnits:i,orient:a,refX:"0",refY:"0",children:$.jsx(c,{color:n,strokeWidth:s})}):null},Do=({defaultColor:e,rfId:t})=>{const n=J(i=>i.edges),r=J(i=>i.defaultEdgeOptions),o=L.useMemo(()=>ya(n,{id:t,defaultColor:e,defaultMarkerStart:r==null?void 0:r.markerStart,defaultMarkerEnd:r==null?void 0:r.markerEnd}),[n,r,t,e]);return o.length?$.jsx("svg",{className:"react-flow__marker","aria-hidden":"true",children:$.jsx("defs",{children:o.map(i=>$.jsx(Cl,{id:i.id,type:i.type,color:i.color,width:i.width,height:i.height,markerUnits:i.markerUnits,strokeWidth:i.strokeWidth,orient:i.orient},i.id))})}):null};Do.displayName="MarkerDefinitions";var Ml=L.memo(Do);function Ro({x:e,y:t,label:n,labelStyle:r,labelShowBg:o=!0,labelBgStyle:i,labelBgPadding:s=[2,4],labelBgBorderRadius:a=2,children:c,className:l,...u}){const[d,f]=L.useState({x:1,y:0,width:0,height:0}),h=ae(["react-flow__edge-textwrapper",l]),p=L.useRef(null);return L.useEffect(()=>{if(p.current){const m=p.current.getBBox();f({x:m.x,y:m.y,width:m.width,height:m.height})}},[n]),n?$.jsxs("g",{transform:`translate(${e-d.width/2} ${t-d.height/2})`,className:h,visibility:d.width?"visible":"hidden",...u,children:[o&&$.jsx("rect",{width:d.width+2*s[0],x:-s[0],y:-s[1],height:d.height+2*s[1],className:"react-flow__edge-textbg",style:i,rx:a,ry:a}),$.jsx("text",{className:"react-flow__edge-text",y:d.height/2,dy:"0.3em",ref:p,style:r,children:n}),c]}):null}Ro.displayName="EdgeText";const Il=L.memo(Ro);function It({path:e,labelX:t,labelY:n,label:r,labelStyle:o,labelShowBg:i,labelBgStyle:s,labelBgPadding:a,labelBgBorderRadius:c,interactionWidth:l=20,...u}){return $.jsxs($.Fragment,{children:[$.jsx("path",{...u,d:e,fill:"none",className:ae(["react-flow__edge-path",u.className])}),l&&$.jsx("path",{d:e,fill:"none",strokeOpacity:0,strokeWidth:l,className:"react-flow__edge-interaction"}),r&&de(t)&&de(n)?$.jsx(Il,{x:t,y:n,label:r,labelStyle:o,labelShowBg:i,labelBgStyle:s,labelBgPadding:a,labelBgBorderRadius:c}):null]})}function ur({pos:e,x1:t,y1:n,x2:r,y2:o}){return e===W.Left||e===W.Right?[.5*(t+r),n]:[t,.5*(n+o)]}function zo({sourceX:e,sourceY:t,sourcePosition:n=W.Bottom,targetX:r,targetY:o,targetPosition:i=W.Top}){const[s,a]=ur({pos:n,x1:e,y1:t,x2:r,y2:o}),[c,l]=ur({pos:i,x1:r,y1:o,x2:e,y2:t}),[u,d,f,h]=ro({sourceX:e,sourceY:t,targetX:r,targetY:o,sourceControlX:s,sourceControlY:a,targetControlX:c,targetControlY:l});return[`M${e},${t} C${s},${a} ${c},${l} ${r},${o}`,u,d,f,h]}function Ho(e){return L.memo(({id:t,sourceX:n,sourceY:r,targetX:o,targetY:i,sourcePosition:s,targetPosition:a,label:c,labelStyle:l,labelShowBg:u,labelBgStyle:d,labelBgPadding:f,labelBgBorderRadius:h,style:p,markerEnd:m,markerStart:x,interactionWidth:y})=>{const[N,g,b]=zo({sourceX:n,sourceY:r,sourcePosition:s,targetX:o,targetY:i,targetPosition:a}),v=e.isInternal?void 0:t;return $.jsx(It,{id:v,path:N,labelX:g,labelY:b,label:c,labelStyle:l,labelShowBg:u,labelBgStyle:d,labelBgPadding:f,labelBgBorderRadius:h,style:p,markerEnd:m,markerStart:x,interactionWidth:y})})}const $l=Ho({isInternal:!1}),Vo=Ho({isInternal:!0});$l.displayName="SimpleBezierEdge";Vo.displayName="SimpleBezierEdgeInternal";function Bo(e){return L.memo(({id:t,sourceX:n,sourceY:r,targetX:o,targetY:i,label:s,labelStyle:a,labelShowBg:c,labelBgStyle:l,labelBgPadding:u,labelBgBorderRadius:d,style:f,sourcePosition:h=W.Bottom,targetPosition:p=W.Top,markerEnd:m,markerStart:x,pathOptions:y,interactionWidth:N})=>{const[g,b,v]=en({sourceX:n,sourceY:r,sourcePosition:h,targetX:o,targetY:i,targetPosition:p,borderRadius:y==null?void 0:y.borderRadius,offset:y==null?void 0:y.offset}),M=e.isInternal?void 0:t;return $.jsx(It,{id:M,path:g,labelX:b,labelY:v,label:s,labelStyle:a,labelShowBg:c,labelBgStyle:l,labelBgPadding:u,labelBgBorderRadius:d,style:f,markerEnd:m,markerStart:x,interactionWidth:N})})}const Fo=Bo({isInternal:!1}),Yo=Bo({isInternal:!0});Fo.displayName="SmoothStepEdge";Yo.displayName="SmoothStepEdgeInternal";function Go(e){return L.memo(({id:t,...n})=>{var o;const r=e.isInternal?void 0:t;return $.jsx(Fo,{...n,id:r,pathOptions:L.useMemo(()=>{var i;return{borderRadius:0,offset:(i=n.pathOptions)==null?void 0:i.offset}},[(o=n.pathOptions)==null?void 0:o.offset])})})}const Ll=Go({isInternal:!1}),Wo=Go({isInternal:!0});Ll.displayName="StepEdge";Wo.displayName="StepEdgeInternal";function Xo(e){return L.memo(({id:t,sourceX:n,sourceY:r,targetX:o,targetY:i,label:s,labelStyle:a,labelShowBg:c,labelBgStyle:l,labelBgPadding:u,labelBgBorderRadius:d,style:f,markerEnd:h,markerStart:p,interactionWidth:m})=>{const[x,y,N]=so({sourceX:n,sourceY:r,targetX:o,targetY:i}),g=e.isInternal?void 0:t;return $.jsx(It,{id:g,path:x,labelX:y,labelY:N,label:s,labelStyle:a,labelShowBg:c,labelBgStyle:l,labelBgPadding:u,labelBgBorderRadius:d,style:f,markerEnd:h,markerStart:p,interactionWidth:m})})}const Pl=Xo({isInternal:!1}),qo=Xo({isInternal:!0});Pl.displayName="StraightEdge";qo.displayName="StraightEdgeInternal";function Uo(e){return L.memo(({id:t,sourceX:n,sourceY:r,targetX:o,targetY:i,sourcePosition:s=W.Bottom,targetPosition:a=W.Top,label:c,labelStyle:l,labelShowBg:u,labelBgStyle:d,labelBgPadding:f,labelBgBorderRadius:h,style:p,markerEnd:m,markerStart:x,pathOptions:y,interactionWidth:N})=>{const[g,b,v]=oo({sourceX:n,sourceY:r,sourcePosition:s,targetX:o,targetY:i,targetPosition:a,curvature:y==null?void 0:y.curvature}),M=e.isInternal?void 0:t;return $.jsx(It,{id:M,path:g,labelX:b,labelY:v,label:c,labelStyle:l,labelShowBg:u,labelBgStyle:d,labelBgPadding:f,labelBgBorderRadius:h,style:p,markerEnd:m,markerStart:x,interactionWidth:N})})}const Ol=Uo({isInternal:!1}),Ko=Uo({isInternal:!0});Ol.displayName="BezierEdge";Ko.displayName="BezierEdgeInternal";const dr={default:Ko,straight:qo,step:Wo,smoothstep:Yo,simplebezier:Vo},fr={sourceX:null,sourceY:null,targetX:null,targetY:null,sourcePosition:null,targetPosition:null},jl=(e,t,n)=>n===W.Left?e-t:n===W.Right?e+t:e,Tl=(e,t,n)=>n===W.Top?e-t:n===W.Bottom?e+t:e,hr="react-flow__edgeupdater";function gr({position:e,centerX:t,centerY:n,radius:r=10,onMouseDown:o,onMouseEnter:i,onMouseOut:s,type:a}){return $.jsx("circle",{onMouseDown:o,onMouseEnter:i,onMouseOut:s,className:ae([hr,`${hr}-${a}`]),cx:jl(t,r,e),cy:Tl(n,r,e),r,stroke:"transparent",fill:"transparent"})}function Al({isReconnectable:e,reconnectRadius:t,edge:n,sourceX:r,sourceY:o,targetX:i,targetY:s,sourcePosition:a,targetPosition:c,onReconnect:l,onReconnectStart:u,onReconnectEnd:d,setReconnecting:f,setUpdateHover:h}){const p=ne(),m=(b,v)=>{if(b.button!==0)return;const{autoPanOnConnect:M,domNode:C,isValidConnection:I,connectionMode:T,connectionRadius:z,lib:P,onConnectStart:D,onConnectEnd:A,cancelConnection:w,nodeLookup:S,rfId:E,panBy:_,updateConnection:O}=p.getState(),k=v.type==="target",j=(F,V)=>{f(!1),d==null||d(F,n,v.type,V)},R=F=>l==null?void 0:l(n,F),H=(F,V)=>{f(!0),u==null||u(b,n,v.type),D==null||D(F,V)};rn.onPointerDown(b.nativeEvent,{autoPanOnConnect:M,connectionMode:T,connectionRadius:z,domNode:C,handleId:v.id,nodeId:v.nodeId,nodeLookup:S,isTarget:k,edgeUpdaterType:v.type,lib:P,flowId:E,cancelConnection:w,panBy:_,isValidConnection:I,onConnect:R,onConnectStart:H,onConnectEnd:A,onReconnectEnd:j,updateConnection:O,getTransform:()=>p.getState().transform,getFromHandle:()=>p.getState().connection.fromHandle,dragThreshold:p.getState().connectionDragThreshold})},x=b=>m(b,{nodeId:n.target,id:n.targetHandle??null,type:"target"}),y=b=>m(b,{nodeId:n.source,id:n.sourceHandle??null,type:"source"}),N=()=>h(!0),g=()=>h(!1);return $.jsxs($.Fragment,{children:[(e===!0||e==="source")&&$.jsx(gr,{position:a,centerX:r,centerY:o,radius:t,onMouseDown:x,onMouseEnter:N,onMouseOut:g,type:"source"}),(e===!0||e==="target")&&$.jsx(gr,{position:c,centerX:i,centerY:s,radius:t,onMouseDown:y,onMouseEnter:N,onMouseOut:g,type:"target"})]})}function Dl({id:e,edgesFocusable:t,edgesReconnectable:n,elementsSelectable:r,onClick:o,onDoubleClick:i,onContextMenu:s,onMouseEnter:a,onMouseMove:c,onMouseLeave:l,reconnectRadius:u,onReconnect:d,onReconnectStart:f,onReconnectEnd:h,rfId:p,edgeTypes:m,noPanClassName:x,onError:y,disableKeyboardA11y:N}){let g=J(U=>U.edgeLookup.get(e));const b=J(U=>U.defaultEdgeOptions);g=b?{...b,...g}:g;let v=g.type||"default",M=(m==null?void 0:m[v])||dr[v];M===void 0&&(y==null||y("011",ge.error011(v)),v="default",M=dr.default);const C=!!(g.focusable||t&&typeof g.focusable>"u"),I=typeof d<"u"&&(g.reconnectable||n&&typeof g.reconnectable>"u"),T=!!(g.selectable||r&&typeof g.selectable>"u"),z=L.useRef(null),[P,D]=L.useState(!1),[A,w]=L.useState(!1),S=ne(),{zIndex:E,sourceX:_,sourceY:O,targetX:k,targetY:j,sourcePosition:R,targetPosition:H}=J(L.useCallback(U=>{const Z=U.nodeLookup.get(g.source),K=U.nodeLookup.get(g.target);if(!Z||!K)return{zIndex:g.zIndex,...fr};const te=ma({id:e,sourceNode:Z,targetNode:K,sourceHandle:g.sourceHandle||null,targetHandle:g.targetHandle||null,connectionMode:U.connectionMode,onError:y});return{zIndex:ca({selected:g.selected,zIndex:g.zIndex,sourceNode:Z,targetNode:K,elevateOnSelect:U.elevateEdgesOnSelect}),...te||fr}},[g.source,g.target,g.sourceHandle,g.targetHandle,g.selected,g.zIndex]),re),F=L.useMemo(()=>g.markerStart?`url('#${tn(g.markerStart,p)}')`:void 0,[g.markerStart,p]),V=L.useMemo(()=>g.markerEnd?`url('#${tn(g.markerEnd,p)}')`:void 0,[g.markerEnd,p]);if(g.hidden||_===null||O===null||k===null||j===null)return null;const G=U=>{var oe;const{addSelectedEdges:Z,unselectNodesAndEdges:K,multiSelectionActive:te}=S.getState();T&&(S.setState({nodesSelectionActive:!1}),g.selected&&te?(K({nodes:[],edges:[g]}),(oe=z.current)==null||oe.blur()):Z([e])),o&&o(U,g)},X=i?U=>{i(U,{...g})}:void 0,Y=s?U=>{s(U,{...g})}:void 0,B=a?U=>{a(U,{...g})}:void 0,q=c?U=>{c(U,{...g})}:void 0,ee=l?U=>{l(U,{...g})}:void 0,Q=U=>{var Z;if(!N&&Fr.includes(U.key)&&T){const{unselectNodesAndEdges:K,addSelectedEdges:te}=S.getState();U.key==="Escape"?((Z=z.current)==null||Z.blur(),K({edges:[g]})):te([e])}};return $.jsx("svg",{style:{zIndex:E},children:$.jsxs("g",{className:ae(["react-flow__edge",`react-flow__edge-${v}`,g.className,x,{selected:g.selected,animated:g.animated,inactive:!T&&!o,updating:P,selectable:T}]),onClick:G,onDoubleClick:X,onContextMenu:Y,onMouseEnter:B,onMouseMove:q,onMouseLeave:ee,onKeyDown:C?Q:void 0,tabIndex:C?0:void 0,role:g.ariaRole??(C?"group":"img"),"aria-roledescription":"edge","data-id":e,"data-testid":`rf__edge-${e}`,"aria-label":g.ariaLabel===null?void 0:g.ariaLabel||`Edge from ${g.source} to ${g.target}`,"aria-describedby":C?`${So}-${p}`:void 0,ref:z,...g.domAttributes,children:[!A&&$.jsx(M,{id:e,source:g.source,target:g.target,type:g.type,selected:g.selected,animated:g.animated,selectable:T,deletable:g.deletable??!0,label:g.label,labelStyle:g.labelStyle,labelShowBg:g.labelShowBg,labelBgStyle:g.labelBgStyle,labelBgPadding:g.labelBgPadding,labelBgBorderRadius:g.labelBgBorderRadius,sourceX:_,sourceY:O,targetX:k,targetY:j,sourcePosition:R,targetPosition:H,data:g.data,style:g.style,sourceHandleId:g.sourceHandle,targetHandleId:g.targetHandle,markerStart:F,markerEnd:V,pathOptions:"pathOptions"in g?g.pathOptions:void 0,interactionWidth:g.interactionWidth}),I&&$.jsx(Al,{edge:g,isReconnectable:I,reconnectRadius:u,onReconnect:d,onReconnectStart:f,onReconnectEnd:h,sourceX:_,sourceY:O,targetX:k,targetY:j,sourcePosition:R,targetPosition:H,setUpdateHover:D,setReconnecting:w})]})})}const Rl=e=>({edgesFocusable:e.edgesFocusable,edgesReconnectable:e.edgesReconnectable,elementsSelectable:e.elementsSelectable,connectionMode:e.connectionMode,onError:e.onError});function Zo({defaultMarkerColor:e,onlyRenderVisibleElements:t,rfId:n,edgeTypes:r,noPanClassName:o,onReconnect:i,onEdgeContextMenu:s,onEdgeMouseEnter:a,onEdgeMouseMove:c,onEdgeMouseLeave:l,onEdgeClick:u,reconnectRadius:d,onEdgeDoubleClick:f,onReconnectStart:h,onReconnectEnd:p,disableKeyboardA11y:m}){const{edgesFocusable:x,edgesReconnectable:y,elementsSelectable:N,onError:g}=J(Rl,re),b=Nl(t);return $.jsxs("div",{className:"react-flow__edges",children:[$.jsx(Ml,{defaultColor:e,rfId:n}),b.map(v=>$.jsx(Dl,{id:v,edgesFocusable:x,edgesReconnectable:y,elementsSelectable:N,noPanClassName:o,onReconnect:i,onContextMenu:s,onMouseEnter:a,onMouseMove:c,onMouseLeave:l,onClick:u,reconnectRadius:d,onDoubleClick:f,onReconnectStart:h,onReconnectEnd:p,rfId:n,onError:g,edgeTypes:r,disableKeyboardA11y:m},v))]})}Zo.displayName="EdgeRenderer";const zl=L.memo(Zo),Hl=e=>`translate(${e.transform[0]}px,${e.transform[1]}px) scale(${e.transform[2]})`;function Vl({children:e}){const t=J(Hl);return $.jsx("div",{className:"react-flow__viewport xyflow__viewport react-flow__container",style:{transform:t},children:e})}function Bl(e){const t=yn(),n=L.useRef(!1);L.useEffect(()=>{!n.current&&t.viewportInitialized&&e&&(setTimeout(()=>e(t),1),n.current=!0)},[e,t.viewportInitialized])}const Fl=e=>{var t;return(t=e.panZoom)==null?void 0:t.syncViewport};function Yl(e){const t=J(Fl),n=ne();return L.useEffect(()=>{e&&(t==null||t(e),n.setState({transform:[e.x,e.y,e.zoom]}))},[e,t]),null}function Gl(e){return e.connection.inProgress?{...e.connection,to:Je(e.connection.to,e.transform)}:{...e.connection}}function Wl(e){return Gl}function Xl(e){const t=Wl();return J(t,re)}const ql=e=>({nodesConnectable:e.nodesConnectable,isValid:e.connection.isValid,inProgress:e.connection.inProgress,width:e.width,height:e.height});function Ul({containerStyle:e,style:t,type:n,component:r}){const{nodesConnectable:o,width:i,height:s,isValid:a,inProgress:c}=J(ql,re);return!(i&&o&&c)?null:$.jsx("svg",{style:e,width:i,height:s,className:"react-flow__connectionline react-flow__container",children:$.jsx("g",{className:ae(["react-flow__connection",Wr(a)]),children:$.jsx(Qo,{style:t,type:n,CustomComponent:r,isValid:a})})})}const Qo=({style:e,type:t=be.Bezier,CustomComponent:n,isValid:r})=>{const{inProgress:o,from:i,fromNode:s,fromHandle:a,fromPosition:c,to:l,toNode:u,toHandle:d,toPosition:f}=Xl();if(!o)return;if(n)return $.jsx(n,{connectionLineType:t,connectionLineStyle:e,fromNode:s,fromHandle:a,fromX:i.x,fromY:i.y,toX:l.x,toY:l.y,fromPosition:c,toPosition:f,connectionStatus:Wr(r),toNode:u,toHandle:d});let h="";const p={sourceX:i.x,sourceY:i.y,sourcePosition:c,targetX:l.x,targetY:l.y,targetPosition:f};switch(t){case be.Bezier:[h]=oo(p);break;case be.SimpleBezier:[h]=zo(p);break;case be.Step:[h]=en({...p,borderRadius:0});break;case be.SmoothStep:[h]=en(p);break;default:[h]=so(p)}return $.jsx("path",{d:h,fill:"none",className:"react-flow__connection-path",style:e})};Qo.displayName="ConnectionLine";const Kl={};function pr(e=Kl){L.useRef(e),ne(),L.useEffect(()=>{},[e])}function Zl(){ne(),L.useRef(!1),L.useEffect(()=>{},[])}function Jo({nodeTypes:e,edgeTypes:t,onInit:n,onNodeClick:r,onEdgeClick:o,onNodeDoubleClick:i,onEdgeDoubleClick:s,onNodeMouseEnter:a,onNodeMouseMove:c,onNodeMouseLeave:l,onNodeContextMenu:u,onSelectionContextMenu:d,onSelectionStart:f,onSelectionEnd:h,connectionLineType:p,connectionLineStyle:m,connectionLineComponent:x,connectionLineContainerStyle:y,selectionKeyCode:N,selectionOnDrag:g,selectionMode:b,multiSelectionKeyCode:v,panActivationKeyCode:M,zoomActivationKeyCode:C,deleteKeyCode:I,onlyRenderVisibleElements:T,elementsSelectable:z,defaultViewport:P,translateExtent:D,minZoom:A,maxZoom:w,preventScrolling:S,defaultMarkerColor:E,zoomOnScroll:_,zoomOnPinch:O,panOnScroll:k,panOnScrollSpeed:j,panOnScrollMode:R,zoomOnDoubleClick:H,panOnDrag:F,onPaneClick:V,onPaneMouseEnter:G,onPaneMouseMove:X,onPaneMouseLeave:Y,onPaneScroll:B,onPaneContextMenu:q,paneClickDistance:ee,nodeClickDistance:Q,onEdgeContextMenu:U,onEdgeMouseEnter:Z,onEdgeMouseMove:K,onEdgeMouseLeave:te,reconnectRadius:oe,onReconnect:pe,onReconnectStart:Ce,onReconnectEnd:et,noDragClassName:tt,noWheelClassName:nt,noPanClassName:ze,disableKeyboardA11y:He,nodeExtent:Pt,rfId:rt,viewport:Me,onViewportChange:Ve}){return pr(e),pr(t),Zl(),Bl(n),Yl(Me),$.jsx(gl,{onPaneClick:V,onPaneMouseEnter:G,onPaneMouseMove:X,onPaneMouseLeave:Y,onPaneContextMenu:q,onPaneScroll:B,paneClickDistance:ee,deleteKeyCode:I,selectionKeyCode:N,selectionOnDrag:g,selectionMode:b,onSelectionStart:f,onSelectionEnd:h,multiSelectionKeyCode:v,panActivationKeyCode:M,zoomActivationKeyCode:C,elementsSelectable:z,zoomOnScroll:_,zoomOnPinch:O,zoomOnDoubleClick:H,panOnScroll:k,panOnScrollSpeed:j,panOnScrollMode:R,panOnDrag:F,defaultViewport:P,translateExtent:D,minZoom:A,maxZoom:w,onSelectionContextMenu:d,preventScrolling:S,noDragClassName:tt,noWheelClassName:nt,noPanClassName:ze,disableKeyboardA11y:He,onViewportChange:Ve,isControlledViewport:!!Me,children:$.jsxs(Vl,{children:[$.jsx(zl,{edgeTypes:t,onEdgeClick:o,onEdgeDoubleClick:s,onReconnect:pe,onReconnectStart:Ce,onReconnectEnd:et,onlyRenderVisibleElements:T,onEdgeContextMenu:U,onEdgeMouseEnter:Z,onEdgeMouseMove:K,onEdgeMouseLeave:te,reconnectRadius:oe,defaultMarkerColor:E,noPanClassName:ze,disableKeyboardA11y:He,rfId:rt}),$.jsx(Ul,{style:m,type:p,component:x,containerStyle:y}),$.jsx("div",{className:"react-flow__edgelabel-renderer"}),$.jsx(El,{nodeTypes:e,onNodeClick:r,onNodeDoubleClick:i,onNodeMouseEnter:a,onNodeMouseMove:c,onNodeMouseLeave:l,onNodeContextMenu:u,nodeClickDistance:Q,onlyRenderVisibleElements:T,noPanClassName:ze,noDragClassName:tt,disableKeyboardA11y:He,nodeExtent:Pt,rfId:rt}),$.jsx("div",{className:"react-flow__viewport-portal"})]})})}Jo.displayName="GraphView";const Ql=L.memo(Jo),mr=({nodes:e,edges:t,defaultNodes:n,defaultEdges:r,width:o,height:i,fitView:s,fitViewOptions:a,minZoom:c=.5,maxZoom:l=2,nodeOrigin:u,nodeExtent:d}={})=>{const f=new Map,h=new Map,p=new Map,m=new Map,x=r??t??[],y=n??e??[],N=u??[0,0],g=d??We;co(p,m,x);const b=nn(y,f,h,{nodeOrigin:N,nodeExtent:g,elevateNodesOnSelect:!1});let v=[0,0,1];if(s&&o&&i){const M=Qe(f,{filter:z=>!!((z.width||z.initialWidth)&&(z.height||z.initialHeight))}),{x:C,y:I,zoom:T}=dn(M,o,i,c,l,(a==null?void 0:a.padding)??.1);v=[C,I,T]}return{rfId:"1",width:0,height:0,transform:v,nodes:y,nodesInitialized:b,nodeLookup:f,parentLookup:h,edges:x,edgeLookup:m,connectionLookup:p,onNodesChange:null,onEdgesChange:null,hasDefaultNodes:n!==void 0,hasDefaultEdges:r!==void 0,panZoom:null,minZoom:c,maxZoom:l,translateExtent:We,nodeExtent:g,nodesSelectionActive:!1,userSelectionActive:!1,userSelectionRect:null,connectionMode:Oe.Strict,domNode:null,paneDragging:!1,noPanClassName:"nopan",nodeOrigin:N,nodeDragThreshold:1,connectionDragThreshold:1,snapGrid:[15,15],snapToGrid:!1,nodesDraggable:!0,nodesConnectable:!0,nodesFocusable:!0,edgesFocusable:!0,edgesReconnectable:!0,elementsSelectable:!0,elevateNodesOnSelect:!0,elevateEdgesOnSelect:!1,selectNodesOnDrag:!0,multiSelectionActive:!1,fitViewQueued:s??!1,fitViewOptions:a,fitViewResolver:null,connection:{...Gr},connectionClickStartHandle:null,connectOnClick:!0,ariaLiveMessage:"",autoPanOnConnect:!0,autoPanOnNodeDrag:!0,autoPanOnNodeFocus:!0,autoPanSpeed:15,connectionRadius:20,onError:na,isValidConnection:void 0,onSelectionChangeHandlers:[],lib:"react",debug:!1,ariaLabelConfig:Yr}},Jl=({nodes:e,edges:t,defaultNodes:n,defaultEdges:r,width:o,height:i,fitView:s,fitViewOptions:a,minZoom:c,maxZoom:l,nodeOrigin:u,nodeExtent:d})=>xc((f,h)=>{async function p(){const{nodeLookup:m,panZoom:x,fitViewOptions:y,fitViewResolver:N,width:g,height:b,minZoom:v,maxZoom:M}=h();x&&(await ea({nodes:m,width:g,height:b,panZoom:x,minZoom:v,maxZoom:M},y),N==null||N.resolve(!0),f({fitViewResolver:null}))}return{...mr({nodes:e,edges:t,width:o,height:i,fitView:s,fitViewOptions:a,minZoom:c,maxZoom:l,nodeOrigin:u,nodeExtent:d,defaultNodes:n,defaultEdges:r}),setNodes:m=>{const{nodeLookup:x,parentLookup:y,nodeOrigin:N,elevateNodesOnSelect:g,fitViewQueued:b}=h(),v=nn(m,x,y,{nodeOrigin:N,nodeExtent:d,elevateNodesOnSelect:g,checkEquality:!0});b&&v?(p(),f({nodes:m,nodesInitialized:v,fitViewQueued:!1,fitViewOptions:void 0})):f({nodes:m,nodesInitialized:v})},setEdges:m=>{const{connectionLookup:x,edgeLookup:y}=h();co(x,y,m),f({edges:m})},setDefaultNodesAndEdges:(m,x)=>{if(m){const{setNodes:y}=h();y(m),f({hasDefaultNodes:!0})}if(x){const{setEdges:y}=h();y(x),f({hasDefaultEdges:!0})}},updateNodeInternals:m=>{const{triggerNodeChanges:x,nodeLookup:y,parentLookup:N,domNode:g,nodeOrigin:b,nodeExtent:v,debug:M,fitViewQueued:C}=h(),{changes:I,updatedInternals:T}=Ea(m,y,N,g,b,v);T&&(xa(y,N,{nodeOrigin:b,nodeExtent:v}),C?(p(),f({fitViewQueued:!1,fitViewOptions:void 0})):f({}),(I==null?void 0:I.length)>0&&(M&&console.log("React Flow: trigger node changes",I),x==null||x(I)))},updateNodePositions:(m,x=!1)=>{const y=[],N=[],{nodeLookup:g,triggerNodeChanges:b}=h();for(const[v,M]of m){const C=g.get(v),I=!!(C!=null&&C.expandParent&&(C!=null&&C.parentId)&&(M!=null&&M.position)),T={id:v,type:"position",position:I?{x:Math.max(0,M.position.x),y:Math.max(0,M.position.y)}:M.position,dragging:x};I&&C.parentId&&y.push({id:v,parentId:C.parentId,rect:{...M.internals.positionAbsolute,width:M.measured.width??0,height:M.measured.height??0}}),N.push(T)}if(y.length>0){const{parentLookup:v,nodeOrigin:M}=h(),C=mn(y,g,v,M);N.push(...C)}b(N)},triggerNodeChanges:m=>{const{onNodesChange:x,setNodes:y,nodes:N,hasDefaultNodes:g,debug:b}=h();if(m!=null&&m.length){if(g){const v=Mo(m,N);y(v)}b&&console.log("React Flow: trigger node changes",m),x==null||x(m)}},triggerEdgeChanges:m=>{const{onEdgesChange:x,setEdges:y,edges:N,hasDefaultEdges:g,debug:b}=h();if(m!=null&&m.length){if(g){const v=Io(m,N);y(v)}b&&console.log("React Flow: trigger edge changes",m),x==null||x(m)}},addSelectedNodes:m=>{const{multiSelectionActive:x,edgeLookup:y,nodeLookup:N,triggerNodeChanges:g,triggerEdgeChanges:b}=h();if(x){const v=m.map(M=>Ne(M,!0));g(v);return}g(Le(N,new Set([...m]),!0)),b(Le(y))},addSelectedEdges:m=>{const{multiSelectionActive:x,edgeLookup:y,nodeLookup:N,triggerNodeChanges:g,triggerEdgeChanges:b}=h();if(x){const v=m.map(M=>Ne(M,!0));b(v);return}b(Le(y,new Set([...m]))),g(Le(N,new Set,!0))},unselectNodesAndEdges:({nodes:m,edges:x}={})=>{const{edges:y,nodes:N,nodeLookup:g,triggerNodeChanges:b,triggerEdgeChanges:v}=h(),M=m||N,C=x||y,I=M.map(z=>{const P=g.get(z.id);return P&&(P.selected=!1),Ne(z.id,!1)}),T=C.map(z=>Ne(z.id,!1));b(I),v(T)},setMinZoom:m=>{const{panZoom:x,maxZoom:y}=h();x==null||x.setScaleExtent([m,y]),f({minZoom:m})},setMaxZoom:m=>{const{panZoom:x,minZoom:y}=h();x==null||x.setScaleExtent([y,m]),f({maxZoom:m})},setTranslateExtent:m=>{var x;(x=h().panZoom)==null||x.setTranslateExtent(m),f({translateExtent:m})},setPaneClickDistance:m=>{var x;(x=h().panZoom)==null||x.setClickDistance(m)},resetSelectedElements:()=>{const{edges:m,nodes:x,triggerNodeChanges:y,triggerEdgeChanges:N,elementsSelectable:g}=h();if(!g)return;const b=x.reduce((M,C)=>C.selected?[...M,Ne(C.id,!1)]:M,[]),v=m.reduce((M,C)=>C.selected?[...M,Ne(C.id,!1)]:M,[]);y(b),N(v)},setNodeExtent:m=>{const{nodes:x,nodeLookup:y,parentLookup:N,nodeOrigin:g,elevateNodesOnSelect:b,nodeExtent:v}=h();m[0][0]===v[0][0]&&m[0][1]===v[0][1]&&m[1][0]===v[1][0]&&m[1][1]===v[1][1]||(nn(x,y,N,{nodeOrigin:g,nodeExtent:m,elevateNodesOnSelect:b,checkEquality:!1}),f({nodeExtent:m}))},panBy:m=>{const{transform:x,width:y,height:N,panZoom:g,translateExtent:b}=h();return Na({delta:m,panZoom:g,transform:x,translateExtent:b,width:y,height:N})},setCenter:async(m,x,y)=>{const{width:N,height:g,maxZoom:b,panZoom:v}=h();if(!v)return Promise.resolve(!1);const M=typeof(y==null?void 0:y.zoom)<"u"?y.zoom:b;return await v.setViewport({x:N/2-m*M,y:g/2-x*M,zoom:M},{duration:y==null?void 0:y.duration,ease:y==null?void 0:y.ease,interpolate:y==null?void 0:y.interpolate}),Promise.resolve(!0)},cancelConnection:()=>{f({connection:{...Gr}})},updateConnection:m=>{f({connection:m})},reset:()=>f({...mr()})}},Object.is);function eu({initialNodes:e,initialEdges:t,defaultNodes:n,defaultEdges:r,initialWidth:o,initialHeight:i,initialMinZoom:s,initialMaxZoom:a,initialFitViewOptions:c,fitView:l,nodeOrigin:u,nodeExtent:d,children:f}){const[h]=L.useState(()=>Jl({nodes:e,edges:t,defaultNodes:n,defaultEdges:r,width:o,height:i,fitView:l,minZoom:s,maxZoom:a,fitViewOptions:c,nodeOrigin:u,nodeExtent:d}));return $.jsx(bc,{value:h,children:$.jsx(Fc,{children:f})})}function tu({children:e,nodes:t,edges:n,defaultNodes:r,defaultEdges:o,width:i,height:s,fitView:a,fitViewOptions:c,minZoom:l,maxZoom:u,nodeOrigin:d,nodeExtent:f}){return L.useContext(kt)?$.jsx($.Fragment,{children:e}):$.jsx(eu,{initialNodes:t,initialEdges:n,defaultNodes:r,defaultEdges:o,initialWidth:i,initialHeight:s,fitView:a,initialFitViewOptions:c,initialMinZoom:l,initialMaxZoom:u,nodeOrigin:d,nodeExtent:f,children:e})}const nu={width:"100%",height:"100%",overflow:"hidden",position:"relative",zIndex:0};function ru({nodes:e,edges:t,defaultNodes:n,defaultEdges:r,className:o,nodeTypes:i,edgeTypes:s,onNodeClick:a,onEdgeClick:c,onInit:l,onMove:u,onMoveStart:d,onMoveEnd:f,onConnect:h,onConnectStart:p,onConnectEnd:m,onClickConnectStart:x,onClickConnectEnd:y,onNodeMouseEnter:N,onNodeMouseMove:g,onNodeMouseLeave:b,onNodeContextMenu:v,onNodeDoubleClick:M,onNodeDragStart:C,onNodeDrag:I,onNodeDragStop:T,onNodesDelete:z,onEdgesDelete:P,onDelete:D,onSelectionChange:A,onSelectionDragStart:w,onSelectionDrag:S,onSelectionDragStop:E,onSelectionContextMenu:_,onSelectionStart:O,onSelectionEnd:k,onBeforeDelete:j,connectionMode:R,connectionLineType:H=be.Bezier,connectionLineStyle:F,connectionLineComponent:V,connectionLineContainerStyle:G,deleteKeyCode:X="Backspace",selectionKeyCode:Y="Shift",selectionOnDrag:B=!1,selectionMode:q=Xe.Full,panActivationKeyCode:ee="Space",multiSelectionKeyCode:Q=mt()?"Meta":"Control",zoomActivationKeyCode:U=mt()?"Meta":"Control",snapToGrid:Z,snapGrid:K,onlyRenderVisibleElements:te=!1,selectNodesOnDrag:oe,nodesDraggable:pe,autoPanOnNodeFocus:Ce,nodesConnectable:et,nodesFocusable:tt,nodeOrigin:nt=ko,edgesFocusable:ze,edgesReconnectable:He,elementsSelectable:Pt=!0,defaultViewport:rt=Oc,minZoom:Me=.5,maxZoom:Ve=2,translateExtent:Nn=We,preventScrolling:Ii=!0,nodeExtent:Ot,defaultMarkerColor:$i="#b1b1b7",zoomOnScroll:Li=!0,zoomOnPinch:Pi=!0,panOnScroll:Oi=!1,panOnScrollSpeed:ji=.5,panOnScrollMode:Ti=_e.Free,zoomOnDoubleClick:Ai=!0,panOnDrag:Di=!0,onPaneClick:Ri,onPaneMouseEnter:zi,onPaneMouseMove:Hi,onPaneMouseLeave:Vi,onPaneScroll:Bi,onPaneContextMenu:Fi,paneClickDistance:_n=0,nodeClickDistance:Yi=0,children:Gi,onReconnect:Wi,onReconnectStart:Xi,onReconnectEnd:qi,onEdgeContextMenu:Ui,onEdgeDoubleClick:Ki,onEdgeMouseEnter:Zi,onEdgeMouseMove:Qi,onEdgeMouseLeave:Ji,reconnectRadius:es=10,onNodesChange:ts,onEdgesChange:ns,noDragClassName:rs="nodrag",noWheelClassName:os="nowheel",noPanClassName:Sn="nopan",fitView:kn,fitViewOptions:Cn,connectOnClick:is,attributionPosition:ss,proOptions:as,defaultEdgeOptions:cs,elevateNodesOnSelect:ls,elevateEdgesOnSelect:us,disableKeyboardA11y:Mn=!1,autoPanOnConnect:ds,autoPanOnNodeDrag:fs,autoPanSpeed:hs,connectionRadius:gs,isValidConnection:ps,onError:ms,style:ys,id:In,nodeDragThreshold:ws,connectionDragThreshold:xs,viewport:bs,onViewportChange:vs,width:Es,height:Ns,colorMode:_s="light",debug:Ss,onScroll:ot,ariaLabelConfig:ks,...Cs},Ms){const jt=In||"1",Is=Dc(_s),$s=L.useCallback($n=>{$n.currentTarget.scrollTo({top:0,left:0,behavior:"instant"}),ot==null||ot($n)},[ot]);return $.jsx("div",{"data-testid":"rf__wrapper",...Cs,onScroll:$s,style:{...ys,...nu},ref:Ms,className:ae(["react-flow",o,Is]),id:In,role:"application",children:$.jsxs(tu,{nodes:e,edges:t,width:Es,height:Ns,fitView:kn,fitViewOptions:Cn,minZoom:Me,maxZoom:Ve,nodeOrigin:nt,nodeExtent:Ot,children:[$.jsx(Ql,{onInit:l,onNodeClick:a,onEdgeClick:c,onNodeMouseEnter:N,onNodeMouseMove:g,onNodeMouseLeave:b,onNodeContextMenu:v,onNodeDoubleClick:M,nodeTypes:i,edgeTypes:s,connectionLineType:H,connectionLineStyle:F,connectionLineComponent:V,connectionLineContainerStyle:G,selectionKeyCode:Y,selectionOnDrag:B,selectionMode:q,deleteKeyCode:X,multiSelectionKeyCode:Q,panActivationKeyCode:ee,zoomActivationKeyCode:U,onlyRenderVisibleElements:te,defaultViewport:rt,translateExtent:Nn,minZoom:Me,maxZoom:Ve,preventScrolling:Ii,zoomOnScroll:Li,zoomOnPinch:Pi,zoomOnDoubleClick:Ai,panOnScroll:Oi,panOnScrollSpeed:ji,panOnScrollMode:Ti,panOnDrag:Di,onPaneClick:Ri,onPaneMouseEnter:zi,onPaneMouseMove:Hi,onPaneMouseLeave:Vi,onPaneScroll:Bi,onPaneContextMenu:Fi,paneClickDistance:_n,nodeClickDistance:Yi,onSelectionContextMenu:_,onSelectionStart:O,onSelectionEnd:k,onReconnect:Wi,onReconnectStart:Xi,onReconnectEnd:qi,onEdgeContextMenu:Ui,onEdgeDoubleClick:Ki,onEdgeMouseEnter:Zi,onEdgeMouseMove:Qi,onEdgeMouseLeave:Ji,reconnectRadius:es,defaultMarkerColor:$i,noDragClassName:rs,noWheelClassName:os,noPanClassName:Sn,rfId:jt,disableKeyboardA11y:Mn,nodeExtent:Ot,viewport:bs,onViewportChange:vs}),$.jsx(Ac,{nodes:e,edges:t,defaultNodes:n,defaultEdges:r,onConnect:h,onConnectStart:p,onConnectEnd:m,onClickConnectStart:x,onClickConnectEnd:y,nodesDraggable:pe,autoPanOnNodeFocus:Ce,nodesConnectable:et,nodesFocusable:tt,edgesFocusable:ze,edgesReconnectable:He,elementsSelectable:Pt,elevateNodesOnSelect:ls,elevateEdgesOnSelect:us,minZoom:Me,maxZoom:Ve,nodeExtent:Ot,onNodesChange:ts,onEdgesChange:ns,snapToGrid:Z,snapGrid:K,connectionMode:R,translateExtent:Nn,connectOnClick:is,defaultEdgeOptions:cs,fitView:kn,fitViewOptions:Cn,onNodesDelete:z,onEdgesDelete:P,onDelete:D,onNodeDragStart:C,onNodeDrag:I,onNodeDragStop:T,onSelectionDrag:S,onSelectionDragStart:w,onSelectionDragStop:E,onMove:u,onMoveStart:d,onMoveEnd:f,noPanClassName:Sn,nodeOrigin:nt,rfId:jt,autoPanOnConnect:ds,autoPanOnNodeDrag:fs,autoPanSpeed:hs,onError:ms,connectionRadius:gs,isValidConnection:ps,selectNodesOnDrag:oe,nodeDragThreshold:ws,connectionDragThreshold:xs,onBeforeDelete:j,paneClickDistance:_n,debug:Ss,ariaLabelConfig:ks}),$.jsx(Pc,{onSelectionChange:A}),Gi,$.jsx(Cc,{proOptions:as,position:ss}),$.jsx(kc,{rfId:jt,disableKeyboardA11y:Mn})]})})}var Dg=$o(ru);function Rg(e){const[t,n]=L.useState(e),r=L.useCallback(o=>n(i=>Mo(o,i)),[]);return[t,n,r]}function zg(e){const[t,n]=L.useState(e),r=L.useCallback(o=>n(i=>Io(o,i)),[]);return[t,n,r]}function ou({dimensions:e,lineWidth:t,variant:n,className:r}){return $.jsx("path",{strokeWidth:t,d:`M${e[0]/2} 0 V${e[1]} M0 ${e[1]/2} H${e[0]}`,className:ae(["react-flow__background-pattern",n,r])})}function iu({radius:e,className:t}){return $.jsx("circle",{cx:e,cy:e,r:e,className:ae(["react-flow__background-pattern","dots",t])})}var ve;(function(e){e.Lines="lines",e.Dots="dots",e.Cross="cross"})(ve||(ve={}));const su={[ve.Dots]:1,[ve.Lines]:1,[ve.Cross]:6},au=e=>({transform:e.transform,patternId:`pattern-${e.rfId}`});function ei({id:e,variant:t=ve.Dots,gap:n=20,size:r,lineWidth:o=1,offset:i=0,color:s,bgColor:a,style:c,className:l,patternClassName:u}){const d=L.useRef(null),{transform:f,patternId:h}=J(au,re),p=r||su[t],m=t===ve.Dots,x=t===ve.Cross,y=Array.isArray(n)?n:[n,n],N=[y[0]*f[2]||1,y[1]*f[2]||1],g=p*f[2],b=Array.isArray(i)?i:[i,i],v=x?[g,g]:N,M=[b[0]*f[2]||1+v[0]/2,b[1]*f[2]||1+v[1]/2],C=`${h}${e||""}`;return $.jsxs("svg",{className:ae(["react-flow__background",l]),style:{...c,...Mt,"--xy-background-color-props":a,"--xy-background-pattern-color-props":s},ref:d,"data-testid":"rf__background",children:[$.jsx("pattern",{id:C,x:f[0]%N[0],y:f[1]%N[1],width:N[0],height:N[1],patternUnits:"userSpaceOnUse",patternTransform:`translate(-${M[0]},-${M[1]})`,children:m?$.jsx(iu,{radius:g/2,className:u}):$.jsx(ou,{dimensions:v,lineWidth:o,variant:t,className:u})}),$.jsx("rect",{x:"0",y:"0",width:"100%",height:"100%",fill:`url(#${C})`})]})}ei.displayName="Background";const Hg=L.memo(ei);function cu(){return $.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 32",children:$.jsx("path",{d:"M32 18.133H18.133V32h-4.266V18.133H0v-4.266h13.867V0h4.266v13.867H32z"})})}function lu(){return $.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 5",children:$.jsx("path",{d:"M0 0h32v4.2H0z"})})}function uu(){return $.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 32 30",children:$.jsx("path",{d:"M3.692 4.63c0-.53.4-.938.939-.938h5.215V0H4.708C2.13 0 0 2.054 0 4.63v5.216h3.692V4.631zM27.354 0h-5.2v3.692h5.17c.53 0 .984.4.984.939v5.215H32V4.631A4.624 4.624 0 0027.354 0zm.954 24.83c0 .532-.4.94-.939.94h-5.215v3.768h5.215c2.577 0 4.631-2.13 4.631-4.707v-5.139h-3.692v5.139zm-23.677.94c-.531 0-.939-.4-.939-.94v-5.138H0v5.139c0 2.577 2.13 4.707 4.708 4.707h5.138V25.77H4.631z"})})}function du(){return $.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 32",children:$.jsx("path",{d:"M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0 8 0 4.571 3.429 4.571 7.619v3.048H3.048A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047zm4.724-13.866H7.467V7.619c0-2.59 2.133-4.724 4.723-4.724 2.591 0 4.724 2.133 4.724 4.724v3.048z"})})}function fu(){return $.jsx("svg",{xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 25 32",children:$.jsx("path",{d:"M21.333 10.667H19.81V7.619C19.81 3.429 16.38 0 12.19 0c-4.114 1.828-1.37 2.133.305 2.438 1.676.305 4.42 2.59 4.42 5.181v3.048H3.047A3.056 3.056 0 000 13.714v15.238A3.056 3.056 0 003.048 32h18.285a3.056 3.056 0 003.048-3.048V13.714a3.056 3.056 0 00-3.048-3.047zM12.19 24.533a3.056 3.056 0 01-3.047-3.047 3.056 3.056 0 013.047-3.048 3.056 3.056 0 013.048 3.048 3.056 3.056 0 01-3.048 3.047z"})})}function ut({children:e,className:t,...n}){return $.jsx("button",{type:"button",className:ae(["react-flow__controls-button",t]),...n,children:e})}const hu=e=>({isInteractive:e.nodesDraggable||e.nodesConnectable||e.elementsSelectable,minZoomReached:e.transform[2]<=e.minZoom,maxZoomReached:e.transform[2]>=e.maxZoom,ariaLabelConfig:e.ariaLabelConfig});function ti({style:e,showZoom:t=!0,showFitView:n=!0,showInteractive:r=!0,fitViewOptions:o,onZoomIn:i,onZoomOut:s,onFitView:a,onInteractiveChange:c,className:l,children:u,position:d="bottom-left",orientation:f="vertical","aria-label":h}){const p=ne(),{isInteractive:m,minZoomReached:x,maxZoomReached:y,ariaLabelConfig:N}=J(hu,re),{zoomIn:g,zoomOut:b,fitView:v}=yn(),M=()=>{g(),i==null||i()},C=()=>{b(),s==null||s()},I=()=>{v(o),a==null||a()},T=()=>{p.setState({nodesDraggable:!m,nodesConnectable:!m,elementsSelectable:!m}),c==null||c(!m)},z=f==="horizontal"?"horizontal":"vertical";return $.jsxs(Ct,{className:ae(["react-flow__controls",z,l]),position:d,style:e,"data-testid":"rf__controls","aria-label":h??N["controls.ariaLabel"],children:[t&&$.jsxs($.Fragment,{children:[$.jsx(ut,{onClick:M,className:"react-flow__controls-zoomin",title:N["controls.zoomIn.ariaLabel"],"aria-label":N["controls.zoomIn.ariaLabel"],disabled:y,children:$.jsx(cu,{})}),$.jsx(ut,{onClick:C,className:"react-flow__controls-zoomout",title:N["controls.zoomOut.ariaLabel"],"aria-label":N["controls.zoomOut.ariaLabel"],disabled:x,children:$.jsx(lu,{})})]}),n&&$.jsx(ut,{className:"react-flow__controls-fitview",onClick:I,title:N["controls.fitView.ariaLabel"],"aria-label":N["controls.fitView.ariaLabel"],children:$.jsx(uu,{})}),r&&$.jsx(ut,{className:"react-flow__controls-interactive",onClick:T,title:N["controls.interactive.ariaLabel"],"aria-label":N["controls.interactive.ariaLabel"],children:m?$.jsx(fu,{}):$.jsx(du,{})}),u]})}ti.displayName="Controls";const Vg=L.memo(ti);function gu({id:e,x:t,y:n,width:r,height:o,style:i,color:s,strokeColor:a,strokeWidth:c,className:l,borderRadius:u,shapeRendering:d,selected:f,onClick:h}){const{background:p,backgroundColor:m}=i||{},x=s||p||m;return $.jsx("rect",{className:ae(["react-flow__minimap-node",{selected:f},l]),x:t,y:n,rx:u,ry:u,width:r,height:o,style:{fill:x,stroke:a,strokeWidth:c},shapeRendering:d,onClick:h?y=>h(y,e):void 0})}const pu=L.memo(gu),mu=e=>e.nodes.map(t=>t.id),Gt=e=>e instanceof Function?e:()=>e;function yu({nodeStrokeColor:e,nodeColor:t,nodeClassName:n="",nodeBorderRadius:r=5,nodeStrokeWidth:o,nodeComponent:i=pu,onClick:s}){const a=J(mu,re),c=Gt(t),l=Gt(e),u=Gt(n),d=typeof window>"u"||window.chrome?"crispEdges":"geometricPrecision";return $.jsx($.Fragment,{children:a.map(f=>$.jsx(xu,{id:f,nodeColorFunc:c,nodeStrokeColorFunc:l,nodeClassNameFunc:u,nodeBorderRadius:r,nodeStrokeWidth:o,NodeComponent:i,onClick:s,shapeRendering:d},f))})}function wu({id:e,nodeColorFunc:t,nodeStrokeColorFunc:n,nodeClassNameFunc:r,nodeBorderRadius:o,nodeStrokeWidth:i,shapeRendering:s,NodeComponent:a,onClick:c}){const{node:l,x:u,y:d,width:f,height:h}=J(p=>{const{internals:m}=p.nodeLookup.get(e),x=m.userNode,{x:y,y:N}=m.positionAbsolute,{width:g,height:b}=ye(x);return{node:x,x:y,y:N,width:g,height:b}},re);return!l||l.hidden||!Qr(l)?null:$.jsx(a,{x:u,y:d,width:f,height:h,style:l.style,selected:!!l.selected,className:r(l),color:t(l),borderRadius:o,strokeColor:n(l),strokeWidth:i,shapeRendering:s,onClick:c,id:l.id})}const xu=L.memo(wu);var bu=L.memo(yu);const vu=200,Eu=150,Nu=e=>!e.hidden,_u=e=>{const t={x:-e.transform[0]/e.transform[2],y:-e.transform[1]/e.transform[2],width:e.width/e.transform[2],height:e.height/e.transform[2]};return{viewBB:t,boundingRect:e.nodeLookup.size>0?Zr(Qe(e.nodeLookup,{filter:Nu}),t):t,rfId:e.rfId,panZoom:e.panZoom,translateExtent:e.translateExtent,flowWidth:e.width,flowHeight:e.height,ariaLabelConfig:e.ariaLabelConfig}},Su="react-flow__minimap-desc";function ni({style:e,className:t,nodeStrokeColor:n,nodeColor:r,nodeClassName:o="",nodeBorderRadius:i=5,nodeStrokeWidth:s,nodeComponent:a,bgColor:c,maskColor:l,maskStrokeColor:u,maskStrokeWidth:d,position:f="bottom-right",onClick:h,onNodeClick:p,pannable:m=!1,zoomable:x=!1,ariaLabel:y,inversePan:N,zoomStep:g=10,offsetScale:b=5}){const v=ne(),M=L.useRef(null),{boundingRect:C,viewBB:I,rfId:T,panZoom:z,translateExtent:P,flowWidth:D,flowHeight:A,ariaLabelConfig:w}=J(_u,re),S=(e==null?void 0:e.width)??vu,E=(e==null?void 0:e.height)??Eu,_=C.width/S,O=C.height/E,k=Math.max(_,O),j=k*S,R=k*E,H=b*k,F=C.x-(j-C.width)/2-H,V=C.y-(R-C.height)/2-H,G=j+H*2,X=R+H*2,Y=`${Su}-${T}`,B=L.useRef(0),q=L.useRef();B.current=k,L.useEffect(()=>{if(M.current&&z)return q.current=La({domNode:M.current,panZoom:z,getTransform:()=>v.getState().transform,getViewScale:()=>B.current}),()=>{var Z;(Z=q.current)==null||Z.destroy()}},[z]),L.useEffect(()=>{var Z;(Z=q.current)==null||Z.update({translateExtent:P,width:D,height:A,inversePan:N,pannable:m,zoomStep:g,zoomable:x})},[m,x,N,g,P,D,A]);const ee=h?Z=>{var oe;const[K,te]=((oe=q.current)==null?void 0:oe.pointer(Z))||[0,0];h(Z,{x:K,y:te})}:void 0,Q=p?L.useCallback((Z,K)=>{const te=v.getState().nodeLookup.get(K).internals.userNode;p(Z,te)},[]):void 0,U=y??w["minimap.ariaLabel"];return $.jsx(Ct,{position:f,style:{...e,"--xy-minimap-background-color-props":typeof c=="string"?c:void 0,"--xy-minimap-mask-background-color-props":typeof l=="string"?l:void 0,"--xy-minimap-mask-stroke-color-props":typeof u=="string"?u:void 0,"--xy-minimap-mask-stroke-width-props":typeof d=="number"?d*k:void 0,"--xy-minimap-node-background-color-props":typeof r=="string"?r:void 0,"--xy-minimap-node-stroke-color-props":typeof n=="string"?n:void 0,"--xy-minimap-node-stroke-width-props":typeof s=="number"?s:void 0},className:ae(["react-flow__minimap",t]),"data-testid":"rf__minimap",children:$.jsxs("svg",{width:S,height:E,viewBox:`${F} ${V} ${G} ${X}`,className:"react-flow__minimap-svg",role:"img","aria-labelledby":Y,ref:M,onClick:ee,children:[U&&$.jsx("title",{id:Y,children:U}),$.jsx(bu,{onClick:Q,nodeColor:r,nodeStrokeColor:n,nodeBorderRadius:i,nodeClassName:o,nodeStrokeWidth:s,nodeComponent:a}),$.jsx("path",{className:"react-flow__minimap-mask",d:`M${F-H},${V-H}h${G+H*2}v${X+H*2}h${-G-H*2}z
        M${I.x},${I.y}h${I.width}v${I.height}h${-I.width}z`,fillRule:"evenodd",pointerEvents:"none"})]})})}ni.displayName="MiniMap";const Bg=L.memo(ni),ku=e=>t=>e?`${Math.max(1/t.transform[2],1)}`:void 0,Cu={[De.Line]:"right",[De.Handle]:"bottom-right"};function Mu({nodeId:e,position:t,variant:n=De.Handle,className:r,style:o=void 0,children:i,color:s,minWidth:a=10,minHeight:c=10,maxWidth:l=Number.MAX_VALUE,maxHeight:u=Number.MAX_VALUE,keepAspectRatio:d=!1,resizeDirection:f,autoScale:h=!0,shouldResize:p,onResizeStart:m,onResize:x,onResizeEnd:y}){const N=jo(),g=typeof e=="string"?e:N,b=ne(),v=L.useRef(null),M=n===De.Handle,C=J(L.useCallback(ku(M&&h),[M,h]),re),I=L.useRef(null),T=t??Cu[n];L.useEffect(()=>{if(!(!v.current||!g))return I.current||(I.current=Xa({domNode:v.current,nodeId:g,getStoreItems:()=>{const{nodeLookup:P,transform:D,snapGrid:A,snapToGrid:w,nodeOrigin:S,domNode:E}=b.getState();return{nodeLookup:P,transform:D,snapGrid:A,snapToGrid:w,nodeOrigin:S,paneDomNode:E}},onChange:(P,D)=>{const{triggerNodeChanges:A,nodeLookup:w,parentLookup:S,nodeOrigin:E}=b.getState(),_=[],O={x:P.x,y:P.y},k=w.get(g);if(k&&k.expandParent&&k.parentId){const j=k.origin??E,R=P.width??k.measured.width??0,H=P.height??k.measured.height??0,F={id:k.id,parentId:k.parentId,rect:{width:R,height:H,...Jr({x:P.x??k.position.x,y:P.y??k.position.y},{width:R,height:H},k.parentId,w,j)}},V=mn([F],w,S,E);_.push(...V),O.x=P.x?Math.max(j[0]*R,P.x):void 0,O.y=P.y?Math.max(j[1]*H,P.y):void 0}if(O.x!==void 0&&O.y!==void 0){const j={id:g,type:"position",position:{...O}};_.push(j)}if(P.width!==void 0&&P.height!==void 0){const R={id:g,type:"dimensions",resizing:!0,setAttributes:f?f==="horizontal"?"width":"height":!0,dimensions:{width:P.width,height:P.height}};_.push(R)}for(const j of D){const R={...j,type:"position"};_.push(R)}A(_)},onEnd:({width:P,height:D})=>{const A={id:g,type:"dimensions",resizing:!1,dimensions:{width:P,height:D}};b.getState().triggerNodeChanges([A])}})),I.current.update({controlPosition:T,boundaries:{minWidth:a,minHeight:c,maxWidth:l,maxHeight:u},keepAspectRatio:d,resizeDirection:f,onResizeStart:m,onResize:x,onResizeEnd:y,shouldResize:p}),()=>{var P;(P=I.current)==null||P.destroy()}},[T,a,c,l,u,d,m,x,y,p]);const z=T.split("-");return $.jsx("div",{className:ae(["react-flow__resize-control","nodrag",...z,n,r]),ref:v,style:{...o,scale:C,...s&&{[M?"backgroundColor":"borderColor"]:s}},children:i})}L.memo(Mu);var Iu="\0",Ee="\0",yr="";let $u=class{constructor(t){ie(this,"_isDirected",!0);ie(this,"_isMultigraph",!1);ie(this,"_isCompound",!1);ie(this,"_label");ie(this,"_defaultNodeLabelFn",()=>{});ie(this,"_defaultEdgeLabelFn",()=>{});ie(this,"_nodes",{});ie(this,"_in",{});ie(this,"_preds",{});ie(this,"_out",{});ie(this,"_sucs",{});ie(this,"_edgeObjs",{});ie(this,"_edgeLabels",{});ie(this,"_nodeCount",0);ie(this,"_edgeCount",0);ie(this,"_parent");ie(this,"_children");t&&(this._isDirected=Object.hasOwn(t,"directed")?t.directed:!0,this._isMultigraph=Object.hasOwn(t,"multigraph")?t.multigraph:!1,this._isCompound=Object.hasOwn(t,"compound")?t.compound:!1),this._isCompound&&(this._parent={},this._children={},this._children[Ee]={})}isDirected(){return this._isDirected}isMultigraph(){return this._isMultigraph}isCompound(){return this._isCompound}setGraph(t){return this._label=t,this}graph(){return this._label}setDefaultNodeLabel(t){return this._defaultNodeLabelFn=t,typeof t!="function"&&(this._defaultNodeLabelFn=()=>t),this}nodeCount(){return this._nodeCount}nodes(){return Object.keys(this._nodes)}sources(){var t=this;return this.nodes().filter(n=>Object.keys(t._in[n]).length===0)}sinks(){var t=this;return this.nodes().filter(n=>Object.keys(t._out[n]).length===0)}setNodes(t,n){var r=arguments,o=this;return t.forEach(function(i){r.length>1?o.setNode(i,n):o.setNode(i)}),this}setNode(t,n){return Object.hasOwn(this._nodes,t)?(arguments.length>1&&(this._nodes[t]=n),this):(this._nodes[t]=arguments.length>1?n:this._defaultNodeLabelFn(t),this._isCompound&&(this._parent[t]=Ee,this._children[t]={},this._children[Ee][t]=!0),this._in[t]={},this._preds[t]={},this._out[t]={},this._sucs[t]={},++this._nodeCount,this)}node(t){return this._nodes[t]}hasNode(t){return Object.hasOwn(this._nodes,t)}removeNode(t){var n=this;if(Object.hasOwn(this._nodes,t)){var r=o=>n.removeEdge(n._edgeObjs[o]);delete this._nodes[t],this._isCompound&&(this._removeFromParentsChildList(t),delete this._parent[t],this.children(t).forEach(function(o){n.setParent(o)}),delete this._children[t]),Object.keys(this._in[t]).forEach(r),delete this._in[t],delete this._preds[t],Object.keys(this._out[t]).forEach(r),delete this._out[t],delete this._sucs[t],--this._nodeCount}return this}setParent(t,n){if(!this._isCompound)throw new Error("Cannot set parent in a non-compound graph");if(n===void 0)n=Ee;else{n+="";for(var r=n;r!==void 0;r=this.parent(r))if(r===t)throw new Error("Setting "+n+" as parent of "+t+" would create a cycle");this.setNode(n)}return this.setNode(t),this._removeFromParentsChildList(t),this._parent[t]=n,this._children[n][t]=!0,this}_removeFromParentsChildList(t){delete this._children[this._parent[t]][t]}parent(t){if(this._isCompound){var n=this._parent[t];if(n!==Ee)return n}}children(t=Ee){if(this._isCompound){var n=this._children[t];if(n)return Object.keys(n)}else{if(t===Ee)return this.nodes();if(this.hasNode(t))return[]}}predecessors(t){var n=this._preds[t];if(n)return Object.keys(n)}successors(t){var n=this._sucs[t];if(n)return Object.keys(n)}neighbors(t){var n=this.predecessors(t);if(n){const o=new Set(n);for(var r of this.successors(t))o.add(r);return Array.from(o.values())}}isLeaf(t){var n;return this.isDirected()?n=this.successors(t):n=this.neighbors(t),n.length===0}filterNodes(t){var n=new this.constructor({directed:this._isDirected,multigraph:this._isMultigraph,compound:this._isCompound});n.setGraph(this.graph());var r=this;Object.entries(this._nodes).forEach(function([s,a]){t(s)&&n.setNode(s,a)}),Object.values(this._edgeObjs).forEach(function(s){n.hasNode(s.v)&&n.hasNode(s.w)&&n.setEdge(s,r.edge(s))});var o={};function i(s){var a=r.parent(s);return a===void 0||n.hasNode(a)?(o[s]=a,a):a in o?o[a]:i(a)}return this._isCompound&&n.nodes().forEach(s=>n.setParent(s,i(s))),n}setDefaultEdgeLabel(t){return this._defaultEdgeLabelFn=t,typeof t!="function"&&(this._defaultEdgeLabelFn=()=>t),this}edgeCount(){return this._edgeCount}edges(){return Object.values(this._edgeObjs)}setPath(t,n){var r=this,o=arguments;return t.reduce(function(i,s){return o.length>1?r.setEdge(i,s,n):r.setEdge(i,s),s}),this}setEdge(){var t,n,r,o,i=!1,s=arguments[0];typeof s=="object"&&s!==null&&"v"in s?(t=s.v,n=s.w,r=s.name,arguments.length===2&&(o=arguments[1],i=!0)):(t=s,n=arguments[1],r=arguments[3],arguments.length>2&&(o=arguments[2],i=!0)),t=""+t,n=""+n,r!==void 0&&(r=""+r);var a=Fe(this._isDirected,t,n,r);if(Object.hasOwn(this._edgeLabels,a))return i&&(this._edgeLabels[a]=o),this;if(r!==void 0&&!this._isMultigraph)throw new Error("Cannot set a named edge when isMultigraph = false");this.setNode(t),this.setNode(n),this._edgeLabels[a]=i?o:this._defaultEdgeLabelFn(t,n,r);var c=Lu(this._isDirected,t,n,r);return t=c.v,n=c.w,Object.freeze(c),this._edgeObjs[a]=c,wr(this._preds[n],t),wr(this._sucs[t],n),this._in[n][a]=c,this._out[t][a]=c,this._edgeCount++,this}edge(t,n,r){var o=arguments.length===1?Wt(this._isDirected,arguments[0]):Fe(this._isDirected,t,n,r);return this._edgeLabels[o]}edgeAsObj(){const t=this.edge(...arguments);return typeof t!="object"?{label:t}:t}hasEdge(t,n,r){var o=arguments.length===1?Wt(this._isDirected,arguments[0]):Fe(this._isDirected,t,n,r);return Object.hasOwn(this._edgeLabels,o)}removeEdge(t,n,r){var o=arguments.length===1?Wt(this._isDirected,arguments[0]):Fe(this._isDirected,t,n,r),i=this._edgeObjs[o];return i&&(t=i.v,n=i.w,delete this._edgeLabels[o],delete this._edgeObjs[o],xr(this._preds[n],t),xr(this._sucs[t],n),delete this._in[n][o],delete this._out[t][o],this._edgeCount--),this}inEdges(t,n){var r=this._in[t];if(r){var o=Object.values(r);return n?o.filter(i=>i.v===n):o}}outEdges(t,n){var r=this._out[t];if(r){var o=Object.values(r);return n?o.filter(i=>i.w===n):o}}nodeEdges(t,n){var r=this.inEdges(t,n);if(r)return r.concat(this.outEdges(t,n))}};function wr(e,t){e[t]?e[t]++:e[t]=1}function xr(e,t){--e[t]||delete e[t]}function Fe(e,t,n,r){var o=""+t,i=""+n;if(!e&&o>i){var s=o;o=i,i=s}return o+yr+i+yr+(r===void 0?Iu:r)}function Lu(e,t,n,r){var o=""+t,i=""+n;if(!e&&o>i){var s=o;o=i,i=s}var a={v:o,w:i};return r&&(a.name=r),a}function Wt(e,t){return Fe(e,t.v,t.w,t.name)}var xn=$u,Pu="2.2.4",Ou={Graph:xn,version:Pu},ju=xn,Tu={write:Au,read:zu};function Au(e){var t={options:{directed:e.isDirected(),multigraph:e.isMultigraph(),compound:e.isCompound()},nodes:Du(e),edges:Ru(e)};return e.graph()!==void 0&&(t.value=structuredClone(e.graph())),t}function Du(e){return e.nodes().map(function(t){var n=e.node(t),r=e.parent(t),o={v:t};return n!==void 0&&(o.value=n),r!==void 0&&(o.parent=r),o})}function Ru(e){return e.edges().map(function(t){var n=e.edge(t),r={v:t.v,w:t.w};return t.name!==void 0&&(r.name=t.name),n!==void 0&&(r.value=n),r})}function zu(e){var t=new ju(e.options).setGraph(e.value);return e.nodes.forEach(function(n){t.setNode(n.v,n.value),n.parent&&t.setParent(n.v,n.parent)}),e.edges.forEach(function(n){t.setEdge({v:n.v,w:n.w,name:n.name},n.value)}),t}var Hu=Vu;function Vu(e){var t={},n=[],r;function o(i){Object.hasOwn(t,i)||(t[i]=!0,r.push(i),e.successors(i).forEach(o),e.predecessors(i).forEach(o))}return e.nodes().forEach(function(i){r=[],o(i),r.length&&n.push(r)}),n}let Bu=class{constructor(){ie(this,"_arr",[]);ie(this,"_keyIndices",{})}size(){return this._arr.length}keys(){return this._arr.map(function(t){return t.key})}has(t){return Object.hasOwn(this._keyIndices,t)}priority(t){var n=this._keyIndices[t];if(n!==void 0)return this._arr[n].priority}min(){if(this.size()===0)throw new Error("Queue underflow");return this._arr[0].key}add(t,n){var r=this._keyIndices;if(t=String(t),!Object.hasOwn(r,t)){var o=this._arr,i=o.length;return r[t]=i,o.push({key:t,priority:n}),this._decrease(i),!0}return!1}removeMin(){this._swap(0,this._arr.length-1);var t=this._arr.pop();return delete this._keyIndices[t.key],this._heapify(0),t.key}decrease(t,n){var r=this._keyIndices[t];if(n>this._arr[r].priority)throw new Error("New priority is greater than current priority. Key: "+t+" Old: "+this._arr[r].priority+" New: "+n);this._arr[r].priority=n,this._decrease(r)}_heapify(t){var n=this._arr,r=2*t,o=r+1,i=t;r<n.length&&(i=n[r].priority<n[i].priority?r:i,o<n.length&&(i=n[o].priority<n[i].priority?o:i),i!==t&&(this._swap(t,i),this._heapify(i)))}_decrease(t){for(var n=this._arr,r=n[t].priority,o;t!==0&&(o=t>>1,!(n[o].priority<r));)this._swap(t,o),t=o}_swap(t,n){var r=this._arr,o=this._keyIndices,i=r[t],s=r[n];r[t]=s,r[n]=i,o[s.key]=t,o[i.key]=n}};var ri=Bu,Fu=ri,oi=Gu,Yu=()=>1;function Gu(e,t,n,r){return Wu(e,String(t),n||Yu,r||function(o){return e.outEdges(o)})}function Wu(e,t,n,r){var o={},i=new Fu,s,a,c=function(l){var u=l.v!==s?l.v:l.w,d=o[u],f=n(l),h=a.distance+f;if(f<0)throw new Error("dijkstra does not allow negative edge weights. Bad edge: "+l+" Weight: "+f);h<d.distance&&(d.distance=h,d.predecessor=s,i.decrease(u,h))};for(e.nodes().forEach(function(l){var u=l===t?0:Number.POSITIVE_INFINITY;o[l]={distance:u},i.add(l,u)});i.size()>0&&(s=i.removeMin(),a=o[s],a.distance!==Number.POSITIVE_INFINITY);)r(s).forEach(c);return o}var Xu=oi,qu=Uu;function Uu(e,t,n){return e.nodes().reduce(function(r,o){return r[o]=Xu(e,o,t,n),r},{})}var ii=Ku;function Ku(e){var t=0,n=[],r={},o=[];function i(s){var a=r[s]={onStack:!0,lowlink:t,index:t++};if(n.push(s),e.successors(s).forEach(function(u){Object.hasOwn(r,u)?r[u].onStack&&(a.lowlink=Math.min(a.lowlink,r[u].index)):(i(u),a.lowlink=Math.min(a.lowlink,r[u].lowlink))}),a.lowlink===a.index){var c=[],l;do l=n.pop(),r[l].onStack=!1,c.push(l);while(s!==l);o.push(c)}}return e.nodes().forEach(function(s){Object.hasOwn(r,s)||i(s)}),o}var Zu=ii,Qu=Ju;function Ju(e){return Zu(e).filter(function(t){return t.length>1||t.length===1&&e.hasEdge(t[0],t[0])})}var ed=nd,td=()=>1;function nd(e,t,n){return rd(e,t||td,n||function(r){return e.outEdges(r)})}function rd(e,t,n){var r={},o=e.nodes();return o.forEach(function(i){r[i]={},r[i][i]={distance:0},o.forEach(function(s){i!==s&&(r[i][s]={distance:Number.POSITIVE_INFINITY})}),n(i).forEach(function(s){var a=s.v===i?s.w:s.v,c=t(s);r[i][a]={distance:c,predecessor:i}})}),o.forEach(function(i){var s=r[i];o.forEach(function(a){var c=r[a];o.forEach(function(l){var u=c[i],d=s[l],f=c[l],h=u.distance+d.distance;h<f.distance&&(f.distance=h,f.predecessor=d.predecessor)})})}),r}function si(e){var t={},n={},r=[];function o(i){if(Object.hasOwn(n,i))throw new sn;Object.hasOwn(t,i)||(n[i]=!0,t[i]=!0,e.predecessors(i).forEach(o),delete n[i],r.push(i))}if(e.sinks().forEach(o),Object.keys(t).length!==e.nodeCount())throw new sn;return r}class sn extends Error{constructor(){super(...arguments)}}var ai=si;si.CycleException=sn;var br=ai,od=id;function id(e){try{br(e)}catch(t){if(t instanceof br.CycleException)return!1;throw t}return!0}var ci=sd;function sd(e,t,n){Array.isArray(t)||(t=[t]);var r=e.isDirected()?a=>e.successors(a):a=>e.neighbors(a),o=n==="post"?ad:cd,i=[],s={};return t.forEach(a=>{if(!e.hasNode(a))throw new Error("Graph does not have node: "+a);o(a,r,s,i)}),i}function ad(e,t,n,r){for(var o=[[e,!1]];o.length>0;){var i=o.pop();i[1]?r.push(i[0]):Object.hasOwn(n,i[0])||(n[i[0]]=!0,o.push([i[0],!0]),li(t(i[0]),s=>o.push([s,!1])))}}function cd(e,t,n,r){for(var o=[e];o.length>0;){var i=o.pop();Object.hasOwn(n,i)||(n[i]=!0,r.push(i),li(t(i),s=>o.push(s)))}}function li(e,t){for(var n=e.length;n--;)t(e[n],n,e);return e}var ld=ci,ud=dd;function dd(e,t){return ld(e,t,"post")}var fd=ci,hd=gd;function gd(e,t){return fd(e,t,"pre")}var pd=xn,md=ri,yd=wd;function wd(e,t){var n=new pd,r={},o=new md,i;function s(c){var l=c.v===i?c.w:c.v,u=o.priority(l);if(u!==void 0){var d=t(c);d<u&&(r[l]=i,o.decrease(l,d))}}if(e.nodeCount()===0)return n;e.nodes().forEach(function(c){o.add(c,Number.POSITIVE_INFINITY),n.setNode(c)}),o.decrease(e.nodes()[0],0);for(var a=!1;o.size()>0;){if(i=o.removeMin(),Object.hasOwn(r,i))n.setEdge(i,r[i]);else{if(a)throw new Error("Input graph is not connected: "+e);a=!0}e.nodeEdges(i).forEach(s)}return n}var xd={components:Hu,dijkstra:oi,dijkstraAll:qu,findCycles:Qu,floydWarshall:ed,isAcyclic:od,postorder:ud,preorder:hd,prim:yd,tarjan:ii,topsort:ai},vr=Ou,fe={Graph:vr.Graph,json:Tu,alg:xd,version:vr.version};let bd=class{constructor(){let t={};t._next=t._prev=t,this._sentinel=t}dequeue(){let t=this._sentinel,n=t._prev;if(n!==t)return Er(n),n}enqueue(t){let n=this._sentinel;t._prev&&t._next&&Er(t),t._next=n._next,n._next._prev=t,n._next=t,t._prev=n}toString(){let t=[],n=this._sentinel,r=n._prev;for(;r!==n;)t.push(JSON.stringify(r,vd)),r=r._prev;return"["+t.join(", ")+"]"}};function Er(e){e._prev._next=e._next,e._next._prev=e._prev,delete e._next,delete e._prev}function vd(e,t){if(e!=="_next"&&e!=="_prev")return t}var Ed=bd;let Nd=fe.Graph,_d=Ed;var Sd=Cd;let kd=()=>1;function Cd(e,t){if(e.nodeCount()<=1)return[];let n=Id(e,t||kd);return Md(n.graph,n.buckets,n.zeroIdx).flatMap(o=>e.outEdges(o.v,o.w))}function Md(e,t,n){let r=[],o=t[t.length-1],i=t[0],s;for(;e.nodeCount();){for(;s=i.dequeue();)Xt(e,t,n,s);for(;s=o.dequeue();)Xt(e,t,n,s);if(e.nodeCount()){for(let a=t.length-2;a>0;--a)if(s=t[a].dequeue(),s){r=r.concat(Xt(e,t,n,s,!0));break}}}return r}function Xt(e,t,n,r,o){let i=o?[]:void 0;return e.inEdges(r.v).forEach(s=>{let a=e.edge(s),c=e.node(s.v);o&&i.push({v:s.v,w:s.w}),c.out-=a,an(t,n,c)}),e.outEdges(r.v).forEach(s=>{let a=e.edge(s),c=s.w,l=e.node(c);l.in-=a,an(t,n,l)}),e.removeNode(r.v),i}function Id(e,t){let n=new Nd,r=0,o=0;e.nodes().forEach(a=>{n.setNode(a,{v:a,in:0,out:0})}),e.edges().forEach(a=>{let c=n.edge(a.v,a.w)||0,l=t(a),u=c+l;n.setEdge(a.v,a.w,u),o=Math.max(o,n.node(a.v).out+=l),r=Math.max(r,n.node(a.w).in+=l)});let i=$d(o+r+3).map(()=>new _d),s=r+1;return n.nodes().forEach(a=>{an(i,s,n.node(a))}),{graph:n,buckets:i,zeroIdx:s}}function an(e,t,n){n.out?n.in?e[n.out-n.in+t].enqueue(n):e[e.length-1].enqueue(n):e[0].enqueue(n)}function $d(e){const t=[];for(let n=0;n<e;n++)t.push(n);return t}let ui=fe.Graph;var se={addBorderNode:zd,addDummyNode:di,applyWithChunking:$t,asNonCompoundGraph:Pd,buildLayerMatrix:Ad,intersectRect:Td,mapValues:Wd,maxRank:hi,normalizeRanks:Dd,notime:Fd,partition:Vd,pick:Gd,predecessorWeights:jd,range:pi,removeEmptyRanks:Rd,simplify:Ld,successorWeights:Od,time:Bd,uniqueId:gi,zipObject:bn};function di(e,t,n,r){for(var o=r;e.hasNode(o);)o=gi(r);return n.dummy=t,e.setNode(o,n),o}function Ld(e){let t=new ui().setGraph(e.graph());return e.nodes().forEach(n=>t.setNode(n,e.node(n))),e.edges().forEach(n=>{let r=t.edge(n.v,n.w)||{weight:0,minlen:1},o=e.edge(n);t.setEdge(n.v,n.w,{weight:r.weight+o.weight,minlen:Math.max(r.minlen,o.minlen)})}),t}function Pd(e){let t=new ui({multigraph:e.isMultigraph()}).setGraph(e.graph());return e.nodes().forEach(n=>{e.children(n).length||t.setNode(n,e.node(n))}),e.edges().forEach(n=>{t.setEdge(n,e.edge(n))}),t}function Od(e){let t=e.nodes().map(n=>{let r={};return e.outEdges(n).forEach(o=>{r[o.w]=(r[o.w]||0)+e.edge(o).weight}),r});return bn(e.nodes(),t)}function jd(e){let t=e.nodes().map(n=>{let r={};return e.inEdges(n).forEach(o=>{r[o.v]=(r[o.v]||0)+e.edge(o).weight}),r});return bn(e.nodes(),t)}function Td(e,t){let n=e.x,r=e.y,o=t.x-n,i=t.y-r,s=e.width/2,a=e.height/2;if(!o&&!i)throw new Error("Not possible to find intersection inside of the rectangle");let c,l;return Math.abs(i)*s>Math.abs(o)*a?(i<0&&(a=-a),c=a*o/i,l=a):(o<0&&(s=-s),c=s,l=s*i/o),{x:n+c,y:r+l}}function Ad(e){let t=pi(hi(e)+1).map(()=>[]);return e.nodes().forEach(n=>{let r=e.node(n),o=r.rank;o!==void 0&&(t[o][r.order]=n)}),t}function Dd(e){let t=e.nodes().map(r=>{let o=e.node(r).rank;return o===void 0?Number.MAX_VALUE:o}),n=$t(Math.min,t);e.nodes().forEach(r=>{let o=e.node(r);Object.hasOwn(o,"rank")&&(o.rank-=n)})}function Rd(e){let t=e.nodes().map(s=>e.node(s).rank),n=$t(Math.min,t),r=[];e.nodes().forEach(s=>{let a=e.node(s).rank-n;r[a]||(r[a]=[]),r[a].push(s)});let o=0,i=e.graph().nodeRankFactor;Array.from(r).forEach((s,a)=>{s===void 0&&a%i!==0?--o:s!==void 0&&o&&s.forEach(c=>e.node(c).rank+=o)})}function zd(e,t,n,r){let o={width:0,height:0};return arguments.length>=4&&(o.rank=n,o.order=r),di(e,"border",o,t)}function Hd(e,t=fi){const n=[];for(let r=0;r<e.length;r+=t){const o=e.slice(r,r+t);n.push(o)}return n}const fi=65535;function $t(e,t){if(t.length>fi){const n=Hd(t);return e.apply(null,n.map(r=>e.apply(null,r)))}else return e.apply(null,t)}function hi(e){const n=e.nodes().map(r=>{let o=e.node(r).rank;return o===void 0?Number.MIN_VALUE:o});return $t(Math.max,n)}function Vd(e,t){let n={lhs:[],rhs:[]};return e.forEach(r=>{t(r)?n.lhs.push(r):n.rhs.push(r)}),n}function Bd(e,t){let n=Date.now();try{return t()}finally{console.log(e+" time: "+(Date.now()-n)+"ms")}}function Fd(e,t){return t()}let Yd=0;function gi(e){var t=++Yd;return e+(""+t)}function pi(e,t,n=1){t==null&&(t=e,e=0);let r=i=>i<t;n<0&&(r=i=>t<i);const o=[];for(let i=e;r(i);i+=n)o.push(i);return o}function Gd(e,t){const n={};for(const r of t)e[r]!==void 0&&(n[r]=e[r]);return n}function Wd(e,t){let n=t;return typeof t=="string"&&(n=r=>r[t]),Object.entries(e).reduce((r,[o,i])=>(r[o]=n(i,o),r),{})}function bn(e,t){return e.reduce((n,r,o)=>(n[r]=t[o],n),{})}let Xd=Sd,qd=se.uniqueId;var Ud={run:Kd,undo:Qd};function Kd(e){(e.graph().acyclicer==="greedy"?Xd(e,n(e)):Zd(e)).forEach(r=>{let o=e.edge(r);e.removeEdge(r),o.forwardName=r.name,o.reversed=!0,e.setEdge(r.w,r.v,o,qd("rev"))});function n(r){return o=>r.edge(o).weight}}function Zd(e){let t=[],n={},r={};function o(i){Object.hasOwn(r,i)||(r[i]=!0,n[i]=!0,e.outEdges(i).forEach(s=>{Object.hasOwn(n,s.w)?t.push(s):o(s.w)}),delete n[i])}return e.nodes().forEach(o),t}function Qd(e){e.edges().forEach(t=>{let n=e.edge(t);if(n.reversed){e.removeEdge(t);let r=n.forwardName;delete n.reversed,delete n.forwardName,e.setEdge(t.w,t.v,n,r)}})}let Jd=se;var ef={run:tf,undo:rf};function tf(e){e.graph().dummyChains=[],e.edges().forEach(t=>nf(e,t))}function nf(e,t){let n=t.v,r=e.node(n).rank,o=t.w,i=e.node(o).rank,s=t.name,a=e.edge(t),c=a.labelRank;if(i===r+1)return;e.removeEdge(t);let l,u,d;for(d=0,++r;r<i;++d,++r)a.points=[],u={width:0,height:0,edgeLabel:a,edgeObj:t,rank:r},l=Jd.addDummyNode(e,"edge",u,"_d"),r===c&&(u.width=a.width,u.height=a.height,u.dummy="edge-label",u.labelpos=a.labelpos),e.setEdge(n,l,{weight:a.weight},s),d===0&&e.graph().dummyChains.push(l),n=l;e.setEdge(n,o,{weight:a.weight},s)}function rf(e){e.graph().dummyChains.forEach(t=>{let n=e.node(t),r=n.edgeLabel,o;for(e.setEdge(n.edgeObj,r);n.dummy;)o=e.successors(t)[0],e.removeNode(t),r.points.push({x:n.x,y:n.y}),n.dummy==="edge-label"&&(r.x=n.x,r.y=n.y,r.width=n.width,r.height=n.height),t=o,n=e.node(t)})}const{applyWithChunking:of}=se;var Lt={longestPath:sf,slack:af};function sf(e){var t={};function n(r){var o=e.node(r);if(Object.hasOwn(t,r))return o.rank;t[r]=!0;let i=e.outEdges(r).map(a=>a==null?Number.POSITIVE_INFINITY:n(a.w)-e.edge(a).minlen);var s=of(Math.min,i);return s===Number.POSITIVE_INFINITY&&(s=0),o.rank=s}e.sources().forEach(n)}function af(e,t){return e.node(t.w).rank-e.node(t.v).rank-e.edge(t).minlen}var cf=fe.Graph,xt=Lt.slack,mi=lf;function lf(e){var t=new cf({directed:!1}),n=e.nodes()[0],r=e.nodeCount();t.setNode(n,{});for(var o,i;uf(t,e)<r;)o=df(t,e),i=t.hasNode(o.v)?xt(e,o):-xt(e,o),ff(t,e,i);return t}function uf(e,t){function n(r){t.nodeEdges(r).forEach(o=>{var i=o.v,s=r===i?o.w:i;!e.hasNode(s)&&!xt(t,o)&&(e.setNode(s,{}),e.setEdge(r,s,{}),n(s))})}return e.nodes().forEach(n),e.nodeCount()}function df(e,t){return t.edges().reduce((r,o)=>{let i=Number.POSITIVE_INFINITY;return e.hasNode(o.v)!==e.hasNode(o.w)&&(i=xt(t,o)),i<r[0]?[i,o]:r},[Number.POSITIVE_INFINITY,null])[1]}function ff(e,t,n){e.nodes().forEach(r=>t.node(r).rank+=n)}var hf=mi,Nr=Lt.slack,gf=Lt.longestPath,pf=fe.alg.preorder,mf=fe.alg.postorder,yf=se.simplify,wf=ke;ke.initLowLimValues=En;ke.initCutValues=vn;ke.calcCutValue=yi;ke.leaveEdge=xi;ke.enterEdge=bi;ke.exchangeEdges=vi;function ke(e){e=yf(e),gf(e);var t=hf(e);En(t),vn(t,e);for(var n,r;n=xi(t);)r=bi(t,e,n),vi(t,e,n,r)}function vn(e,t){var n=mf(e,e.nodes());n=n.slice(0,n.length-1),n.forEach(r=>xf(e,t,r))}function xf(e,t,n){var r=e.node(n),o=r.parent;e.edge(n,o).cutvalue=yi(e,t,n)}function yi(e,t,n){var r=e.node(n),o=r.parent,i=!0,s=t.edge(n,o),a=0;return s||(i=!1,s=t.edge(o,n)),a=s.weight,t.nodeEdges(n).forEach(c=>{var l=c.v===n,u=l?c.w:c.v;if(u!==o){var d=l===i,f=t.edge(c).weight;if(a+=d?f:-f,vf(e,n,u)){var h=e.edge(n,u).cutvalue;a+=d?-h:h}}}),a}function En(e,t){arguments.length<2&&(t=e.nodes()[0]),wi(e,{},1,t)}function wi(e,t,n,r,o){var i=n,s=e.node(r);return t[r]=!0,e.neighbors(r).forEach(a=>{Object.hasOwn(t,a)||(n=wi(e,t,n,a,r))}),s.low=i,s.lim=n++,o?s.parent=o:delete s.parent,n}function xi(e){return e.edges().find(t=>e.edge(t).cutvalue<0)}function bi(e,t,n){var r=n.v,o=n.w;t.hasEdge(r,o)||(r=n.w,o=n.v);var i=e.node(r),s=e.node(o),a=i,c=!1;i.lim>s.lim&&(a=s,c=!0);var l=t.edges().filter(u=>c===_r(e,e.node(u.v),a)&&c!==_r(e,e.node(u.w),a));return l.reduce((u,d)=>Nr(t,d)<Nr(t,u)?d:u)}function vi(e,t,n,r){var o=n.v,i=n.w;e.removeEdge(o,i),e.setEdge(r.v,r.w,{}),En(e),vn(e,t),bf(e,t)}function bf(e,t){var n=e.nodes().find(o=>!t.node(o).parent),r=pf(e,n);r=r.slice(1),r.forEach(o=>{var i=e.node(o).parent,s=t.edge(o,i),a=!1;s||(s=t.edge(i,o),a=!0),t.node(o).rank=t.node(i).rank+(a?s.minlen:-s.minlen)})}function vf(e,t,n){return e.hasEdge(t,n)}function _r(e,t,n){return n.low<=t.lim&&t.lim<=n.lim}var Ef=Lt,Ei=Ef.longestPath,Nf=mi,_f=wf,Sf=kf;function kf(e){var t=e.graph().ranker;if(t instanceof Function)return t(e);switch(e.graph().ranker){case"network-simplex":Sr(e);break;case"tight-tree":Mf(e);break;case"longest-path":Cf(e);break;case"none":break;default:Sr(e)}}var Cf=Ei;function Mf(e){Ei(e),Nf(e)}function Sr(e){_f(e)}var If=$f;function $f(e){let t=Pf(e);e.graph().dummyChains.forEach(n=>{let r=e.node(n),o=r.edgeObj,i=Lf(e,t,o.v,o.w),s=i.path,a=i.lca,c=0,l=s[c],u=!0;for(;n!==o.w;){if(r=e.node(n),u){for(;(l=s[c])!==a&&e.node(l).maxRank<r.rank;)c++;l===a&&(u=!1)}if(!u){for(;c<s.length-1&&e.node(l=s[c+1]).minRank<=r.rank;)c++;l=s[c]}e.setParent(n,l),n=e.successors(n)[0]}})}function Lf(e,t,n,r){let o=[],i=[],s=Math.min(t[n].low,t[r].low),a=Math.max(t[n].lim,t[r].lim),c,l;c=n;do c=e.parent(c),o.push(c);while(c&&(t[c].low>s||a>t[c].lim));for(l=c,c=r;(c=e.parent(c))!==l;)i.push(c);return{path:o.concat(i.reverse()),lca:l}}function Pf(e){let t={},n=0;function r(o){let i=n;e.children(o).forEach(r),t[o]={low:i,lim:n++}}return e.children().forEach(r),t}let bt=se;var Of={run:jf,cleanup:Df};function jf(e){let t=bt.addDummyNode(e,"root",{},"_root"),n=Tf(e),r=Object.values(n),o=bt.applyWithChunking(Math.max,r)-1,i=2*o+1;e.graph().nestingRoot=t,e.edges().forEach(a=>e.edge(a).minlen*=i);let s=Af(e)+1;e.children().forEach(a=>Ni(e,t,i,s,o,n,a)),e.graph().nodeRankFactor=i}function Ni(e,t,n,r,o,i,s){let a=e.children(s);if(!a.length){s!==t&&e.setEdge(t,s,{weight:0,minlen:n});return}let c=bt.addBorderNode(e,"_bt"),l=bt.addBorderNode(e,"_bb"),u=e.node(s);e.setParent(c,s),u.borderTop=c,e.setParent(l,s),u.borderBottom=l,a.forEach(d=>{Ni(e,t,n,r,o,i,d);let f=e.node(d),h=f.borderTop?f.borderTop:d,p=f.borderBottom?f.borderBottom:d,m=f.borderTop?r:2*r,x=h!==p?1:o-i[s]+1;e.setEdge(c,h,{weight:m,minlen:x,nestingEdge:!0}),e.setEdge(p,l,{weight:m,minlen:x,nestingEdge:!0})}),e.parent(s)||e.setEdge(t,c,{weight:0,minlen:o+i[s]})}function Tf(e){var t={};function n(r,o){var i=e.children(r);i&&i.length&&i.forEach(s=>n(s,o+1)),t[r]=o}return e.children().forEach(r=>n(r,1)),t}function Af(e){return e.edges().reduce((t,n)=>t+e.edge(n).weight,0)}function Df(e){var t=e.graph();e.removeNode(t.nestingRoot),delete t.nestingRoot,e.edges().forEach(n=>{var r=e.edge(n);r.nestingEdge&&e.removeEdge(n)})}let Rf=se;var zf=Hf;function Hf(e){function t(n){let r=e.children(n),o=e.node(n);if(r.length&&r.forEach(t),Object.hasOwn(o,"minRank")){o.borderLeft=[],o.borderRight=[];for(let i=o.minRank,s=o.maxRank+1;i<s;++i)kr(e,"borderLeft","_bl",n,o,i),kr(e,"borderRight","_br",n,o,i)}}e.children().forEach(t)}function kr(e,t,n,r,o,i){let s={width:0,height:0,rank:i,borderType:t},a=o[t][i-1],c=Rf.addDummyNode(e,"border",s,n);o[t][i]=c,e.setParent(c,r),a&&e.setEdge(a,c,{weight:1})}var Vf={adjust:Bf,undo:Ff};function Bf(e){let t=e.graph().rankdir.toLowerCase();(t==="lr"||t==="rl")&&_i(e)}function Ff(e){let t=e.graph().rankdir.toLowerCase();(t==="bt"||t==="rl")&&Yf(e),(t==="lr"||t==="rl")&&(Gf(e),_i(e))}function _i(e){e.nodes().forEach(t=>Cr(e.node(t))),e.edges().forEach(t=>Cr(e.edge(t)))}function Cr(e){let t=e.width;e.width=e.height,e.height=t}function Yf(e){e.nodes().forEach(t=>qt(e.node(t))),e.edges().forEach(t=>{let n=e.edge(t);n.points.forEach(qt),Object.hasOwn(n,"y")&&qt(n)})}function qt(e){e.y=-e.y}function Gf(e){e.nodes().forEach(t=>Ut(e.node(t))),e.edges().forEach(t=>{let n=e.edge(t);n.points.forEach(Ut),Object.hasOwn(n,"x")&&Ut(n)})}function Ut(e){let t=e.x;e.x=e.y,e.y=t}let Mr=se;var Wf=Xf;function Xf(e){let t={},n=e.nodes().filter(c=>!e.children(c).length),r=n.map(c=>e.node(c).rank),o=Mr.applyWithChunking(Math.max,r),i=Mr.range(o+1).map(()=>[]);function s(c){if(t[c])return;t[c]=!0;let l=e.node(c);i[l.rank].push(c),e.successors(c).forEach(s)}return n.sort((c,l)=>e.node(c).rank-e.node(l).rank).forEach(s),i}let qf=se.zipObject;var Uf=Kf;function Kf(e,t){let n=0;for(let r=1;r<t.length;++r)n+=Zf(e,t[r-1],t[r]);return n}function Zf(e,t,n){let r=qf(n,n.map((l,u)=>u)),o=t.flatMap(l=>e.outEdges(l).map(u=>({pos:r[u.w],weight:e.edge(u).weight})).sort((u,d)=>u.pos-d.pos)),i=1;for(;i<n.length;)i<<=1;let s=2*i-1;i-=1;let a=new Array(s).fill(0),c=0;return o.forEach(l=>{let u=l.pos+i;a[u]+=l.weight;let d=0;for(;u>0;)u%2&&(d+=a[u+1]),u=u-1>>1,a[u]+=l.weight;c+=l.weight*d}),c}var Qf=Jf;function Jf(e,t=[]){return t.map(n=>{let r=e.inEdges(n);if(r.length){let o=r.reduce((i,s)=>{let a=e.edge(s),c=e.node(s.v);return{sum:i.sum+a.weight*c.order,weight:i.weight+a.weight}},{sum:0,weight:0});return{v:n,barycenter:o.sum/o.weight,weight:o.weight}}else return{v:n}})}let eh=se;var th=nh;function nh(e,t){let n={};e.forEach((o,i)=>{let s=n[o.v]={indegree:0,in:[],out:[],vs:[o.v],i};o.barycenter!==void 0&&(s.barycenter=o.barycenter,s.weight=o.weight)}),t.edges().forEach(o=>{let i=n[o.v],s=n[o.w];i!==void 0&&s!==void 0&&(s.indegree++,i.out.push(n[o.w]))});let r=Object.values(n).filter(o=>!o.indegree);return rh(r)}function rh(e){let t=[];function n(o){return i=>{i.merged||(i.barycenter===void 0||o.barycenter===void 0||i.barycenter>=o.barycenter)&&oh(o,i)}}function r(o){return i=>{i.in.push(o),--i.indegree===0&&e.push(i)}}for(;e.length;){let o=e.pop();t.push(o),o.in.reverse().forEach(n(o)),o.out.forEach(r(o))}return t.filter(o=>!o.merged).map(o=>eh.pick(o,["vs","i","barycenter","weight"]))}function oh(e,t){let n=0,r=0;e.weight&&(n+=e.barycenter*e.weight,r+=e.weight),t.weight&&(n+=t.barycenter*t.weight,r+=t.weight),e.vs=t.vs.concat(e.vs),e.barycenter=n/r,e.weight=r,e.i=Math.min(t.i,e.i),t.merged=!0}let ih=se;var sh=ah;function ah(e,t){let n=ih.partition(e,u=>Object.hasOwn(u,"barycenter")),r=n.lhs,o=n.rhs.sort((u,d)=>d.i-u.i),i=[],s=0,a=0,c=0;r.sort(ch(!!t)),c=Ir(i,o,c),r.forEach(u=>{c+=u.vs.length,i.push(u.vs),s+=u.barycenter*u.weight,a+=u.weight,c=Ir(i,o,c)});let l={vs:i.flat(!0)};return a&&(l.barycenter=s/a,l.weight=a),l}function Ir(e,t,n){let r;for(;t.length&&(r=t[t.length-1]).i<=n;)t.pop(),e.push(r.vs),n++;return n}function ch(e){return(t,n)=>t.barycenter<n.barycenter?-1:t.barycenter>n.barycenter?1:e?n.i-t.i:t.i-n.i}let lh=Qf,uh=th,dh=sh;var fh=Si;function Si(e,t,n,r){let o=e.children(t),i=e.node(t),s=i?i.borderLeft:void 0,a=i?i.borderRight:void 0,c={};s&&(o=o.filter(f=>f!==s&&f!==a));let l=lh(e,o);l.forEach(f=>{if(e.children(f.v).length){let h=Si(e,f.v,n,r);c[f.v]=h,Object.hasOwn(h,"barycenter")&&gh(f,h)}});let u=uh(l,n);hh(u,c);let d=dh(u,r);if(s&&(d.vs=[s,d.vs,a].flat(!0),e.predecessors(s).length)){let f=e.node(e.predecessors(s)[0]),h=e.node(e.predecessors(a)[0]);Object.hasOwn(d,"barycenter")||(d.barycenter=0,d.weight=0),d.barycenter=(d.barycenter*d.weight+f.order+h.order)/(d.weight+2),d.weight+=2}return d}function hh(e,t){e.forEach(n=>{n.vs=n.vs.flatMap(r=>t[r]?t[r].vs:r)})}function gh(e,t){e.barycenter!==void 0?(e.barycenter=(e.barycenter*e.weight+t.barycenter*t.weight)/(e.weight+t.weight),e.weight+=t.weight):(e.barycenter=t.barycenter,e.weight=t.weight)}let ph=fe.Graph,mh=se;var yh=wh;function wh(e,t,n){let r=xh(e),o=new ph({compound:!0}).setGraph({root:r}).setDefaultNodeLabel(i=>e.node(i));return e.nodes().forEach(i=>{let s=e.node(i),a=e.parent(i);(s.rank===t||s.minRank<=t&&t<=s.maxRank)&&(o.setNode(i),o.setParent(i,a||r),e[n](i).forEach(c=>{let l=c.v===i?c.w:c.v,u=o.edge(l,i),d=u!==void 0?u.weight:0;o.setEdge(l,i,{weight:e.edge(c).weight+d})}),Object.hasOwn(s,"minRank")&&o.setNode(i,{borderLeft:s.borderLeft[t],borderRight:s.borderRight[t]}))}),o}function xh(e){for(var t;e.hasNode(t=mh.uniqueId("_root")););return t}var bh=vh;function vh(e,t,n){let r={},o;n.forEach(i=>{let s=e.parent(i),a,c;for(;s;){if(a=e.parent(s),a?(c=r[a],r[a]=s):(c=o,o=s),c&&c!==s){t.setEdge(c,s);return}s=a}})}let Eh=Wf,Nh=Uf,_h=fh,Sh=yh,kh=bh,Ch=fe.Graph,dt=se;var Mh=ki;function ki(e,t){if(t&&typeof t.customOrder=="function"){t.customOrder(e,ki);return}let n=dt.maxRank(e),r=$r(e,dt.range(1,n+1),"inEdges"),o=$r(e,dt.range(n-1,-1,-1),"outEdges"),i=Eh(e);if(Lr(e,i),t&&t.disableOptimalOrderHeuristic)return;let s=Number.POSITIVE_INFINITY,a;for(let c=0,l=0;l<4;++c,++l){Ih(c%2?r:o,c%4>=2),i=dt.buildLayerMatrix(e);let u=Nh(e,i);u<s&&(l=0,a=Object.assign({},i),s=u)}Lr(e,a)}function $r(e,t,n){return t.map(function(r){return Sh(e,r,n)})}function Ih(e,t){let n=new Ch;e.forEach(function(r){let o=r.graph().root,i=_h(r,o,n,t);i.vs.forEach((s,a)=>r.node(s).order=a),kh(r,n,i.vs)})}function Lr(e,t){Object.values(t).forEach(n=>n.forEach((r,o)=>e.node(r).order=o))}let $h=fe.Graph,me=se;var Lh={positionX:Bh};function Ph(e,t){let n={};function r(o,i){let s=0,a=0,c=o.length,l=i[i.length-1];return i.forEach((u,d)=>{let f=jh(e,u),h=f?e.node(f).order:c;(f||u===l)&&(i.slice(a,d+1).forEach(p=>{e.predecessors(p).forEach(m=>{let x=e.node(m),y=x.order;(y<s||h<y)&&!(x.dummy&&e.node(p).dummy)&&Ci(n,m,p)})}),a=d+1,s=h)}),i}return t.length&&t.reduce(r),n}function Oh(e,t){let n={};function r(i,s,a,c,l){let u;me.range(s,a).forEach(d=>{u=i[d],e.node(u).dummy&&e.predecessors(u).forEach(f=>{let h=e.node(f);h.dummy&&(h.order<c||h.order>l)&&Ci(n,f,u)})})}function o(i,s){let a=-1,c,l=0;return s.forEach((u,d)=>{if(e.node(u).dummy==="border"){let f=e.predecessors(u);f.length&&(c=e.node(f[0]).order,r(s,l,d,a,c),l=d,a=c)}r(s,l,s.length,c,i.length)}),s}return t.length&&t.reduce(o),n}function jh(e,t){if(e.node(t).dummy)return e.predecessors(t).find(n=>e.node(n).dummy)}function Ci(e,t,n){if(t>n){let o=t;t=n,n=o}let r=e[t];r||(e[t]=r={}),r[n]=!0}function Th(e,t,n){if(t>n){let r=t;t=n,n=r}return!!e[t]&&Object.hasOwn(e[t],n)}function Ah(e,t,n,r){let o={},i={},s={};return t.forEach(a=>{a.forEach((c,l)=>{o[c]=c,i[c]=c,s[c]=l})}),t.forEach(a=>{let c=-1;a.forEach(l=>{let u=r(l);if(u.length){u=u.sort((f,h)=>s[f]-s[h]);let d=(u.length-1)/2;for(let f=Math.floor(d),h=Math.ceil(d);f<=h;++f){let p=u[f];i[l]===l&&c<s[p]&&!Th(n,l,p)&&(i[p]=l,i[l]=o[l]=o[p],c=s[p])}}})}),{root:o,align:i}}function Dh(e,t,n,r,o){let i={},s=Rh(e,t,n,o),a=o?"borderLeft":"borderRight";function c(d,f){let h=s.nodes(),p=h.pop(),m={};for(;p;)m[p]?d(p):(m[p]=!0,h.push(p),h=h.concat(f(p))),p=h.pop()}function l(d){i[d]=s.inEdges(d).reduce((f,h)=>Math.max(f,i[h.v]+s.edge(h)),0)}function u(d){let f=s.outEdges(d).reduce((p,m)=>Math.min(p,i[m.w]-s.edge(m)),Number.POSITIVE_INFINITY),h=e.node(d);f!==Number.POSITIVE_INFINITY&&h.borderType!==a&&(i[d]=Math.max(i[d],f))}return c(l,s.predecessors.bind(s)),c(u,s.successors.bind(s)),Object.keys(r).forEach(d=>i[d]=i[n[d]]),i}function Rh(e,t,n,r){let o=new $h,i=e.graph(),s=Fh(i.nodesep,i.edgesep,r);return t.forEach(a=>{let c;a.forEach(l=>{let u=n[l];if(o.setNode(u),c){var d=n[c],f=o.edge(d,u);o.setEdge(d,u,Math.max(s(e,l,c),f||0))}c=l})}),o}function zh(e,t){return Object.values(t).reduce((n,r)=>{let o=Number.NEGATIVE_INFINITY,i=Number.POSITIVE_INFINITY;Object.entries(r).forEach(([a,c])=>{let l=Yh(e,a)/2;o=Math.max(c+l,o),i=Math.min(c-l,i)});const s=o-i;return s<n[0]&&(n=[s,r]),n},[Number.POSITIVE_INFINITY,null])[1]}function Hh(e,t){let n=Object.values(t),r=me.applyWithChunking(Math.min,n),o=me.applyWithChunking(Math.max,n);["u","d"].forEach(i=>{["l","r"].forEach(s=>{let a=i+s,c=e[a];if(c===t)return;let l=Object.values(c),u=r-me.applyWithChunking(Math.min,l);s!=="l"&&(u=o-me.applyWithChunking(Math.max,l)),u&&(e[a]=me.mapValues(c,d=>d+u))})})}function Vh(e,t){return me.mapValues(e.ul,(n,r)=>{if(t)return e[t.toLowerCase()][r];{let o=Object.values(e).map(i=>i[r]).sort((i,s)=>i-s);return(o[1]+o[2])/2}})}function Bh(e){let t=me.buildLayerMatrix(e),n=Object.assign(Ph(e,t),Oh(e,t)),r={},o;["u","d"].forEach(s=>{o=s==="u"?t:Object.values(t).reverse(),["l","r"].forEach(a=>{a==="r"&&(o=o.map(d=>Object.values(d).reverse()));let c=(s==="u"?e.predecessors:e.successors).bind(e),l=Ah(e,o,n,c),u=Dh(e,o,l.root,l.align,a==="r");a==="r"&&(u=me.mapValues(u,d=>-d)),r[s+a]=u})});let i=zh(e,r);return Hh(r,i),Vh(r,e.graph().align)}function Fh(e,t,n){return(r,o,i)=>{let s=r.node(o),a=r.node(i),c=0,l;if(c+=s.width/2,Object.hasOwn(s,"labelpos"))switch(s.labelpos.toLowerCase()){case"l":l=-s.width/2;break;case"r":l=s.width/2;break}if(l&&(c+=n?l:-l),l=0,c+=(s.dummy?t:e)/2,c+=(a.dummy?t:e)/2,c+=a.width/2,Object.hasOwn(a,"labelpos"))switch(a.labelpos.toLowerCase()){case"l":l=a.width/2;break;case"r":l=-a.width/2;break}return l&&(c+=n?l:-l),l=0,c}}function Yh(e,t){return e.node(t).width}let Mi=se,Gh=Lh.positionX;var Wh=Xh;function Xh(e){e=Mi.asNonCompoundGraph(e),qh(e),Object.entries(Gh(e)).forEach(([t,n])=>e.node(t).x=n)}function qh(e){let t=Mi.buildLayerMatrix(e),n=e.graph().ranksep,r=0;t.forEach(o=>{const i=o.reduce((s,a)=>{const c=e.node(a).height;return s>c?s:c},0);o.forEach(s=>e.node(s).y=r+i/2),r+=i+n})}let Pr=Ud,Or=ef,Uh=Sf,Kh=se.normalizeRanks,Zh=If,Qh=se.removeEmptyRanks,jr=Of,Jh=zf,Tr=Vf,eg=Mh,tg=Wh,le=se,ng=fe.Graph;var rg=og;function og(e,t){let n=t&&t.debugTiming?le.time:le.notime;n("layout",()=>{let r=n("  buildLayoutGraph",()=>gg(e));n("  runLayout",()=>ig(r,n,t)),n("  updateInputGraph",()=>sg(e,r))})}function ig(e,t,n){t("    makeSpaceForEdgeLabels",()=>pg(e)),t("    removeSelfEdges",()=>_g(e)),t("    acyclic",()=>Pr.run(e)),t("    nestingGraph.run",()=>jr.run(e)),t("    rank",()=>Uh(le.asNonCompoundGraph(e))),t("    injectEdgeLabelProxies",()=>mg(e)),t("    removeEmptyRanks",()=>Qh(e)),t("    nestingGraph.cleanup",()=>jr.cleanup(e)),t("    normalizeRanks",()=>Kh(e)),t("    assignRankMinMax",()=>yg(e)),t("    removeEdgeLabelProxies",()=>wg(e)),t("    normalize.run",()=>Or.run(e)),t("    parentDummyChains",()=>Zh(e)),t("    addBorderSegments",()=>Jh(e)),t("    order",()=>eg(e,n)),t("    insertSelfEdges",()=>Sg(e)),t("    adjustCoordinateSystem",()=>Tr.adjust(e)),t("    position",()=>tg(e)),t("    positionSelfEdges",()=>kg(e)),t("    removeBorderNodes",()=>Ng(e)),t("    normalize.undo",()=>Or.undo(e)),t("    fixupEdgeLabelCoords",()=>vg(e)),t("    undoCoordinateSystem",()=>Tr.undo(e)),t("    translateGraph",()=>xg(e)),t("    assignNodeIntersects",()=>bg(e)),t("    reversePoints",()=>Eg(e)),t("    acyclic.undo",()=>Pr.undo(e))}function sg(e,t){e.nodes().forEach(n=>{let r=e.node(n),o=t.node(n);r&&(r.x=o.x,r.y=o.y,r.rank=o.rank,t.children(n).length&&(r.width=o.width,r.height=o.height))}),e.edges().forEach(n=>{let r=e.edge(n),o=t.edge(n);r.points=o.points,Object.hasOwn(o,"x")&&(r.x=o.x,r.y=o.y)}),e.graph().width=t.graph().width,e.graph().height=t.graph().height}let ag=["nodesep","edgesep","ranksep","marginx","marginy"],cg={ranksep:50,edgesep:20,nodesep:50,rankdir:"tb"},lg=["acyclicer","ranker","rankdir","align"],ug=["width","height","rank"],Ar={width:0,height:0},dg=["minlen","weight","width","height","labeloffset"],fg={minlen:1,weight:1,width:0,height:0,labeloffset:10,labelpos:"r"},hg=["labelpos"];function gg(e){let t=new ng({multigraph:!0,compound:!0}),n=Zt(e.graph());return t.setGraph(Object.assign({},cg,Kt(n,ag),le.pick(n,lg))),e.nodes().forEach(r=>{let o=Zt(e.node(r));const i=Kt(o,ug);Object.keys(Ar).forEach(s=>{i[s]===void 0&&(i[s]=Ar[s])}),t.setNode(r,i),t.setParent(r,e.parent(r))}),e.edges().forEach(r=>{let o=Zt(e.edge(r));t.setEdge(r,Object.assign({},fg,Kt(o,dg),le.pick(o,hg)))}),t}function pg(e){let t=e.graph();t.ranksep/=2,e.edges().forEach(n=>{let r=e.edge(n);r.minlen*=2,r.labelpos.toLowerCase()!=="c"&&(t.rankdir==="TB"||t.rankdir==="BT"?r.width+=r.labeloffset:r.height+=r.labeloffset)})}function mg(e){e.edges().forEach(t=>{let n=e.edge(t);if(n.width&&n.height){let r=e.node(t.v),i={rank:(e.node(t.w).rank-r.rank)/2+r.rank,e:t};le.addDummyNode(e,"edge-proxy",i,"_ep")}})}function yg(e){let t=0;e.nodes().forEach(n=>{let r=e.node(n);r.borderTop&&(r.minRank=e.node(r.borderTop).rank,r.maxRank=e.node(r.borderBottom).rank,t=Math.max(t,r.maxRank))}),e.graph().maxRank=t}function wg(e){e.nodes().forEach(t=>{let n=e.node(t);n.dummy==="edge-proxy"&&(e.edge(n.e).labelRank=n.rank,e.removeNode(t))})}function xg(e){let t=Number.POSITIVE_INFINITY,n=0,r=Number.POSITIVE_INFINITY,o=0,i=e.graph(),s=i.marginx||0,a=i.marginy||0;function c(l){let u=l.x,d=l.y,f=l.width,h=l.height;t=Math.min(t,u-f/2),n=Math.max(n,u+f/2),r=Math.min(r,d-h/2),o=Math.max(o,d+h/2)}e.nodes().forEach(l=>c(e.node(l))),e.edges().forEach(l=>{let u=e.edge(l);Object.hasOwn(u,"x")&&c(u)}),t-=s,r-=a,e.nodes().forEach(l=>{let u=e.node(l);u.x-=t,u.y-=r}),e.edges().forEach(l=>{let u=e.edge(l);u.points.forEach(d=>{d.x-=t,d.y-=r}),Object.hasOwn(u,"x")&&(u.x-=t),Object.hasOwn(u,"y")&&(u.y-=r)}),i.width=n-t+s,i.height=o-r+a}function bg(e){e.edges().forEach(t=>{let n=e.edge(t),r=e.node(t.v),o=e.node(t.w),i,s;n.points?(i=n.points[0],s=n.points[n.points.length-1]):(n.points=[],i=o,s=r),n.points.unshift(le.intersectRect(r,i)),n.points.push(le.intersectRect(o,s))})}function vg(e){e.edges().forEach(t=>{let n=e.edge(t);if(Object.hasOwn(n,"x"))switch((n.labelpos==="l"||n.labelpos==="r")&&(n.width-=n.labeloffset),n.labelpos){case"l":n.x-=n.width/2+n.labeloffset;break;case"r":n.x+=n.width/2+n.labeloffset;break}})}function Eg(e){e.edges().forEach(t=>{let n=e.edge(t);n.reversed&&n.points.reverse()})}function Ng(e){e.nodes().forEach(t=>{if(e.children(t).length){let n=e.node(t),r=e.node(n.borderTop),o=e.node(n.borderBottom),i=e.node(n.borderLeft[n.borderLeft.length-1]),s=e.node(n.borderRight[n.borderRight.length-1]);n.width=Math.abs(s.x-i.x),n.height=Math.abs(o.y-r.y),n.x=i.x+n.width/2,n.y=r.y+n.height/2}}),e.nodes().forEach(t=>{e.node(t).dummy==="border"&&e.removeNode(t)})}function _g(e){e.edges().forEach(t=>{if(t.v===t.w){var n=e.node(t.v);n.selfEdges||(n.selfEdges=[]),n.selfEdges.push({e:t,label:e.edge(t)}),e.removeEdge(t)}})}function Sg(e){var t=le.buildLayerMatrix(e);t.forEach(n=>{var r=0;n.forEach((o,i)=>{var s=e.node(o);s.order=i+r,(s.selfEdges||[]).forEach(a=>{le.addDummyNode(e,"selfedge",{width:a.label.width,height:a.label.height,rank:s.rank,order:i+ ++r,e:a.e,label:a.label},"_se")}),delete s.selfEdges})})}function kg(e){e.nodes().forEach(t=>{var n=e.node(t);if(n.dummy==="selfedge"){var r=e.node(n.e.v),o=r.x+r.width/2,i=r.y,s=n.x-o,a=r.height/2;e.setEdge(n.e,n.label),e.removeNode(t),n.label.points=[{x:o+2*s/3,y:i-a},{x:o+5*s/6,y:i-a},{x:o+s,y:i},{x:o+5*s/6,y:i+a},{x:o+2*s/3,y:i+a}],n.label.x=n.x,n.label.y=n.y}})}function Kt(e,t){return le.mapValues(le.pick(e,t),Number)}function Zt(e){var t={};return e&&Object.entries(e).forEach(([n,r])=>{typeof n=="string"&&(n=n.toLowerCase()),t[n]=r}),t}let Cg=se,Mg=fe.Graph;var Ig={debugOrdering:$g};function $g(e){let t=Cg.buildLayerMatrix(e),n=new Mg({compound:!0,multigraph:!0}).setGraph({});return e.nodes().forEach(r=>{n.setNode(r,{label:r}),n.setParent(r,"layer"+e.node(r).rank)}),e.edges().forEach(r=>n.setEdge(r.v,r.w,{},r.name)),t.forEach((r,o)=>{let i="layer"+o;n.setNode(i,{rank:"same"}),r.reduce((s,a)=>(n.setEdge(s,a,{style:"invis"}),a))}),n}var Lg="1.1.5",Pg={graphlib:fe,layout:rg,debug:Ig,util:{time:se.time,notime:se.notime},version:Lg};const Wg=Dr(Pg);export{Hg as B,be as C,yt as H,ht as M,W as P,Mo as a,Io as b,Vg as c,Wg as d,Bg as e,zg as f,Dg as i,Rg as u};
