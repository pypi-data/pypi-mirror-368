"use strict";(self.webpackChunk_atoti_jupyterlab_extension=self.webpackChunk_atoti_jupyterlab_extension||[]).push([[3302],{10792:(e,t,n)=>{n.d(t,{V:()=>h});var i=n(31529),a=n(93345),r=n(95889),o=n(55418),s=n(96735),d=n(55629),u=n(69682),l=n(79225),c=n(30531),g=n(62854);const p=(e,t)=>{const n=(0,i.findKey)(e,(e=>"primaryOrdinal"===e.role)),a=n?t[n]:void 0;return a?a.at(-1):void 0};var m=n(90147);function h({cube:e,widgetState:t,onWidgetChange:n}){const h=function({cube:e,widgetState:t,onWidgetChange:n}){const{formatMessage:o}=(0,r.useIntl)(),s=(0,l.DP)(),[p]=(0,u.useWidgetPlugins)([t.widgetKey]),h=(0,a.useRef)(t),x=(0,a.useRef)(`expand-button-${(0,c.Y)()}`);(0,a.useEffect)((()=>{h.current=t}),[t]);const{attributes:f={}}=p,w=t.query.mdx,v=(0,a.useMemo)((()=>{if(!w)return;const e=(0,g.y)("primaryOrdinal",w);return(0,d.getAxisByName)(w,e)}),[w]);if(!v)return;const y=(0,i.findKey)(f,(e=>"primaryOrdinal"===e.role)),b=y?t.mapping[y]:void 0;if(void 0===(b?b.at(-1):void 0))return;if(!(0,d.getLevels)(v,{cube:e}).at(-1))return;const C=t.isInExpandMode?s.textColor:s.disabledTextColor,I={width:500,height:600,svg:`\n      <svg width="13" height="14" viewBox="0 0 13 14" fill="none" xmlns="http://www.w3.org/2000/svg">\n        <style>\n            a[data-attr="${x.current}"] {\n              cursor:"pointer" !important;\n            }\n        </style>\n        <path d="M12.0007 6.52222H0.416495C0.0690387 6.52222 -0.124973 6.88907 0.0902035 7.13953L5.88233 13.8558C6.04812 14.0481 6.36735 14.0481 6.53491 13.8558L12.327 7.13953C12.5422 6.88907 12.3482 6.52222 12.0007 6.52222Z" fill="${C}"/>\n        <rect x="3.51196" width="5.51877" height="6.5256" rx="1" fill="${C}"/>\n      </svg>`};return{title:o({id:`aui.switch${t.isInExpandMode?"Off":"On"}DrillDown`}),name:"expandMode-"+(t.isInExpandMode?"on":"off"),icon:I,attr:x.current,click:()=>{const e=(0,m.produce)(h.current,(e=>{e.isInExpandMode=!e.isInExpandMode}));n?.(e)}}}({cube:e,widgetState:t,onWidgetChange:n}),x=function({cube:e,onWidgetChange:t,widgetState:n}){const m=(0,l.DP)(),{formatMessage:h}=(0,r.useIntl)(),[x]=(0,u.useWidgetPlugins)([n.widgetKey]),f=(0,a.useRef)(`collapse-button-${(0,c.Y)()}`),w=(0,a.useRef)(n),v=(0,a.useRef)(void 0),y=(0,a.useMemo)((()=>p(x.attributes||{},n.mapping)),[x.attributes,n.mapping]),{mdx:b}=n.query,C=(0,a.useMemo)((()=>{if(!b)return;const e=(0,g.y)("primaryOrdinal",b);return e?(0,d.getAxisByName)(b,e):void 0}),[b]),I=(0,a.useMemo)((()=>{if(!b||!C)return;const t=(0,d.getExpandedTuples)(C,e),n=t.reduce(((e,{tupleCoordinates:t})=>(t.length>e&&(e=t.length),e)),0);return t.filter((({tupleCoordinates:e})=>e.length===n)).map((e=>e.tupleCoordinates))}),[b,e,C]);if((0,a.useEffect)((()=>{w.current=n}),[n]),(0,a.useEffect)((()=>{v.current=I}),[I]),!y)return;const M=void 0!==I&&0!==I.length;if(!C)return;const S=(0,d.getLevels)(C,{cube:e}).at(-1);if(!S)return;const{dimensionName:E,hierarchyName:N,levelName:$}=S,k=(0,o.q)({dimensionName:E,hierarchyName:N},e).levels,L=k[$].index,T=M?Object.keys(k).find((e=>k[e].index===L-1)):void 0,W=M?h({id:"aui.goUp"},{levelName:T}):h({id:"aui.cannotGoUp"},{hierarchyName:N,levelName:$});return{icon:{width:500,height:600,svg:`\n        <svg width="13" height="14" viewBox="0 0 13 14" fill="none" xmlns="http://www.w3.org/2000/svg" version="1.1" xmlns:xlink="http://www.w3.org/1999/xlink" transform="matrix(1,0,0,-1,0,0)">\n            <style>\n                a[data-attr="${f.current}"] {\n                  cursor: ${M?"pointer":"not-allowed"}!important;\n                }\n            </style>\n            <path d="M12.0007 6.52222H0.416495C0.0690387 6.52222 -0.124973 6.88907 0.0902035 7.13953L5.88233 13.8558C6.04812 14.0481 6.36735 14.0481 6.53491 13.8558L12.327 7.13953C12.5422 6.88907 12.3482 6.52222 12.0007 6.52222Z" fill="${m.disabledTextColor}"></path>\n            <rect x="3.51196" width="5.51877" height="6.5256" rx="1" fill="${m.disabledTextColor}"></rect>\n        </svg>\n        `},title:W,name:"collapse"+(M?"":"-disabled"),click:M?()=>{const n=v.current,i=w.current;if(!n)return;const a=n.reduce(((t,n)=>(0,s.s)({cube:e,tupleCoordinates:n,widgetState:t})),i);t?.(a)}:i.noop,attr:f.current}}({cube:e,widgetState:t,onWidgetChange:n});return{modeBarButtonsToAdd:[x,h].filter((e=>void 0!==e))}}},24489:(e,t,n)=>{n.d(t,{_:()=>d});var i=n(93345),a=n(44494),r=n(38958),o=n(24706),s=n(62854);function d({cube:e,data:t,traces:n,widgetState:d,onWidgetChange:u}){const{mdx:l}=d.query,c=n[0].cellsIndices,g=(0,i.useMemo)((()=>l&&(0,s.y)("primaryOrdinal",l)),[l]);return(n,i)=>{const{pointIndex:s}=i,l=c[s]||[],{rowIndex:p,columnIndex:m}=l[0],h=g?(0,a.getHierarchyIndicesInCellSet)(t,{axisNames:[g]}):{},x=(0,a.getTuple)({columnIndex:m,data:t,hierarchyIndicesInCellSet:h,rowIndex:p});if(!x)throw new Error(`Could not find the corresponding tuple for the trace at index ${s}.`);const f=(0,a.trimTrailingTotals)(x,e);if(!f.at(-1))throw new Error("Cannot expand an empty tuple");const w=(0,r.J)({cube:e,mapping:d.mapping,tuple:x}),v=(0,o.N)({cube:e,toLevel:w,tupleCoordinates:f,widgetState:d});u?.(v)}}},63302:(e,t,n)=>{n.r(t),n.d(t,{default:()=>M});var i=n(74389),a=n(32810),r=n.n(a),o=n(93280),s=n.n(o),d=n(93345),u=n(95889),l=n(19926),c=n(10792),g=n(24489),p=n(37309),m=n(86437),h=n(76747),x=n(77903),f=n(41479),w=n(95917),v=n(49455),y=n(11477),b=n(72112);const C={xaxis:"xAxis",yaxis:"values"};var I=n(68619);s().register(r());const M=(0,h.withLoadingOverlay)((0,h.withoutIrrelevantRenders)((0,l.c)((0,d.memo)((e=>{const{cube:t,data:n,metaData:a,widgetState:r}=e,{formatMessage:o}=(0,u.useIntl)(),[s]=(0,m.i)("style.members"),l=o({id:"aui.total"}),h=(0,d.useMemo)((()=>(0,I.Y)({cube:t,data:n,metaData:a,widgetState:r,captionForTotals:l,userTupleStyles:s})),[t,n,a,r,l,s]),M=(0,d.useMemo)((()=>((e,t)=>{if(!e)return{};let n=(0,b.Z)({barmode:"relative",xaxis:{gridcolor:"transparent"}},(0,x.w)(e.subplots),(0,f.M)(e.subplots,{fontSize:t?.style?.axisLabelFontSize}),(0,w.u)(e,"xaxis"),(0,v.U)(t,C));return n=(0,y.C)(n,{axes:["xaxis","yaxis"],fontSize:t?.style?.axisLabelFontSize}),n})(a,r)),[a,r]),S=(0,c.V)({widgetState:r,onWidgetChange:e.onChange,cube:t}),E=(0,g._)({cube:t,data:n,traces:h,widgetState:r,onWidgetChange:e.onChange});return(0,i.Y)(p.Kl,{...e,onClick:r.isInExpandMode?E:void 0,config:S,traces:h,layout:M,cube:t,data:n,metaData:a})})))))}}]);