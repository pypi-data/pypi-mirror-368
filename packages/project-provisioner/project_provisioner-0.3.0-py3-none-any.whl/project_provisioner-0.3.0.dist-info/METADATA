Metadata-Version: 2.4
Name: project-provisioner
Version: 0.3.0
Summary: Uma ferramenta CLI para provisionar automaticamente novos projetos de dados no Azure DevOps e Databricks com integraÃ§Ã£o completa ao Azure CLI.
Home-page: https://github.com/joseamaro/project-provisioner
Author: Jose Amaro
Author-email: jose.amarodev@gmail.com
Project-URL: Bug Reports, https://github.com/joseamaro/project-provisioner/issues
Project-URL: Source, https://github.com/joseamaro/project-provisioner
Keywords: databricks azure devops cli automation azure-cli
Classifier: Development Status :: 3 - Alpha
Classifier: Intended Audience :: Developers
Classifier: License :: OSI Approved :: MIT License
Classifier: Programming Language :: Python :: 3
Classifier: Programming Language :: Python :: 3.8
Classifier: Programming Language :: Python :: 3.9
Classifier: Programming Language :: Python :: 3.10
Classifier: Programming Language :: Python :: 3.11
Classifier: Programming Language :: Python :: 3.12
Classifier: Operating System :: OS Independent
Classifier: Topic :: Software Development :: Libraries :: Python Modules
Classifier: Topic :: System :: Systems Administration
Requires-Python: >=3.8
Description-Content-Type: text/markdown
Requires-Dist: click
Requires-Dist: PyYAML
Provides-Extra: dev
Requires-Dist: pytest>=7.0.0; extra == "dev"
Requires-Dist: pytest-cov>=4.0.0; extra == "dev"
Requires-Dist: pytest-mock>=3.10.0; extra == "dev"
Requires-Dist: black>=23.0.0; extra == "dev"
Requires-Dist: flake8>=6.0.0; extra == "dev"
Requires-Dist: mypy>=1.0.0; extra == "dev"
Dynamic: author
Dynamic: author-email
Dynamic: classifier
Dynamic: description
Dynamic: description-content-type
Dynamic: home-page
Dynamic: keywords
Dynamic: project-url
Dynamic: provides-extra
Dynamic: requires-dist
Dynamic: requires-python
Dynamic: summary

# Project Provisioner CLI

Uma ferramenta de linha de comando para automatizar o provisionamento de novos projetos de dados no Azure DevOps e Databricks.

## ğŸš€ InstalaÃ§Ã£o

```bash
pip install project-provisioner
```

## ğŸ“– Uso Simplificado

### Modo Interativo (Recomendado)
```bash
project-provisioner create-project --interactive
```

### Com Arquivo de ConfiguraÃ§Ã£o
```bash
# 1. Criar arquivo de configuraÃ§Ã£o
project-provisioner init

# 2. Editar o arquivo project-config.yaml

# 3. Executar provisionamento
project-provisioner create-project --config project-config.yaml
```

### Comando RÃ¡pido
```bash
project-provisioner create-project --project-name "meu-projeto" --organization "https://dev.azure.com/minha-org"
```

## ğŸ¯ Principais Melhorias

### âœ… **Antes (Complexo)**
```bash
project-provisioner create-project \
    --project-name "my-new-data-project" \
    --azure-devops-organization-url "https://dev.azure.com/your_organization" \
    --azure-devops-project-name "YourExistingAzureDevOpsProject" \
    --azure-devops-pat "YOUR_AZURE_DEVOPS_PAT" \
    --azure-devops-username "your_azure_devops_username" \
    --resource-group-name "rg-databricks-projects" \
    --location "eastus" \
    --databricks-workspace-name "dbr-ws-new-project" \
    --databricks-sku "premium" \
    --databricks-pat "YOUR_DATABRICKS_PAT" \
    --scaffold-source-path "/path/to/your/scaffold/template"
```

### âœ… **Agora (Simples)**
```bash
project-provisioner create-project --interactive
```

## ğŸ”§ Funcionalidades

### Modo Interativo
- âœ… Perguntas guiadas para configuraÃ§Ã£o
- âœ… Valores padrÃ£o inteligentes
- âœ… ValidaÃ§Ã£o automÃ¡tica
- âœ… Interface amigÃ¡vel

### Arquivo de ConfiguraÃ§Ã£o
- âœ… Template YAML gerado automaticamente
- âœ… ConfiguraÃ§Ã£o reutilizÃ¡vel
- âœ… FÃ¡cil ediÃ§Ã£o e versionamento

### Valores PadrÃ£o Inteligentes
- âœ… Nomes gerados automaticamente
- âœ… RegiÃ£o padrÃ£o: `brazilsouth`
- âœ… SKU padrÃ£o: `premium`
- âœ… UsuÃ¡rio detectado automaticamente

## ğŸ“‹ Exemplo de Arquivo de ConfiguraÃ§Ã£o

```yaml
project_name: meu-projeto-dados
azure_devops_organization_url: https://dev.azure.com/sua-organizacao
azure_devops_project_name: DataProjects
azure_devops_pat: SEU_PAT_AQUI
azure_devops_username: seu-usuario
resource_group_name: rg-meu-projeto-dados
location: brazilsouth
databricks_workspace_name: dbr-meu-projeto-dados
databricks_sku: premium
databricks_pat: SEU_DATABRICKS_PAT_AQUI
scaffold_source_path: /caminho/para/seu/scaffold
```

## ğŸ¯ Comandos DisponÃ­veis

```bash
# Inicializar novo projeto com estrutura scaffold
project-provisioner init

# Inicializar apenas arquivo de configuraÃ§Ã£o 
project-provisioner init --config-only

# Pular verificaÃ§Ã£o e configuraÃ§Ã£o do Azure CLI
project-provisioner init --skip-azure-cli

# Mostrar informaÃ§Ãµes do Azure CLI
project-provisioner show-azure-info

# Mostrar informaÃ§Ãµes e salvar no arquivo YAML
project-provisioner show-azure-info --save-config

# Criar projeto (modo interativo)
project-provisioner create-project --interactive

# Criar projeto com arquivo de configuraÃ§Ã£o
project-provisioner create-project --config config.yaml

# Criar projeto com parÃ¢metros mÃ­nimos
project-provisioner create-project --project-name "meu-projeto"

# Criar projeto usando dados do Azure CLI
project-provisioner create-project --interactive --user-id "user@domain.com"

# Ver ajuda
project-provisioner --help
```

## ğŸ”§ VerificaÃ§Ã£o AutomÃ¡tica do Azure CLI

A partir da versÃ£o **0.3.0**, o comando `init` inclui verificaÃ§Ã£o e configuraÃ§Ã£o automÃ¡tica do Azure CLI:

### âœ… **O que Ã© verificado automaticamente:**
- ğŸ” **InstalaÃ§Ã£o**: Detecta se o Azure CLI estÃ¡ instalado na mÃ¡quina
- ğŸ“¦ **InstalaÃ§Ã£o AutomÃ¡tica**: Oferece instalar automaticamente se nÃ£o estiver presente
- ğŸ” **Login**: Verifica se o usuÃ¡rio estÃ¡ logado no Azure CLI
- ğŸŒ **Login AutomÃ¡tico**: Oferece fazer login via navegador se necessÃ¡rio

### ğŸ–¥ï¸ **Suporte Multi-Plataforma:**
- **macOS**: InstalaÃ§Ã£o via Homebrew ou script oficial
- **Linux**: DetecÃ§Ã£o automÃ¡tica de distribuiÃ§Ã£o (Ubuntu/Debian, CentOS/RHEL/Fedora)
- **Windows**: InstruÃ§Ãµes para instalaÃ§Ã£o manual ou via winget

### ğŸ“‹ **Exemplo de Fluxo AutomÃ¡tico:**
```bash
$ project-provisioner init

ğŸš€ Inicializando Novo Projeto
========================================

ğŸ” Verificando Azure CLI...
âŒ Azure CLI nÃ£o estÃ¡ instalado
Deseja instalar o Azure CLI agora? [Y/n]: y

ğŸ”„ Instalando Azure CLI...
ğŸ“¦ Instalando via Homebrew...
âœ… Azure CLI instalado com sucesso!

ğŸ” Ã‰ necessÃ¡rio fazer login no Azure CLI
Deseja fazer login agora? [Y/n]: y
ğŸ”„ Abrindo navegador para login...
âœ… Login realizado com sucesso!

ğŸ“ Projeto: meu-projeto
ğŸ“ Local: /Users/user/meu-projeto
...
```

### âš™ï¸ **OpÃ§Ãµes de Controle:**
```bash
# Comportamento padrÃ£o (com verificaÃ§Ã£o do Azure CLI)
project-provisioner init

# Pular verificaÃ§Ã£o do Azure CLI (se necessÃ¡rio)
project-provisioner init --skip-azure-cli

# Outros comandos existentes continuam funcionando
project-provisioner init --project-name "meu-projeto" --config-only
```

### ğŸš¨ **Tratamento de Erros:**
- âœ… Continua o processo mesmo se a instalaÃ§Ã£o do Azure CLI falhar
- âœ… Funciona normalmente sem Azure CLI (usando configuraÃ§Ã£o padrÃ£o)
- âœ… Mensagens informativas sobre o status e prÃ³ximos passos
- âœ… Graceful fallback para configuraÃ§Ã£o manual quando necessÃ¡rio

## ğŸ” IntegraÃ§Ã£o com Azure CLI

A ferramenta agora pode obter automaticamente dados do Azure CLI para preencher configuraÃ§Ãµes:

### âœ… **Dados Obtidos Automaticamente**
- **Azure Account**: Tenant ID, Subscription ID, usuÃ¡rio logado
- **Azure DevOps**: OrganizaÃ§Ã£o padrÃ£o, projetos disponÃ­veis
- **Databricks**: Workspaces existentes, localizaÃ§Ãµes, SKUs
- **Resource Groups**: Grupos de recursos disponÃ­veis

### âœ… **Como Usar**
```bash
# 1. Inicializar novo projeto (NOVO!)
project-provisioner init

# 2. Verificar e salvar dados do Azure CLI (NOVO!)
project-provisioner show-azure-info --save-config

# 3. Criar projeto usando configuraÃ§Ã£o
project-provisioner create-project --config project-config.yaml

# OU modo interativo com dados do Azure CLI
project-provisioner create-project --interactive

# Com usuÃ¡rio especÃ­fico
project-provisioner create-project --interactive --user-id "user@domain.com"
```

### âœ… **BenefÃ­cios**
- âœ… **Scaffold AutomÃ¡tico**: CriaÃ§Ã£o de estrutura completa de pastas
- âœ… **Preenchimento AutomÃ¡tico**: Dados do Azure CLI salvos no YAML
- âœ… **Fluxo Simplificado**: `init` â†’ `show-azure-info --save-config` â†’ `create-project`
- âœ… Lista de projetos Azure DevOps disponÃ­veis
- âœ… Lista de workspaces Databricks existentes
- âœ… DetecÃ§Ã£o automÃ¡tica de localizaÃ§Ã£o e SKU
- âœ… ValidaÃ§Ã£o de permissÃµes e recursos

## ğŸš€ **Novo Fluxo de Trabalho Simplificado**

### **1. InicializaÃ§Ã£o do Projeto**
```bash
project-provisioner init
```
**O que faz:**
- Pergunta o nome do projeto interativamente
- Cria estrutura completa de pastas scaffold:
  - `src/` (databricks, python, sql)
  - `tests/` (unit, integration)
  - `config/` (ambientes)
  - `docs/`, `scripts/`, `infrastructure/`
- Gera arquivos essenciais (README.md, requirements.txt, .gitignore)
- Tenta obter dados do Azure CLI automaticamente
- Cria arquivo `project-config.yaml` prÃ©-preenchido

### **2. ConfiguraÃ§Ã£o AutomÃ¡tica com Azure CLI**
```bash
project-provisioner show-azure-info --save-config
```
**O que faz:**
- ObtÃ©m dados da conta Azure logada
- Lista projetos Azure DevOps disponÃ­veis
- Lista workspaces Databricks existentes
- **Salva tudo automaticamente no project-config.yaml**
- Mostra quais dados ainda precisam ser configurados

### **3. Provisionamento Final**
```bash
project-provisioner create-project --config project-config.yaml
```
**O que faz:**
- Usa configuraÃ§Ã£o prÃ©-preenchida
- Cria repositÃ³rio no Azure DevOps
- Configura workspace Databricks
- Faz deploy do scaffold criado

### **ğŸ“‹ Exemplo Completo de Uso**
```bash
# 1. Inicializar novo projeto
$ project-provisioner init
ğŸš€ Inicializando Novo Projeto
========================================
Nome do projeto [data-project-amaro]: meu-projeto-analise

ğŸ“ Projeto: meu-projeto-analise
ğŸ“ Local: /Users/amaro/meu-projeto-analise

ğŸ” Tentando obter dados do Azure CLI...
âœ… Dados do Azure CLI obtidos com sucesso!
âœ… Arquivo de configuraÃ§Ã£o criado: project-config.yaml

Deseja criar a estrutura de pastas do projeto scaffold? [Y/n]: Y
ğŸ“ Criando estrutura do projeto em: /Users/amaro/meu-projeto-analise
   âœ… src/
   âœ… src/databricks/
   âœ… src/databricks/notebooks/
   âœ… src/python/
   âœ… tests/
   âœ… config/
   âœ… docs/
   âœ… infrastructure/terraform/
   ... (estrutura completa criada)

ğŸ‰ Projeto 'meu-projeto-analise' inicializado com sucesso!

# 2. Verificar e salvar dados do Azure
$ project-provisioner show-azure-info --save-config
ğŸ” InformaÃ§Ãµes do Azure CLI
========================================
âœ… Dados do Azure CLI obtidos com sucesso!
   Tenant ID: 37cd273a-1cec-4aae-a297-41480ea54f8d
   OrganizaÃ§Ã£o DevOps: arcelormittal-corp
   Projetos disponÃ­veis: 3

âœ… ConfiguraÃ§Ã£o salva em: project-config.yaml
ğŸ“ Dados preenchidos automaticamente:
   - LocalizaÃ§Ã£o: brazilsouth
   - UsuÃ¡rio: amaro
   - OrganizaÃ§Ã£o Azure DevOps: https://dev.azure.com/arcelormittal-corp

ğŸ”‘ Ainda Ã© necessÃ¡rio configurar:
   - Personal Access Token do Azure DevOps
   - Personal Access Token do Databricks

# 3. Editar tokens no arquivo YAML
$ nano project-config.yaml  # Adicionar PATs

# 4. Executar provisionamento
$ project-provisioner create-project --config project-config.yaml
ğŸ”§ Provisionando projeto: meu-projeto-analise
ğŸ“¦ Criando repositÃ³rio no Azure DevOps...
ğŸ“Š Configurando workspace Databricks...
âœ… Provisionamento concluÃ­do com sucesso!
```

## ğŸ” VariÃ¡veis de Ambiente

Os PATs podem ser fornecidos via variÃ¡veis de ambiente:
- `AZURE_DEVOPS_PAT` - Personal Access Token do Azure DevOps
- `DATABRICKS_PAT` - Personal Access Token do Databricks

## ğŸ§ª Testes

### ExecuÃ§Ã£o RÃ¡pida
```bash
# Executar todos os testes
./run_tests.sh

# Ou executar manualmente
pytest tests/ -v
```

### Executar Testes EspecÃ­ficos
```bash
# Instalar dependÃªncias de desenvolvimento
pip install -e ".[dev]"

# Executar todos os testes
pytest

# Executar testes com cobertura
pytest --cov=project_provisioner --cov-report=term-missing

# Executar testes especÃ­ficos
pytest tests/test_cli.py
pytest tests/test_core.py
pytest tests/test_config.py

# Executar testes com relatÃ³rio HTML
pytest --cov=project_provisioner --cov-report=html
```

### Qualidade do CÃ³digo
```bash
# FormataÃ§Ã£o automÃ¡tica
black project_provisioner/ tests/

# VerificaÃ§Ã£o de estilo
flake8 project_provisioner/ tests/

# VerificaÃ§Ã£o de tipos
mypy project_provisioner/
```

### Estrutura de Testes
```
tests/
â”œâ”€â”€ __init__.py
â”œâ”€â”€ conftest.py          # ConfiguraÃ§Ãµes e fixtures do pytest
â”œâ”€â”€ test_cli.py          # Testes do CLI (36 testes)
â”œâ”€â”€ test_core.py         # Testes da lÃ³gica principal (6 testes)
â””â”€â”€ test_config.py       # Testes de configuraÃ§Ã£o (16 testes)
```

### Cobertura de Testes
- **Total**: 82% de cobertura
- **CLI**: 75% de cobertura
- **Core**: 97% de cobertura
- **36 testes** executando com sucesso

### Tipos de Testes
- âœ… **Testes UnitÃ¡rios**: FunÃ§Ãµes individuais
- âœ… **Testes de IntegraÃ§Ã£o**: Fluxos completos
- âœ… **Testes de ConfiguraÃ§Ã£o**: ValidaÃ§Ã£o de YAML
- âœ… **Testes de CLI**: Comandos e opÃ§Ãµes
- âœ… **Testes de Mock**: SimulaÃ§Ã£o de dependÃªncias externas

## ğŸ“ PrÃ³ximos Passos

ApÃ³s o provisionamento:
1. Navegue para o diretÃ³rio do projeto: `cd nome-do-projeto`
2. Configure seu ambiente de desenvolvimento
3. Comece a desenvolver!

## ğŸ¤ ContribuiÃ§Ã£o

Para contribuir com melhorias:

1. **Fork o projeto**
2. **Crie uma branch para sua feature**
   ```bash
   git checkout -b feature/nova-funcionalidade
   ```
3. **Commit suas mudanÃ§as**
   ```bash
   git commit -m "Adiciona nova funcionalidade"
   ```
4. **Push para a branch**
   ```bash
   git push origin feature/nova-funcionalidade
   ```
5. **Abra um Pull Request**

### Diretrizes de ContribuiÃ§Ã£o

- âœ… Escreva testes para novas funcionalidades
- âœ… Mantenha a compatibilidade com versÃµes anteriores
- âœ… Documente mudanÃ§as no README
- âœ… Siga o padrÃ£o de cÃ³digo existente
- âœ… Execute `./run_tests.sh` antes de submeter

### Desenvolvimento Local

```bash
# Clone o repositÃ³rio
git clone https://github.com/joseamaro/project-provisioner.git
cd project-provisioner

# Instale em modo desenvolvimento
pip install -e ".[dev]"

# Execute os testes
./run_tests.sh

# FaÃ§a suas alteraÃ§Ãµes e teste novamente
pytest tests/ -v
```

## ğŸ“Š Status do Projeto

- **VersÃ£o**: 0.3.0
- **Status**: Alpha
- **Python**: >=3.8
- **DependÃªncias**: click, PyYAML
- **Cobertura de Testes**: 82%
- **Testes**: 36 testes passando
- **Nova Funcionalidade**: VerificaÃ§Ã£o e instalaÃ§Ã£o automÃ¡tica do Azure CLI

## ğŸ› Reportar Bugs

Se encontrar algum problema:

1. Verifique se nÃ£o foi reportado antes
2. Crie uma issue com:
   - DescriÃ§Ã£o detalhada do problema
   - Passos para reproduzir
   - VersÃ£o do Python e sistema operacional
   - Logs de erro (se aplicÃ¡vel)

## ğŸ“„ LicenÃ§a

Este projeto estÃ¡ licenciado sob a LicenÃ§a MIT - veja o arquivo [LICENSE](LICENSE) para detalhes.


