import{bR as H,cT as w,s as O,r as s,aW as _,ap as q,cU as T,aF as G,j as u,c5 as K,bS as $,bv as N,bT as J}from"./index.Dc_WcSRe.js";import{u as M}from"./uniqueId.BSNvz4do.js";import{I as Q}from"./InputInstructions.CCKHyB20.js";import{a as X}from"./useBasicWidgetState.BHQC2RZK.js";import{u as Y,a as Z,b as tt}from"./useUpdateUiValue.DxMTtdn6.js";import{u as et,T as it}from"./useTextInputAutoExpand.0RtGhNJj.js";import"./FormClearHelper.DgvKxH31.js";import"./inputUtils.CptNuJwn.js";import"./base-input.CS49-0A1.js";const at=(e,t)=>{let a="auto";if(e.heightConfig?.useStretch)a="100%";else if(e.heightConfig?.pixelHeight&&e.heightConfig.pixelHeight>0){const o=H(t.labelVisibility?.value)===w.Collapsed?2:30;a=`${e.heightConfig.pixelHeight-o}px`}return a},st=O("div",{target:"e1r0q00f0"})({height:"100%",display:"flex",flexDirection:"column"}),S=(e,t)=>e.getStringValue(t)??t.default??null,ot=e=>e.default??null,rt=e=>e.value??null,lt=(e,t,a,o)=>{t.setStringValue(e,a.value,{fromUi:a.fromUi},o)},nt=({disabled:e,element:t,widgetMgr:a,fragmentId:o,outerElement:d})=>{const m=s.useRef(M("text_area_")).current,[W,y]=_(),[r,c]=s.useState(!1),[I,b]=s.useState(!1),l=d.heightConfig?.useContent??!1,V=d.heightConfig?.useStretch??!1,v=at(d,t),x=s.useRef(null),[n,h]=s.useState(()=>S(a,t)??null),F=s.useCallback(()=>{h(t.default??null),c(!0)},[t]),[A,g]=X({getStateFromWidgetMgr:S,getDefaultStateFromProto:ot,getCurrStateFromProto:rt,updateWidgetMgrState:lt,element:t,widgetMgr:a,fragmentId:o,onFormCleared:F});Y(A,n,h,r);const i=q(),{height:R,maxHeight:U,updateScrollHeight:C}=et({textareaRef:x,dependencies:[t.placeholder]}),p=s.useCallback(()=>{c(!1),g({value:n,fromUi:!0})},[n,g]),k=s.useCallback(()=>{r&&p(),b(!1)},[r,p]),z=s.useCallback(()=>{b(!0)},[]),E=s.useCallback(()=>{l&&C()},[l,C]),L=Z({formId:t.formId,maxChars:t.maxChars,setDirty:c,setUiValue:h,setValueWithSource:g,additionalAction:E}),P=tt(t.formId,p,r,a,o,!0),{placeholder:D,formId:f}=t,B=T({formId:f})?a.allowFormEnterToSubmit(f):r,j=I&&W>i.breakpoints.hideWidgetDetails;return G(st,{className:"stTextArea","data-testid":"stTextArea",ref:y,children:[u(J,{label:t.label,disabled:e,labelVisibility:H(t.labelVisibility?.value),htmlFor:m,children:t.help&&u(K,{children:u($,{content:t.help,placement:N.TOP_RIGHT})})}),u(it,{inputRef:l?x:void 0,value:n??"",placeholder:D,onBlur:k,onFocus:z,onChange:L,onKeyDown:P,"aria-label":t.label,disabled:e,id:m,overrides:{Input:{style:{fontWeight:i.fontWeights.normal,lineHeight:i.lineHeights.inputWidget,height:l?R:v,maxHeight:l?U:"",minHeight:i.sizes.largestElementHeight,resize:V?"none":"vertical",paddingRight:i.spacing.md,paddingLeft:i.spacing.md,paddingBottom:i.spacing.md,paddingTop:i.spacing.md,"::placeholder":{color:i.colors.fadedText60}}},Root:{props:{"data-testid":"stTextAreaRootElement"},style:{borderLeftWidth:i.sizes.borderWidth,borderRightWidth:i.sizes.borderWidth,borderTopWidth:i.sizes.borderWidth,borderBottomWidth:i.sizes.borderWidth,flexGrow:1}}}}),j&&u(Q,{dirty:r,value:n??"",maxLength:t.maxChars,type:"multiline",inForm:T({formId:f}),allowEnterToSubmit:B})]})},xt=s.memo(nt);export{xt as default};
